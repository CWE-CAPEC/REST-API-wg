{"ID":"498","Name":"Cloneable Class Containing Sensitive Information","Abstraction":"Variant","Structure":"Simple","Status":"Draft","Description":"The code contains a class with sensitive data, but the class is cloneable. The data can then be accessed by cloning the class.","ExtendedDescription":"Cloneable classes are effectively open classes, since data cannot be hidden in them. Classes that do not explicitly deny cloning can be cloned by any other class without running the constructor.","LikelihoodOfExploit":"Medium","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"668","ViewID":"1000","Ordinal":"Primary"},{"Nature":"CanPrecede","CweID":"200","ViewID":"1000"}],"ApplicablePlatforms":[{"Type":"Language","Name":"C++","Prevalence":"Undetermined"},{"Type":"Language","Name":"Java","Prevalence":"Undetermined"},{"Type":"Language","Name":"C#","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Access Control"],"Impact":["Bypass Protection Mechanism"],"Note":"A class that can be cloned can be produced without executing the constructor. This is dangerous since the constructor may perform security-related checks. By allowing the object to be cloned, those checks may be bypassed."}],"PotentialMitigations":[{"Phase":["Implementation"],"Description":"If you do make your classes clonable, ensure that your clone method is final and throw super.clone()."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"The following example demonstrates the weakness."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tpublic class CloneClient {\n\t\t\tpublic CloneClient() //throws\n\t\t\tjava.lang.CloneNotSupportedException {\n\t\t\t\t\tTeacher t1 = new Teacher(\"guddu\",\"22,nagar road\");\n\t\t\t\t\t//...\n\t\t\t\t\t// Do some stuff to remove the teacher.\n\t\t\t\t\tTeacher t2 = (Teacher)t1.clone();\n\t\t\t\t\tSystem.out.println(t2.name);\n\t\t\t}\n\t\t\tpublic static void main(String args[]) {\n\t\t\t\t\tnew CloneClient();\n\t\t\t}\n\t}\n\tclass Teacher implements Cloneable {\n\t\t\tpublic Object clone() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\treturn super.clone();\n\t\t\t\t\t}\n\t\t\t\t\tcatch (java.lang.CloneNotSupportedException e) {\n\t\t\t\t\t\t\tthrow new RuntimeException(e.toString());\n\t\t\t\t\t}\n\t\t\t}\n\t\t\tpublic String name;\n\t\t\tpublic String clas;\n\t\t\tpublic Teacher(String name,String clas) {\n\t\t\t\t\tthis.name = name;\n\t\t\t\t\tthis.clas = clas;\n\t\t\t}\n\t}\n```"},{"BodyText":"Make classes uncloneable by defining a clone function like:"},{"Nature":"Good","Language":"Java","ExampleCode":"```\n\tpublic final void clone() throws java.lang.CloneNotSupportedException {\n\t\tthrow new java.lang.CloneNotSupportedException();\n\t}\n```"}]}],"TaxonomyMappings":[{"TaxonomyName":"CLASP","EntryName":"Information leak through class cloning"},{"TaxonomyName":"The CERT Oracle Secure Coding Standard for Java (2011)","EntryID":"OBJ07-J","EntryName":"Sensitive classes must not let themselves be copied"},{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP23","EntryName":"Exposed Data"}],"References":[{"ExternalReferenceID":"REF-18","Authors":["Secure Software, Inc."],"Title":"The CLASP Application Security Process","PublicationYear":"2005","URL":"https://cwe.mitre.org/documents/sources/TheCLASPApplicationSecurityProcess.pdf","URLDate":"2024-11-17"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CLASP","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Applicable_Platforms, Common_Consequences, Description, Relationships, Other_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Other_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-10-29","ModificationComment":"updated Common_Consequences, Description, Other_Notes, Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Name"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Demonstrative_Examples, Potential_Mitigations, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Rename","PreviousEntryName":"Information Leak through Class Cloning","Date":"2011-03-29"}]}