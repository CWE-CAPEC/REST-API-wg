{"ID":"267","Name":"Privilege Defined With Unsafe Actions","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"A particular privilege, role, capability, or right can be used to perform unsafe actions that were not intended, even when it is assigned to the correct entity.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"269","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design"},{"Phase":"Implementation","Note":"REALIZATION: This weakness is caused during implementation of an architectural security tactic."},{"Phase":"Operation"}],"CommonConsequences":[{"Scope":["Access Control"],"Impact":["Gain Privileges or Assume Identity"],"Note":"A user can access restricted functionality and/or sensitive information that may include administrative functionality and user accounts."}],"PotentialMitigations":[{"MitigationID":"MIT-1","Phase":["Architecture and Design","Operation"],"Description":"Very carefully manage the setting, management, and handling of privileges. Explicitly manage trust zones in the software."},{"MitigationID":"MIT-17","Phase":["Architecture and Design","Operation"],"Strategy":"Environment Hardening","Description":"Run your code using the lowest privileges that are required to accomplish the necessary tasks [REF-76]. If possible, create isolated accounts with limited privileges that are only used for a single task. That way, a successful attack will not immediately give the attacker access to the rest of the software or its environment. For example, database applications rarely need to run as the database administrator, especially in day-to-day operations."}],"DemonstrativeExamples":[{"ID":"DX-127","Entries":[{"IntroText":"This code intends to allow only Administrators to print debug information about a system."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tpublic enum Roles {\n\t\tADMIN,USER,GUEST\n\t}\n\tpublic void printDebugInfo(User requestingUser){\n\t\t\tif(isAuthenticated(requestingUser)){\n\t\t\t\t\tswitch(requestingUser.role){\n\t\t\t\t\t\t\tcase GUEST:\n\t\t\t\t\t\t\t\tSystem.out.println(\"You are not authorized to perform this command\");\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tSystem.out.println(currentDebugState());\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tSystem.out.println(\"You must be logged in to perform this command\");\n\t\t\t}\n\t}\n```"},{"BodyText":"While the intention was to only allow Administrators to print the debug information, the code as written only excludes those with the role of \"GUEST\". Someone with the role of \"ADMIN\" or \"USER\" will be allowed access, which goes against the original intent. An attacker may be able to use this debug information to craft an attack on the system."}]}],"ObservedExamples":[{"Reference":"CVE-2002-1981","Description":"Roles have access to dangerous procedures (Accessible entities).","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1981"},{"Reference":"CVE-2002-1671","Description":"Untrusted object/method gets access to clipboard (Accessible entities).","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1671"},{"Reference":"CVE-2004-2204","Description":"Gain privileges using functions/tags that should be restricted (Accessible entities).","Link":"https://www.cve.org/CVERecord?id=CVE-2004-2204"},{"Reference":"CVE-2000-0315","Description":"Traceroute program allows unprivileged users to modify source address of packet (Accessible entities).","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0315"},{"Reference":"CVE-2004-0380","Description":"Bypass domain restrictions using a particular file that references unsafe URI schemes (Accessible entities).","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0380"},{"Reference":"CVE-2002-1154","Description":"Script does not restrict access to an update command, leading to resultant disk consumption and filled error logs (Accessible entities).","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1154"},{"Reference":"CVE-2002-1145","Description":"\"public\" database user can use stored procedure to modify data controlled by the database owner (Unsafe privileged actions).","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1145"},{"Reference":"CVE-2000-0506","Description":"User with capability can prevent setuid program from dropping privileges (Unsafe privileged actions).","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0506"},{"Reference":"CVE-2002-2042","Description":"Allows attachment to and modification of privileged processes (Unsafe privileged actions).","Link":"https://www.cve.org/CVERecord?id=CVE-2002-2042"},{"Reference":"CVE-2000-1212","Description":"User with privilege can edit raw underlying object using unprotected method (Unsafe privileged actions).","Link":"https://www.cve.org/CVERecord?id=CVE-2000-1212"},{"Reference":"CVE-2005-1742","Description":"Inappropriate actions allowed by a particular role(Unsafe privileged actions).","Link":"https://www.cve.org/CVERecord?id=CVE-2005-1742"},{"Reference":"CVE-2001-1480","Description":"Untrusted entity allowed to access the system clipboard (Unsafe privileged actions).","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1480"},{"Reference":"CVE-2001-1551","Description":"Extra Linux capability allows bypass of system-specified restriction (Unsafe privileged actions).","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1551"},{"Reference":"CVE-2001-1166","Description":"User with debugging rights can read entire process (Unsafe privileged actions).","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1166"},{"Reference":"CVE-2005-1816","Description":"Non-root admins can add themselves or others to the root admin group (Unsafe privileged actions).","Link":"https://www.cve.org/CVERecord?id=CVE-2005-1816"},{"Reference":"CVE-2005-2173","Description":"Users can change certain properties of objects to perform otherwise unauthorized actions (Unsafe privileged actions).","Link":"https://www.cve.org/CVERecord?id=CVE-2005-2173"},{"Reference":"CVE-2005-2027","Description":"Certain debugging commands not restricted to just the administrator, allowing registry modification and infoleak (Unsafe privileged actions).","Link":"https://www.cve.org/CVERecord?id=CVE-2005-2027"}],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Unsafe Privilege"}],"RelatedAttackPatterns":["58","634","637","643","648"],"References":[{"ExternalReferenceID":"REF-76","Authors":["Sean Barnum","Michael Gegick"],"Title":"Least Privilege","PublicationYear":"2005","PublicationMonth":"09","PublicationDay":"14","URL":"https://web.archive.org/web/20211209014121/https://www.cisa.gov/uscert/bsi/articles/knowledge/principles/least-privilege","URLDate":"2023-04-07"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Maintenance","Note":"\n\nNote: there are 2 separate sub-categories here:\n\n```\n\t\t- privilege incorrectly allows entities to perform certain actions\n\t\t- object is incorrectly accessible to entities with a given privilege\n```\n"}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Description, Maintenance_Notes, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-11-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-12-28","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-06-21","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Common_Consequences, Demonstrative_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Modes_of_Introduction, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-09-19","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-08-20","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Maintenance_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Rename","PreviousEntryName":"Unsafe Privilege","Date":"2008-04-11"}]}