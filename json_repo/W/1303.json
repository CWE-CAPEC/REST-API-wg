{"ID":"1303","Name":"Non-Transparent Sharing of Microarchitectural Resources","Abstraction":"Base","Structure":"Simple","Status":"Draft","Description":"Hardware structures shared across execution contexts (e.g., caches and branch predictors) can violate the expected architecture isolation between contexts.","ExtendedDescription":"\n\nModern processors use techniques such as out-of-order execution, speculation, prefetching, data forwarding, and caching to increase performance. Details about the implementation of these techniques are hidden from the programmer's view. This is problematic when the hardware implementation of these techniques results in resources being shared across supposedly isolated contexts. Contention for shared resources between different contexts opens covert channels that allow malicious programs executing in one context to recover information from another context.\n\n\nSome examples of shared micro-architectural resources that have been used to leak information between contexts are caches, branch prediction logic, and load or store buffers. Speculative and out-of-order execution provides an attacker with increased control over which data is leaked through the covert channel.\n\n\nIf the extent of resource sharing between contexts in the design microarchitecture is undocumented, it is extremely difficult to ensure system assets are protected against disclosure.\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"1189","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"203","ViewID":"1000"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Operating_System","Class":"Not OS-Specific","Prevalence":"Undetermined"},{"Type":"Architecture","Class":"Not Architecture-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Class":"Not Technology-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design","Note":"Such issues could be introduced during hardware architecture and design and identified later during Testing or System Configuration phases."},{"Phase":"Implementation","Note":"Such issues could be introduced during implementation and identified later during Testing or System Configuration phases."}],"CommonConsequences":[{"Scope":["Confidentiality"],"Impact":["Read Application Data","Read Memory"],"Note":"Microarchitectural side-channels have been used to leak specific information such as cryptographic keys, and Address Space Layout Randomization (ALSR) offsets as well as arbitrary memory."}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Microarchitectural covert channels can be addressed using a mixture of hardware and software mitigation techniques. These include partitioned caches, new barrier and flush instructions, and disabling high resolution performance counters and timers."},{"Phase":["Requirements"],"Description":"Microarchitectural covert channels can be addressed using a mixture of hardware and software mitigation techniques. These include partitioned caches, new barrier and flush instructions, and disabling high resolution performance counters and timers."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"On some processors the hardware indirect branch predictor is shared between execution contexts, for example, between sibling SMT threads. When SMT thread A executes an indirect branch to a target address X, this target may be temporarily stored by the indirect branch predictor. A subsequent indirect branch mis-prediction for SMT thread B could speculatively execute instructions at X (or at a location in B's address space that partially aliases X). Even though the processor rolls back the architectural effects of the mis-predicted indirect branch, the memory accesses alter data cache state, which is not rolled back after the indirect branch is resolved."}]}],"RelatedAttackPatterns":["663"],"References":[{"ExternalReferenceID":"REF-1121","Authors":["Moritz Lipp","Michael Schwarz","Daniel Gruss","Thomas Prescher","Werner Haas","Anders Fogh","Jann Horn","Stegfan Mangard","Paul Kocher","Daniel Genkin","Yuval Yarom","Mike Hamberg"],"Title":"Meltdown: Reading Kernel Memory from User Space","PublicationYear":"2018","PublicationMonth":"01","PublicationDay":"03","URL":"https://meltdownattack.com/meltdown.pdf"},{"ExternalReferenceID":"REF-1122","Authors":["Moritz Lipp","Michael Schwarz","Daniel Gruss","Thomas Prescher","Werner Haas","Anders Fogh","Jann Horn","Stegfan Mangard","Paul Kocher","Daniel Genkin","Yuval Yarom","Mike Hamberg"],"Title":"Spectre Attacks: Exploiting Speculative Execution","PublicationYear":"2018","PublicationMonth":"01","PublicationDay":"03","URL":"https://spectreattack.com/spectre.pdf"},{"ExternalReferenceID":"REF-1123","Authors":["Dmitry Evtyushkin","Dmitry Ponomarev","Nael Abu-Ghazaleh"],"Title":"Jump Over ASLR: Attacking Branch Predictors to Bypass ASLR","PublicationYear":"2016","PublicationMonth":"10","PublicationDay":"19","URL":"https://ieeexplore.ieee.org/abstract/document/7783743/"},{"ExternalReferenceID":"REF-1124","Authors":["Qian Ge","Yuval Yarom","David Cock","Gernot Heiser"],"Title":"A Survey of Microarchitectural Timing Attacks and Countermeasures on Contemporary Hardware","PublicationYear":"2016","PublicationMonth":"10","PublicationDay":"24","URL":"https://eprint.iacr.org/2016/613.pdf"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Maintenance","Note":"As of CWE 4.9, members of the CWE Hardware SIG are closely analyzing this entry and others to improve CWE's coverage of transient execution weaknesses, which include issues related to Spectre, Meltdown, and other attacks. Additional investigation may include other weaknesses related to microarchitectural state. Finally, this entry's demonstrative example might not be appropriate. As a result, this entry might change significantly in CWE 4.10."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"Nicole Fern","SubmissionOrganization":"Cycuity (originally submitted as Tortuga Logic)","SubmissionDate":"2020-05-08","SubmissionVersion":"4.2","SubmissionReleaseDate":"2020-08-20"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Demonstrative_Examples, Maintenance_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes, Relationships"}]}