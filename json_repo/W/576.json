{"ID":"576","Name":"EJB Bad Practices: Use of Java I/O","Abstraction":"Variant","Structure":"Simple","Status":"Draft","Description":"The product violates the Enterprise JavaBeans (EJB) specification by using the java.io package.","ExtendedDescription":"The Enterprise JavaBeans specification requires that every bean provider follow a set of programming guidelines designed to ensure that the bean will be portable and behave consistently in any EJB container. In this case, the product violates the following EJB guideline: \"An enterprise bean must not use the java.io package to attempt to access files and directories in the file system.\" The specification justifies this requirement in the following way: \"The file system APIs are not well-suited for business components to access data. Business components should use a resource manager API, such as JDBC, to store data.\"","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"695","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Name":"Java","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Other"],"Impact":["Quality Degradation"]}],"PotentialMitigations":[{"Phase":["Implementation"],"Description":"Do not use Java I/O when writing EJBs."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"The following Java example is a simple stateless Enterprise JavaBean that retrieves the interest rate for the number of points for a mortgage. In this example, the interest rates for various points are retrieved from an XML document on the local file system, and the EJB uses the Java I/O API to retrieve the XML document from the local file system."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\t@Stateless\n\tpublic class InterestRateBean implements InterestRateRemote {\n\t\t\tprivate Document interestRateXMLDocument = null;\n\t\t\tprivate File interestRateFile = null;\n\t\t\tpublic InterestRateBean() {\n\t\t\t\t\ttry {\n```\n/* get XML document from the local filesystem */* \n\t\t\t\t\t\t\tinterestRateFile = new File(Constants.INTEREST_RATE_FILE);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (interestRateFile.exists())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t```\n\t\t\t\t\t\t\t\tDocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n\t\t\t\t\t\t\t\tDocumentBuilder db = dbf.newDocumentBuilder();\n\t\t\t\t\t\t\t\tinterestRateXMLDocument = db.parse(interestRateFile);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t} catch (IOException ex) {...}\n\t\t\t}\n\t\t\tpublic BigDecimal getInterestRate(Integer points) {\n\t\t\t\treturn getInterestRateFromXML(points);\n\t\t\t}\n```\n/* member function to retrieve interest rate from XML document on the local file system */* \n\t\t\t\n\t\t\tprivate BigDecimal getInterestRateFromXML(Integer points) {...}}"},{"BodyText":"This use of the Java I/O API within any kind of Enterprise JavaBean violates the EJB specification by using the java.io package for accessing files within the local filesystem."},{"BodyText":"An Enterprise JavaBean should use a resource manager API for storing and accessing data. In the following example, the private member function getInterestRateFromXMLParser uses an XML parser API to retrieve the interest rates."},{"Nature":"Good","Language":"Java","ExampleCode":"```\n\t@Stateless\n\tpublic class InterestRateBean implements InterestRateRemote {\n\t\t\tpublic InterestRateBean() {\n\t\t\t}\n\t\t\tpublic BigDecimal getInterestRate(Integer points) {\n\t\t\t\treturn getInterestRateFromXMLParser(points);\n\t\t\t}\n```\n/* member function to retrieve interest rate from XML document using an XML parser API */* \n\t\t\t\n\t\t\tprivate BigDecimal getInterestRateFromXMLParser(Integer points) {...}}"}]}],"TaxonomyMappings":[{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP3","EntryName":"Use of an improper API"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Community","SubmissionDate":"2006-12-15","SubmissionComment":"Submitted by members of the CWE community to extend early CWE versions","SubmissionVersion":"Draft 5","SubmissionReleaseDate":"2006-12-15"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Potential_Mitigations, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Relationships, Other_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-10-29","ModificationComment":"updated Description, Other_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-12-28","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-27","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}