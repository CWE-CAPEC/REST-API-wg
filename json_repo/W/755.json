{"ID":"755","Name":"Improper Handling of Exceptional Conditions","Abstraction":"Class","Structure":"Simple","Status":"Incomplete","Description":"The product does not handle or incorrectly handles an exceptional condition.","LikelihoodOfExploit":"Medium","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"703","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation","Note":"REALIZATION: This weakness is caused during implementation of an architectural security tactic."}],"CommonConsequences":[{"Scope":["Other"],"Impact":["Other"]}],"DemonstrativeExamples":[{"ID":"DX-39","Entries":[{"IntroText":"The following example attempts to resolve a hostname."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tprotected void doPost (HttpServletRequest req, HttpServletResponse res) throws IOException {\n\t\tString ip = req.getRemoteAddr();\n\t\tInetAddress addr = InetAddress.getByName(ip);\n\t\t...\n\t\tout.println(\"hello \" + addr.getHostName());\n\t}\n```"},{"BodyText":"A DNS lookup failure will cause the Servlet to throw an exception."}]},{"ID":"DX-201","Entries":[{"IntroText":"The following example attempts to allocate memory for a character. After the call to malloc, an if statement is used to check whether the malloc function failed."},{"Nature":"Bad","Language":"C","ExampleCode":"```\n\tfoo=malloc(sizeof(char)); //the next line checks to see if malloc failed\n\tif (foo==NULL) {\n\t\t//We do nothing so we just ignore the error.\n\t}\n```"},{"BodyText":"The conditional successfully detects a NULL return value from malloc indicating a failure, however it does not do anything to handle the problem. Unhandled errors may have unexpected results and may cause the program to crash or terminate."},{"BodyText":"Instead, the if block should contain statements that either attempt to fix the problem or notify the user that an error has occurred and continue processing or perform some cleanup and gracefully terminate the program. The following example notifies the user that the malloc function did not allocate the required memory resources and returns an error code."},{"Nature":"Good","Language":"C","ExampleCode":"```\n\tfoo=malloc(sizeof(char)); //the next line checks to see if malloc failed\n\tif (foo==NULL) {\n\t\tprintf(\"Malloc failed to allocate memory resources\");\n\t\treturn -1;\n\t}\n```"}]},{"ID":"DX-202","Entries":[{"IntroText":"The following code mistakenly catches a NullPointerException."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\ttry { \n\t\t mysteryMethod(); \n\t } catch (NullPointerException npe) {\n\t }\n```"}]}],"ObservedExamples":[{"Reference":"CVE-2023-41151","Description":"SDK for OPC Unified Architecture (OPC UA) server has uncaught exception when a socket is blocked for writing but the server tries to send an error","Link":"https://www.cve.org/CVERecord?id=CVE-2023-41151"},{"Reference":"[REF-1374]","Description":"Chain: JavaScript-based cryptocurrency library can fall back to the insecure Math.random() function instead of reporting a failure (CWE-392), thus reducing the entropy (CWE-332) and leading to generation of non-unique cryptographic keys for Bitcoin wallets (CWE-1391)","Link":"https://www.unciphered.com/blog/randstorm-you-cant-patch-a-house-of-cards"},{"Reference":"CVE-2021-3011","Description":"virtual interrupt controller in a virtualization product allows crash of host by writing a certain invalid value to a register, which triggers a fatal error instead of returning an error code","Link":"https://www.cve.org/CVERecord?id=CVE-2021-3011"},{"Reference":"CVE-2008-4302","Description":"Chain: OS kernel does not properly handle a failure of a function call (CWE-755), leading to an unlock of a resource that was not locked (CWE-832), with resultant crash.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-4302"}],"References":[{"ExternalReferenceID":"REF-1374","Authors":["Unciphered"],"Title":"Randstorm: You Can't Patch a House of Cards","PublicationYear":"2023","PublicationMonth":"11","PublicationDay":"14","URL":"https://www.unciphered.com/blog/randstorm-you-cant-patch-a-house-of-cards","URLDate":"2023-11-15"}],"MappingNotes":{"Usage":"Discouraged","Rationale":"This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate","Comments":"Examine children of this entry to see if there is a better fit","Reasons":["Abstraction"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2009-03-03","SubmissionComment":"New entry for reorganization of CWE-703.","SubmissionVersion":"1.3","SubmissionReleaseDate":"2009-03-10"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-12-28","ModificationComment":"updated Applicable_Platforms, Likelihood_of_Exploit, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-12-13","ModificationComment":"updated Description, Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-09-13","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-01-19","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Likelihood_of_Exploit, Modes_of_Introduction, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-06-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-06-25","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-04-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2024-02-29","ModificationComment":"updated Demonstrative_Examples, Mapping_Notes, Observed_Examples, References, Relationships","ModificationVersion":"4.14","ModificationReleaseDate":"2024-02-29"}]}