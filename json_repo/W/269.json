{"ID":"269","Name":"Improper Privilege Management","Abstraction":"Class","Structure":"Simple","Status":"Draft","Diagram":"/data/images/CWE-269-Diagram.png","Description":"The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.","LikelihoodOfExploit":"Medium","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"284","ViewID":"1000","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design"},{"Phase":"Implementation","Note":"REALIZATION: This weakness is caused during implementation of an architectural security tactic."},{"Phase":"Operation"}],"CommonConsequences":[{"Scope":["Access Control"],"Impact":["Gain Privileges or Assume Identity"]}],"DetectionMethods":[{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)","Effectiveness":"High"}],"PotentialMitigations":[{"MitigationID":"MIT-1","Phase":["Architecture and Design","Operation"],"Description":"Very carefully manage the setting, management, and handling of privileges. Explicitly manage trust zones in the software."},{"MitigationID":"MIT-48","Phase":["Architecture and Design"],"Strategy":"Separation of Privilege","Description":"Follow the principle of least privilege when assigning access rights to entities in a software system."},{"MitigationID":"MIT-49","Phase":["Architecture and Design"],"Strategy":"Separation of Privilege","Description":"Consider following the principle of separation of privilege. Require multiple conditions to be met before permitting access to a system resource."}],"DemonstrativeExamples":[{"ID":"DX-126","Entries":[{"IntroText":"This code temporarily raises the program's privileges to allow creation of a new user folder."},{"Nature":"Bad","Language":"Python","ExampleCode":"```\n\tdef makeNewUserDir(username):\n\t\t\tif invalidUsername(username):\n```\n#avoid CWE-22 and CWE-78* \n\t\t\t\t\tprint('Usernames cannot contain invalid characters')\n\t\t\t\t\treturn False\n\t\t\ttry:\n\t\t\t```\n\t\t\t\traisePrivileges()\n\t\t\t\tos.mkdir('/home/' + username)\n\t\t\t\tlowerPrivileges()\n\t\t\texcept OSError:\n\t\t\t\tprint('Unable to create new user directory for user:' + username)\n\t\t\t\treturn False\n\t\t\treturn True\n```"},{"BodyText":"While the program only raises its privilege level to create the folder and immediately lowers it again, if the call to os.mkdir() throws an exception, the call to lowerPrivileges() will not occur. As a result, the program is indefinitely operating in a raised privilege state, possibly allowing further exploitation to occur."}]},{"ID":"DX-97","Entries":[{"IntroText":"The following example demonstrates the weakness."},{"Nature":"Bad","Language":"C","ExampleCode":"```\n\tseteuid(0);\n```\n/* do some stuff */* \n\t\n\tseteuid(getuid());"}]},{"ID":"DX-142","Entries":[{"IntroText":"The following example demonstrates the weakness."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tAccessController.doPrivileged(new PrivilegedAction() {\n\t\t\tpublic Object run() {\n```\n// privileged code goes here, for example:* \n\t\t\t\tSystem.loadLibrary(\"awt\");\n\t\t\t\treturn null;\n\t\t\t\t\n\t\t\t\t *// nothing to return* \n\t\t\t\t}"}]},{"ID":"DX-127","Entries":[{"IntroText":"This code intends to allow only Administrators to print debug information about a system."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tpublic enum Roles {\n\t\tADMIN,USER,GUEST\n\t}\n\tpublic void printDebugInfo(User requestingUser){\n\t\t\tif(isAuthenticated(requestingUser)){\n\t\t\t\t\tswitch(requestingUser.role){\n\t\t\t\t\t\t\tcase GUEST:\n\t\t\t\t\t\t\t\tSystem.out.println(\"You are not authorized to perform this command\");\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tSystem.out.println(currentDebugState());\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tSystem.out.println(\"You must be logged in to perform this command\");\n\t\t\t}\n\t}\n```"},{"BodyText":"While the intention was to only allow Administrators to print the debug information, the code as written only excludes those with the role of \"GUEST\". Someone with the role of \"ADMIN\" or \"USER\" will be allowed access, which goes against the original intent. An attacker may be able to use this debug information to craft an attack on the system."}]},{"ID":"DX-128","Entries":[{"IntroText":"This code allows someone with the role of \"ADMIN\" or \"OPERATOR\" to reset a user's password. The role of \"OPERATOR\" is intended to have less privileges than an \"ADMIN\", but still be able to help users with small issues such as forgotten passwords."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tpublic enum Roles {\n\t\tADMIN,OPERATOR,USER,GUEST\n\t}\n\tpublic void resetPassword(User requestingUser, User user, String password ){\n\t\t\tif(isAuthenticated(requestingUser)){\n\t\t\t\t\tswitch(requestingUser.role){\n\t\t\t\t\t\t\tcase GUEST:\n\t\t\t\t\t\t\t\tSystem.out.println(\"You are not authorized to perform this command\");\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase USER:\n\t\t\t\t\t\t\t\tSystem.out.println(\"You are not authorized to perform this command\");\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tsetPassword(user,password);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\telse{\n\t\t\t\tSystem.out.println(\"You must be logged in to perform this command\");\n\t\t\t}\n\t}\n```"},{"BodyText":"This code does not check the role of the user whose password is being reset. It is possible for an Operator to gain Admin privileges by resetting the password of an Admin account and taking control of that account."}]}],"ObservedExamples":[{"Reference":"CVE-2001-1555","Description":"Terminal privileges are not reset when a user logs out.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1555"},{"Reference":"CVE-2001-1514","Description":"Does not properly pass security context to child processes in certain cases, allows privilege escalation.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1514"},{"Reference":"CVE-2001-0128","Description":"Does not properly compute roles.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0128"},{"Reference":"CVE-1999-1193","Description":"untrusted user placed in unix \"wheel\" group","Link":"https://www.cve.org/CVERecord?id=CVE-1999-1193"},{"Reference":"CVE-2005-2741","Description":"Product allows users to grant themselves certain rights that can be used to escalate privileges.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-2741"},{"Reference":"CVE-2005-2496","Description":"Product uses group ID of a user instead of the group, causing it to run with different privileges. This is resultant from some other unknown issue.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-2496"},{"Reference":"CVE-2004-0274","Description":"Product mistakenly assigns a particular status to an entity, leading to increased privileges.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0274"},{"Reference":"CVE-2007-4217","Description":"FTP client program on a certain OS runs with setuid privileges and has a buffer overflow. Most clients do not need extra privileges, so an overflow is not a vulnerability for those clients.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-4217"},{"Reference":"CVE-2007-5159","Description":"OS incorrectly installs a program with setuid privileges, allowing users to gain privileges.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-5159"},{"Reference":"CVE-2008-4638","Description":"Composite: application running with high privileges (CWE-250) allows user to specify a restricted file to process, which generates a parsing error that leaks the contents of the file (CWE-209).","Link":"https://www.cve.org/CVERecord?id=CVE-2008-4638"},{"Reference":"CVE-2007-3931","Description":"Installation script installs some programs as setuid when they shouldn't be.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-3931"},{"Reference":"CVE-2002-1981","Description":"Roles have access to dangerous procedures (Accessible entities).","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1981"},{"Reference":"CVE-2002-1671","Description":"Untrusted object/method gets access to clipboard (Accessible entities).","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1671"},{"Reference":"CVE-2000-0315","Description":"Traceroute program allows unprivileged users to modify source address of packet (Accessible entities).","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0315"},{"Reference":"CVE-2000-0506","Description":"User with capability can prevent setuid program from dropping privileges (Unsafe privileged actions).","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0506"}],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Privilege Management Error"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 2-4","EntryName":"Req SP.03.08 BR"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 3-2","EntryName":"Req CR 3.1"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 3-3","EntryName":"Req SR 1.2"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 3-3","EntryName":"Req SR 2.1"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-1","EntryName":"Req SD-3"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-1","EntryName":"Req SD-4"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-1","EntryName":"Req SI-1"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-2","EntryName":"Req CR 1.1"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-2","EntryName":"Req CR 2.1"}],"RelatedAttackPatterns":["122","233","58"],"References":[{"ExternalReferenceID":"REF-44","Section":"\"Sin 16: Executing Code With Too Much Privilege.\" Page 243","Authors":["Michael Howard","David LeBlanc","John Viega"],"Title":"24 Deadly Sins of Software Security","Publication":"McGraw-Hill","PublicationYear":"2010"},{"ExternalReferenceID":"REF-62","Section":"Chapter 9, \"Dropping Privileges Permanently\", Page 479","Authors":["Mark Dowd","John McDonald","Justin Schuh"],"Title":"The Art of Software Security Assessment","Edition":"1st Edition","PublicationYear":"2006","Publisher":"Addison Wesley"},{"ExternalReferenceID":"REF-1287","Section":"Details of Problematic Mappings","Authors":["MITRE"],"Title":"Supplemental Details - 2022 CWE Top 25","PublicationYear":"2022","PublicationMonth":"06","PublicationDay":"28","URL":"https://cwe.mitre.org/top25/archive/2022/2022_cwe_top25_supplemental.html#problematicMappingDetails"}],"MappingNotes":{"Usage":"Discouraged","Rationale":"CWE-269 is commonly misused. It can be conflated with \"privilege escalation,\" which is a technical impact that is listed in many low-information vulnerability reports [REF-1287]. It is not useful for trend analysis.","Comments":"If an error or mistake allows privilege escalation, then use the CWE ID for that mistake. Avoid using CWE-269 when only phrases such as \"privilege escalation\" or \"gain privileges\" are available, as these indicate technical impact of the vulnerability - not the root cause weakness. If the root cause seems to be directly related to privileges, then examine the children of CWE-269 for additional hints, such as Execution with Unnecessary Privileges (CWE-250) or Incorrect Privilege Assignment (CWE-266).","Reasons":["Frequent Misuse"]},"Notes":[{"Type":"Maintenance","Note":"The relationships between privileges, permissions, and actors (e.g. users and groups) need further refinement within the Research view. One complication is that these concepts apply to two different pillars, related to control of resources (CWE-664) and protection mechanism failures (CWE-693)."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationOrganization":"CWE Team","ModificationDate":"2008-09-08","ModificationComment":"Moved this entry higher up in the Research view."},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Description, Maintenance_Notes, Name, Relationships, Taxonomy_Mappings, Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-05-27","ModificationComment":"updated Name"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-12-28","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-06-21","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Description, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2013-02-21","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Causal_Nature, Modes_of_Introduction, Relationships, Type"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-06-20","ModificationComment":"updated Related_Attack_Patterns, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-09-19","ModificationComment":"updated Demonstrative_Examples, Maintenance_Notes, Observed_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Observed_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-08-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-04-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Detection_Factors, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2024-07-16","ModificationComment":"updated Diagram","ModificationVersion":"4.15","ModificationReleaseDate":"2024-07-16"},{"Type":"Contribution","ContributionName":"\"Mapping CWE to 62443\" Sub-Working Group","ContributionOrganization":"CWE-CAPEC ICS/OT SIG","ContributionDate":"2023-06-29","ContributionComment":"Suggested mappings to ISA/IEC 62443.","ContributionType":"Content","ContributionVersion":"4.12","ContributionReleaseDate":"2023-06-29"},{"Type":"Contribution","ContributionName":"Abhi Balakrishnan","ContributionDate":"2024-02-29","ContributionComment":"Provided diagram to improve CWE usability","ContributionType":"Content","ContributionVersion":"4.15","ContributionReleaseDate":"2024-07-16"},{"Type":"Rename","PreviousEntryName":"Privilege Management Error","Date":"2008-09-09"},{"Type":"Rename","PreviousEntryName":"Insecure Privilege Management","Date":"2009-05-27"}]}