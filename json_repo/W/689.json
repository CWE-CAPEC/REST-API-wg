{"ID":"689","Name":"Permission Race Condition During Resource Copy","Abstraction":"Compound","Structure":"Composite","Status":"Draft","Description":"The product, while copying or cloning a resource, does not set the resource's permissions or access control until the copy is complete, leaving the resource exposed to other spheres while the copy is taking place.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"362","ViewID":"1000","Ordinal":"Primary"},{"Nature":"Requires","CweID":"362","ViewID":"1000"},{"Nature":"Requires","CweID":"732","ViewID":"1000"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Name":"C","Prevalence":"Undetermined"},{"Type":"Language","Name":"Perl","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation","Note":"\n\nCommon examples occur in file archive extraction, in which the product begins the extraction with insecure default permissions, then only sets the final permissions (as specified in the archive) once the copy is complete. The larger the archive, the larger the timing window for the race condition.\n\n\nThis weakness has also occurred in some operating system utilities that perform copies of deeply nested directories containing a large number of files.\n\n\nThis weakness can occur in any type of functionality that involves copying objects or resources in a multi-user environment, including at the application level. For example, a document management system might allow a user to copy a private document, but if it does not set the new copy to be private as soon as the copy begins, then other users might be able to view the document while the copy is still taking place.\n"}],"CommonConsequences":[{"Scope":["Confidentiality","Integrity"],"Impact":["Read Application Data","Modify Application Data"]}],"ObservedExamples":[{"Reference":"CVE-2002-0760","Description":"Archive extractor decompresses files with world-readable permissions, then later sets permissions to what the archive specified.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0760"},{"Reference":"CVE-2005-2174","Description":"Product inserts a new object into database before setting the object's permissions, introducing a race condition.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-2174"},{"Reference":"CVE-2006-5214","Description":"Error file has weak permissions before a chmod is performed.","Link":"https://www.cve.org/CVERecord?id=CVE-2006-5214"},{"Reference":"CVE-2005-2475","Description":"Archive permissions issue using hard link.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-2475"},{"Reference":"CVE-2003-0265","Description":"Database product creates files world-writable before initializing the setuid bits, leading to modification of executables.","Link":"https://www.cve.org/CVERecord?id=CVE-2003-0265"}],"RelatedAttackPatterns":["26","27"],"References":[{"ExternalReferenceID":"REF-62","Section":"Chapter 9, \"Permission Races\", Page 533","Authors":["Mark Dowd","John McDonald","Justin Schuh"],"Title":"The Art of Software Security Assessment","Edition":"1st Edition","PublicationYear":"2006","Publisher":"Addison Wesley"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This is a Composite of multiple weaknesses that must all occur simultaneously.","Comments":"While composites are supported in CWE, they have not been a focus of research. There is a chance that future research or CWE scope clarifications will change or deprecate them. Perform root-cause analysis to determine which weaknesses allow this issue to occur, and map to those weaknesses. For example, the delayed permission-setting in the resource copy might be intended functionality, but creation in a location with insecure permissions might not.","Reasons":["Other"]},"Notes":[{"Type":"Research Gap","Note":"Under-studied. It seems likely that this weakness could occur in any situation in which a complex or large copy operation occurs, when the resource can be made available to other spheres as soon as it is created, but before its initialization is complete."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2008-04-11","SubmissionVersion":"Draft 9","SubmissionReleaseDate":"2008-04-11"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Applicable_Platforms, Relationships, Other_Notes, Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-03-10","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-09-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-06-23","ModificationComment":"updated Modes_of_Introduction, Other_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-08-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}