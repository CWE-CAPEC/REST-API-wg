{"ID":"1204","Name":"Generation of Weak Initialization Vector (IV)","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The product uses a cryptographic primitive that uses an Initialization\n\t\t\tVector (IV), but the product does not generate IVs that are\n\t\t\tsufficiently unpredictable or unique according to the expected\n\t\t\tcryptographic requirements for that primitive.\n\t\t\t","ExtendedDescription":"By design, some cryptographic primitives (such as block ciphers) require that IVs must have certain properties for the uniqueness and/or unpredictability of an IV. Primitives may vary in how important these properties are. If these properties are not maintained, e.g. by a bug in the code, then the cryptography may be weakened or broken by attacking the IVs themselves.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"330","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Confidentiality"],"Impact":["Read Application Data"],"Note":"If the IV is not properly initialized, data that is encrypted can be compromised and information about the data can be leaked. See [REF-1179]."}],"PotentialMitigations":[{"Phase":["Implementation"],"Description":"\n\nDifferent cipher modes have different requirements for their IVs. When choosing and implementing a mode, it is important to understand those requirements in order to keep security guarantees intact. Generally, it is safest to generate a random IV, since it will be both unpredictable and have a very low chance of being non-unique. IVs do not have to be kept secret, so if generating duplicate IVs is a concern, a list of already-used IVs can be kept and checked against. \n\n\n NIST offers recommendations on generation of IVs for modes of which they have approved. These include options for when random IVs are not practical. For CBC, CFB, and OFB, see [REF-1175]; for GCM, see [REF-1178]. \n"}],"DemonstrativeExamples":[{"ID":"DX-143","Entries":[{"IntroText":"In the following examples, CBC mode is used when encrypting data:"},{"Nature":"Bad","Language":"C","ExampleCode":"```\n\tEVP_CIPHER_CTX ctx;\n\tchar key[EVP_MAX_KEY_LENGTH];\n\tchar iv[EVP_MAX_IV_LENGTH];\n\tRAND_bytes(key, b);\n\tmemset(iv,0,EVP_MAX_IV_LENGTH);\n\tEVP_EncryptInit(\u0026ctx,EVP_bf_cbc(), key,iv);\n```"},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tpublic class SymmetricCipherTest {\n\t\t\tpublic static void main() {\n\t\t\t\t\tbyte[] text =\"Secret\".getBytes();\n\t\t\t\t\tbyte[] iv ={\n\t\t\t\t\t\t0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00\n\t\t\t\t\t};\n\t\t\t\t\tKeyGenerator kg = KeyGenerator.getInstance(\"DES\");\n\t\t\t\t\tkg.init(56);\n\t\t\t\t\tSecretKey key = kg.generateKey();\n\t\t\t\t\tCipher cipher = Cipher.getInstance(\"DES/CBC/PKCS5Padding\");\n\t\t\t\t\tIvParameterSpec ips = new IvParameterSpec(iv);\n\t\t\t\t\tcipher.init(Cipher.ENCRYPT_MODE, key, ips);\n\t\t\t\t\treturn cipher.doFinal(inpBytes);\n\t\t\t}\n\t}\n```"},{"BodyText":"In both of these examples, the initialization vector (IV) is always a block of zeros. This makes the resulting cipher text much more predictable and susceptible to a dictionary attack."}]},{"Entries":[{"IntroText":"The Wired Equivalent Privacy (WEP) protocol used in the 802.11 wireless standard only supported 40-bit keys, and the IVs were only 24 bits, increasing the chances that the same IV would be reused for multiple messages. The IV was included in plaintext as part of the packet, making it directly observable to attackers. Only 5000 messages are needed before a collision occurs due to the \"birthday paradox\" [REF-1176]. Some implementations would reuse the same IV for each packet. This IV reuse made it much easier for attackers to recover plaintext from two packets with the same IV, using well-understood attacks, especially if the plaintext was known for one of the packets [REF-1175]."}]}],"ObservedExamples":[{"Reference":"CVE-2020-1472","Description":"ZeroLogon vulnerability - use of a static IV of all zeroes in AES-CFB8 mode","Link":"https://www.cve.org/CVERecord?id=CVE-2020-1472"},{"Reference":"CVE-2011-3389","Description":"BEAST attack in SSL 3.0 / TLS 1.0. In CBC mode, chained initialization vectors are non-random, allowing decryption of HTTPS traffic using a chosen plaintext attack.","Link":"https://www.cve.org/CVERecord?id=CVE-2011-3389"},{"Reference":"CVE-2001-0161","Description":"wireless router does not use 6 of the 24 bits for WEP encryption, making it easier for attackers to decrypt traffic","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0161"},{"Reference":"CVE-2001-0160","Description":"WEP card generates predictable IV values, making it easier for attackers to decrypt traffic","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0160"},{"Reference":"CVE-2017-3225","Description":"device bootloader uses a zero initialization vector during AES-CBC","Link":"https://www.cve.org/CVERecord?id=CVE-2017-3225"},{"Reference":"CVE-2016-6485","Description":"crypto framework uses PHP rand function - which is not cryptographically secure - for an initialization vector","Link":"https://www.cve.org/CVERecord?id=CVE-2016-6485"},{"Reference":"CVE-2014-5386","Description":"encryption routine does not seed the random number generator, causing the same initialization vector to be generated repeatedly","Link":"https://www.cve.org/CVERecord?id=CVE-2014-5386"},{"Reference":"CVE-2020-5408","Description":"encryption functionality in an authentication framework uses a fixed null IV with CBC mode, allowing attackers to decrypt traffic in applications that use this functionality","Link":"https://www.cve.org/CVERecord?id=CVE-2020-5408"},{"Reference":"CVE-2017-17704","Description":"messages for a door-unlocking product use a fixed IV in CBC mode, which is the same after each restart","Link":"https://www.cve.org/CVERecord?id=CVE-2017-17704"},{"Reference":"CVE-2017-11133","Description":"application uses AES in CBC mode, but the pseudo-random secret and IV are generated using math.random, which is not cryptographically strong.","Link":"https://www.cve.org/CVERecord?id=CVE-2017-11133"},{"Reference":"CVE-2007-3528","Description":"Blowfish-CBC implementation constructs an IV where each byte is calculated modulo 8 instead of modulo 256, resulting in less than 12 bits for the effective IV length, and less than 4096 possible IV values.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-3528"}],"FunctionalAreas":["Cryptography"],"RelatedAttackPatterns":["20","97"],"References":[{"ExternalReferenceID":"REF-1175","Section":"3. Risks of Keystream Reuse","Authors":["Nikita Borisov","Ian Goldberg","David Wagner"],"Title":"Intercepting Mobile Communications: The Insecurity of 802.11","Publication":"Proceedings of the Seventh Annual International Conference on Mobile Computing And Networking","PublicationYear":"2001","PublicationMonth":"07","Publisher":"ACM","URL":"http://www.isaac.cs.berkeley.edu/isaac/mobicom.pdf"},{"ExternalReferenceID":"REF-1175","Section":"Appendix C","Authors":["Nikita Borisov","Ian Goldberg","David Wagner"],"Title":"Intercepting Mobile Communications: The Insecurity of 802.11","Publication":"Proceedings of the Seventh Annual International Conference on Mobile Computing And Networking","PublicationYear":"2001","PublicationMonth":"07","Publisher":"ACM","URL":"http://www.isaac.cs.berkeley.edu/isaac/mobicom.pdf"},{"ExternalReferenceID":"REF-1176","Authors":["Wikipedia"],"Title":"Birthday problem","PublicationYear":"2021","PublicationMonth":"03","PublicationDay":"06","URL":"https://en.wikipedia.org/wiki/Birthday_problem"},{"ExternalReferenceID":"REF-1177","Authors":["Wikipedia"],"Title":"Initialization Vector","PublicationYear":"2021","PublicationMonth":"03","PublicationDay":"08","URL":"https://en.wikipedia.org/wiki/Initialization_vector"},{"ExternalReferenceID":"REF-1178","Section":"8.2 IV Constructions","Authors":["NIST"],"Title":"Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC","PublicationYear":"2007","PublicationMonth":"11","URL":"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1179","Authors":["Arxum Path Security"],"Title":"CBC Mode is Malleable. Don't trust it for Authentication","PublicationYear":"2019","PublicationMonth":"10","PublicationDay":"16","URL":"https://arxumpathsecurity.com/blog/2019/10/16/cbc-mode-is-malleable-dont-trust-it-for-authentication","URLDate":"2023-04-07"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Maintenance","Note":"As of CWE 4.5, terminology related to randomness, entropy, and predictability can vary widely. Within the developer and other communities, \"randomness\" is used heavily. However, within cryptography, \"entropy\" is distinct, typically implied as a measurement. There are no commonly-used definitions, even within standards documents and cryptography papers. Future versions of CWE will attempt to define these terms and, if necessary, distinguish between them in ways that are appropriate for different communities but do not reduce the usability of CWE for mapping, understanding, or other scenarios."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2021-03-09","SubmissionVersion":"4.4","SubmissionReleaseDate":"2021-03-15"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-07-20","ModificationComment":"updated Maintenance_Notes, Observed_Examples, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}