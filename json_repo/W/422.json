{"ID":"422","Name":"Unprotected Windows Messaging Channel ('Shatter')","Abstraction":"Variant","Structure":"Simple","Status":"Draft","Description":"The product does not properly verify the source of a message in the Windows Messaging System while running at elevated privileges, creating an alternate channel through which an attacker can directly send a message to the product.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"420","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"360","ViewID":"1000"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design"}],"CommonConsequences":[{"Scope":["Access Control"],"Impact":["Gain Privileges or Assume Identity","Bypass Protection Mechanism"]}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Always verify and authenticate the source of the message."}],"ObservedExamples":[{"Reference":"CVE-2002-0971","Description":"Bypass GUI and access restricted dialog box.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0971"},{"Reference":"CVE-2002-1230","Description":"Gain privileges via Windows message.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1230"},{"Reference":"CVE-2003-0350","Description":"A control allows a change to a pointer for a callback function using Windows message.","Link":"https://www.cve.org/CVERecord?id=CVE-2003-0350"},{"Reference":"CVE-2003-0908","Description":"Product launches Help functionality while running with raised privileges, allowing command execution using Windows message to access \"open file\" dialog.","Link":"https://www.cve.org/CVERecord?id=CVE-2003-0908"},{"Reference":"CVE-2004-0213","Description":"Attacker uses Shatter attack to bypass GUI-enforced protection for CVE-2003-0908.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0213"},{"Reference":"CVE-2004-0207","Description":"User can call certain API functions to modify certain properties of privileged programs.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0207"}],"AffectedResources":["System Process"],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Unprotected Windows Messaging Channel ('Shatter')"},{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP30","EntryName":"Missing endpoint authentication"}],"References":[{"ExternalReferenceID":"REF-402","Authors":["Paget"],"Title":"Exploiting design flaws in the Win32 API for privilege escalation. Or... Shatter Attacks - How to break Windows","PublicationYear":"2002","PublicationMonth":"08","URL":"http://web.archive.org/web/20060115174629/http://security.tombom.co.uk/shatter.html"},{"ExternalReferenceID":"REF-62","Section":"Chapter 2, \"Design Review.\" Page 34","Authors":["Mark Dowd","John McDonald","Justin Schuh"],"Title":"The Art of Software Security Assessment","Edition":"1st Edition","PublicationYear":"2006","Publisher":"Addison Wesley"},{"ExternalReferenceID":"REF-62","Section":"Chapter 12, \"Shatter Attacks\", Page 694","Authors":["Mark Dowd","John McDonald","Justin Schuh"],"Title":"The Art of Software Security Assessment","Edition":"1st Edition","PublicationYear":"2006","Publisher":"Addison Wesley"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Relationship","Note":"Overlaps privilege errors and UI errors."},{"Type":"Research Gap","Note":"\n\nPossibly under-reported, probably under-studied. It is suspected that a number of publicized vulnerabilities that involve local privilege escalation on Windows systems may be related to Shatter attacks, but they are not labeled as such.\n\n\nAlternate channel attacks likely exist in other operating systems and messaging models, e.g. in privileged X Windows applications, but examples are not readily available.\n"}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Potential_Mitigations, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Relationships, Other_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Other_Notes, Relationship_Notes, Research_Gaps"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}