{"ID":"403","Name":"Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak')","Abstraction":"Base","Structure":"Simple","Status":"Draft","Description":"A process does not close sensitive file descriptors before invoking a child process, which allows the child to perform unauthorized I/O operations using those descriptors.","ExtendedDescription":"When a new process is forked or executed, the child process inherits any open file descriptors. When the child process has fewer privileges than the parent process, this might introduce a vulnerability if the child process can access the file descriptor but does not have the privileges to access the associated file.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"402","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Name":"C","Prevalence":"Undetermined"},{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Operating_System","Class":"Unix","Prevalence":"Undetermined"}],"AlternateTerms":[{"Term":"File descriptor leak","Description":"While this issue is frequently called a file descriptor leak, the \"leak\" term is often used in two different ways - exposure of a resource, or consumption of a resource. Use of this term could cause confusion."}],"ModesOfIntroduction":[{"Phase":"Implementation","Note":"REALIZATION: This weakness is caused during implementation of an architectural security tactic."}],"CommonConsequences":[{"Scope":["Confidentiality","Integrity"],"Impact":["Read Application Data","Modify Application Data"]}],"ObservedExamples":[{"Reference":"CVE-2003-0740","Description":"Server leaks a privileged file descriptor, allowing the server to be hijacked.","Link":"https://www.cve.org/CVERecord?id=CVE-2003-0740"},{"Reference":"CVE-2004-1033","Description":"File descriptor leak allows read of restricted files.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-1033"},{"Reference":"CVE-2000-0094","Description":"Access to restricted resource using modified file descriptor for stderr.","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0094"},{"Reference":"CVE-2002-0638","Description":"Open file descriptor used as alternate channel in complex race condition.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0638"},{"Reference":"CVE-2003-0489","Description":"Program does not fully drop privileges after creating a file descriptor, which allows access to the descriptor via a separate vulnerability.","Link":"https://www.cve.org/CVERecord?id=CVE-2003-0489"},{"Reference":"CVE-2003-0937","Description":"User bypasses restrictions by obtaining a file descriptor then calling setuid program, which does not close the descriptor.","Link":"https://www.cve.org/CVERecord?id=CVE-2003-0937"},{"Reference":"CVE-2004-2215","Description":"Terminal manager does not properly close file descriptors, allowing attackers to access terminals of other users.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-2215"},{"Reference":"CVE-2006-5397","Description":"Module opens a file for reading twice, allowing attackers to read files.","Link":"https://www.cve.org/CVERecord?id=CVE-2006-5397"}],"AffectedResources":["System Process","File or Directory"],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"UNIX file descriptor leak"},{"TaxonomyName":"CERT C Secure Coding","EntryID":"FIO42-C","EntryName":"Ensure files are properly closed when they are no longer needed"},{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP23","EntryName":"Exposed Data"}],"References":[{"ExternalReferenceID":"REF-392","Authors":["Paul Roberts"],"Title":"File descriptors and setuid applications","PublicationYear":"2007","PublicationMonth":"02","PublicationDay":"05","URL":"https://blogs.oracle.com/paulr/entry/file_descriptors_and_setuid_applications"},{"ExternalReferenceID":"REF-393","Section":"Elevating Privileges Safely","Authors":["Apple"],"Title":"Introduction to Secure Coding Guide","URL":"https://developer.apple.com/library/archive/documentation/Security/Conceptual/SecureCodingGuide/Articles/AccessControl.html","URLDate":"2023-04-07"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Applicable_Platforms, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-11-24","ModificationComment":"updated Affected_Resources, Observed_Examples, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Name"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-27","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-09-13","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2013-02-21","ModificationComment":"updated Alternate_Terms, Description, Name, Observed_Examples, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Affected_Resources, Applicable_Platforms, Modes_of_Introduction, References, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-04-03","ModificationComment":"updated Applicable_Platforms","ModificationVersion":"4.17","ModificationReleaseDate":"2025-04-03"},{"Type":"Rename","PreviousEntryName":"UNIX File Descriptor Leak","Date":"2011-03-29"},{"Type":"Rename","PreviousEntryName":"Exposure of File Descriptor to Unintended Control Sphere","Date":"2013-02-21"}]}