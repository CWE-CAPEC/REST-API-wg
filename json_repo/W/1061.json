{"ID":"1061","Name":"Insufficient Encapsulation","Abstraction":"Class","Structure":"Simple","Status":"Incomplete","Description":"The product does not sufficiently hide the internal representation and implementation details of data or methods, which might allow external components or modules to modify data unexpectedly, invoke unexpected functionality, or introduce dependencies that the programmer did not intend.","ExtendedDescription":"\n\nThis issue makes it more difficult to maintain the product, which indirectly affects security by making it more difficult or time-consuming to find and/or fix vulnerabilities. It also might make it easier to introduce vulnerabilities.\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"710","ViewID":"1000","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Indirect"}],"DemonstrativeExamples":[{"ID":"DX-212","Entries":[{"IntroText":"The following example shows a basic user account class that includes member variables for the username and password as well as a public constructor for the class and a public method to authorize access to the user account."},{"Nature":"Bad","Language":"C++","ExampleCode":"```\n\t#define MAX_PASSWORD_LENGTH 15\n\t#define MAX_USERNAME_LENGTH 15\n\tclass UserAccount\n\t{\n\t\t\tpublic:\n\t\t\t\t\tUserAccount(char *username, char *password)\n\t\t\t\t\t{\n\t\t\t\t\t\tif ((strlen(username) \u003e MAX_USERNAME_LENGTH) ||\n\t\t\t\t\t\t(strlen(password) \u003e MAX_PASSWORD_LENGTH)) {\n\t\t\t\t\t\t\tExitError(\"Invalid username or password\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstrcpy(this-\u003eusername, username);\n\t\t\t\t\t\tstrcpy(this-\u003epassword, password);\n\t\t\t\t\t}\n\t\t\tint authorizeAccess(char *username, char *password)\n\t\t\t{\n\t\t\t\t\tif ((strlen(username) \u003e MAX_USERNAME_LENGTH) ||\n\t\t\t\t\t(strlen(password) \u003e MAX_PASSWORD_LENGTH)) {\n\t\t\t\t\t\tExitError(\"Invalid username or password\");\n\t\t\t\t\t}\n```\n// if the username and password in the input parameters are equal to* \n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t *// the username and password of this account class then authorize access* \n\t\t\t\t\tif (strcmp(this-\u003eusername, username) ||\n\t\t\t\t\tstrcmp(this-\u003epassword, password))\n\t\t\t\t\t```\n\t\t\t\t\t\treturn 0;\n```\n// otherwise do not authorize access* \n\t\t\t\t\telse\n\t\t\t\t\t```\n\t\t\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tchar username[MAX_USERNAME_LENGTH+1];\n\t\t\tchar password[MAX_PASSWORD_LENGTH+1];\n\t};\n```"},{"BodyText":"However, the member variables username and password are declared public and therefore will allow access and changes to the member variables to anyone with access to the object. These member variables should be declared private as shown below to prevent unauthorized access and changes."},{"Nature":"Good","Language":"C++","ExampleCode":"```\n\tclass UserAccount\n\t{\n\tpublic:\n\t\t...\n\tprivate:\n\t\tchar username[MAX_USERNAME_LENGTH+1];\n\t\tchar password[MAX_PASSWORD_LENGTH+1];\n\t};\n```"}]}],"ObservedExamples":[{"Reference":"CVE-2010-3860","Description":"variables declared public allow remote read of system properties such as user name and home directory.","Link":"https://www.cve.org/CVERecord?id=CVE-2010-3860"}],"References":[{"ExternalReferenceID":"REF-969","Authors":["Wikipedia"],"Title":"Encapsulation (computer programming)","URL":"https://en.wikipedia.org/wiki/Encapsulation_(computer_programming)"}],"MappingNotes":{"Usage":"Allowed-with-Review","Rationale":"This CWE entry is a Class and might have Base-level children that would be more appropriate","Comments":"Examine children of this entry to see if there is a better fit","Reasons":["Abstraction"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2018-07-29","SubmissionVersion":"3.2","SubmissionReleaseDate":"2019-01-03"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-10-26","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2024-02-29","ModificationComment":"updated Demonstrative_Examples","ModificationVersion":"4.14","ModificationReleaseDate":"2024-02-29"}]}