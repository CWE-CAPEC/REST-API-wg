{"ID":"1177","Name":"Use of Prohibited Code","Abstraction":"Class","Structure":"Simple","Status":"Incomplete","Description":"The product uses a function, library, or third party component\n\t     that has been explicitly prohibited, whether by the developer or\n\t     the customer.","ExtendedDescription":"\n\nThe developer - or customers - may wish to restrict or eliminate use of a function, library, or third party component for any number of reasons, including real or suspected vulnerabilities; difficulty to use securely; export controls or license requirements; obsolete or poorly-maintained code; internal code being scheduled for deprecation; etc.\n\n\nTo reduce risk of vulnerabilities, the developer might maintain a list of \"banned\" functions that programmers must avoid using because the functions are difficult or impossible to use securely. This issue can also make the product more costly and difficult to maintain.\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"710","ViewID":"1000","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Indirect"},{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Other"],"Impact":["Reduce Maintainability"]}],"DetectionMethods":[{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)","Effectiveness":"High"}],"DemonstrativeExamples":[{"ID":"DX-5","Entries":[{"IntroText":"The code below calls the gets() function to read in data from the command line."},{"Nature":"Bad","Language":"C","ExampleCode":"```\n\t\tchar buf[24];\n\t\tprintf(\"Please enter your name and press \u003cEnter\u003e\\n\");\n\t\tgets(buf);\n\t\t...\n\t}\n```"},{"BodyText":"However, gets() is inherently unsafe, because it copies all input from STDIN to the buffer without checking size. This allows the user to provide a string that is larger than the buffer size, resulting in an overflow condition."}]},{"ID":"DX-6","Entries":[{"IntroText":"The following code attempts to create a local copy of a buffer to perform some manipulations to the data."},{"Nature":"Bad","Language":"C","ExampleCode":"```\n\tvoid manipulate_string(char * string){\n\t\tchar buf[24];\n\t\tstrcpy(buf, string);\n\t\t...\n\t}\n```"},{"BodyText":"However, the programmer does not ensure that the size of the data pointed to by string will fit in the local buffer and copies the data with the potentially dangerous strcpy() function. This may result in a buffer overflow condition if an attacker can influence the contents of the string parameter."}]}],"ObservedExamples":[{"Reference":"CVE-2007-1470","Description":"Library has multiple buffer overflows using sprintf() and strcpy()","Link":"https://www.cve.org/CVERecord?id=CVE-2007-1470"},{"Reference":"CVE-2007-4004","Description":"FTP client uses inherently insecure gets() function and is setuid root on some systems, allowing buffer overflow","Link":"https://www.cve.org/CVERecord?id=CVE-2007-4004"}],"References":[{"ExternalReferenceID":"REF-1009","Authors":["Tim Rains"],"Title":"Microsoft's Free Security Tools - banned.h","PublicationYear":"2012","PublicationMonth":"08","PublicationDay":"30","URL":"https://www.microsoft.com/en-us/security/blog/2012/08/30/microsofts-free-security-tools-banned-h/","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1010","Authors":["Michael Howard"],"Title":"Microsoft's Free Security Tools - banned.h","PublicationYear":"2011","PublicationMonth":"06","URL":"https://www.microsoft.com/en-us/security/blog/2012/08/30/microsofts-free-security-tools-banned-h/","URLDate":"2023-04-07"}],"MappingNotes":{"Usage":"Allowed-with-Review","Rationale":"This CWE entry is a Class and might have Base-level children that would be more appropriate","Comments":"Examine children of this entry to see if there is a better fit","Reasons":["Abstraction"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2019-01-03","SubmissionVersion":"3.2","SubmissionReleaseDate":"2019-01-03"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2024-02-29","ModificationComment":"updated Demonstrative_Examples, Observed_Examples","ModificationVersion":"4.14","ModificationReleaseDate":"2024-02-29"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-12-11","ModificationComment":"updated Applicable_Platforms, Detection_Factors","ModificationVersion":"4.19","ModificationReleaseDate":"2025-12-11"}]}