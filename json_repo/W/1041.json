{"ID":"1041","Name":"Use of Redundant Code","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The product has multiple functions, methods, procedures, macros, etc. that\n\t\t\t\t\tcontain the same code.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"710","ViewID":"1000","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Indirect"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Other"],"Impact":["Reduce Maintainability"],"Note":"This issue makes it more difficult to maintain the product, which indirectly affects security by making it more difficult or time-consuming to find and/or fix vulnerabilities. For example, if there are two copies of the same code, the programmer might fix a weakness in one copy while forgetting to fix the same weakness in another copy."}],"DetectionMethods":[{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)"}],"PotentialMitigations":[{"Phase":["Implementation"],"Description":"Merge common functionality into a single function and then call that function from across the entire code base."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"In the following Java example the code performs some complex math when specific test conditions are met. The math is the same in each case and the equations are repeated within the code. Unfortunately if a future change needs to be made then that change needs to be made in all locations. This opens the door to mistakes being made and the changes not being made in the same way in each instance."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tpublic class Main {\n\t\tpublic static void main(String[] args) { \n\t\t\tdouble s = 10.0; \n\t\t\tdouble r = 1.0; \n\t\t\tdouble pi = 3.14159; \n\t\t\tdouble surface_area;\n\t\t\tif(r \u003e 0.0) { \n\t\t\t\t// complex math equations \n\t\t\t\tsurface_area = pi * r * s + pi * Math.pow(r, 2);\n\t\t\t}\n\t\t\tif(r \u003e 1.0) { \n\t\t\t\t// a complex set of math \n\t\t\t\tsurface_area = pi * r * s + pi * Math.pow(r, 2);\n\t\t\t}\n\t\t}\n\t}\n```"},{"BodyText":"It is recommended to place the complex math into its own function and then call that function whenever necessary."},{"Nature":"Good","Language":"Java","ExampleCode":"```\n\tpublic class Main {\n\t\tprivate double ComplexMath(double r, double s) { \n\t\t\t//complex math equations \n\t\t\tdouble pi = Math.PI; \n\t\t\tdouble surface_area = pi * r * s + pi * Math.pow(r, 2); \n\t\t\treturn surface_area;\n\t\t}\n\t\tpublic static void main(String[] args) { \n\t\t\tdouble s = 10.0; \n\t\t\tdouble r = 1.0; \n\t\t\tdouble surface_area;\n\t\t\tif(r \u003e 0.0) { \n\t\t\t\tsurface_area = ComplexMath(r, s);\n\t\t\t}\n\t\t\tif(r \u003e 1.0) { \n\t\t\t\tsurface_area = ComplexMath(r, s);\n\t\t\t}\n\t\t}\n\t}\n```"}]}],"TaxonomyMappings":[{"TaxonomyName":"OMG ASCMM","EntryID":"ASCMM-MNT-19"}],"References":[{"ExternalReferenceID":"REF-960","Section":"ASCMM-MNT-19","Authors":["Object Management Group (OMG)"],"Title":"Automated Source Code Maintainability Measure (ASCMM)","PublicationYear":"2016","PublicationMonth":"01","URL":"https://www.omg.org/spec/ASCMM/","URLDate":"2023-04-07"}],"MappingNotes":{"Usage":"Prohibited","Rationale":"This entry is primarily a quality issue with no direct security implications.","Comments":"Look for weaknesses that are focused specifically on insecure behaviors that have more direct security implications.","Reasons":["Other"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2018-07-02","SubmissionComment":"Entry derived from Common Quality Enumeration (CQE) Draft 0.9.","SubmissionVersion":"3.2","SubmissionReleaseDate":"2019-01-03"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-08-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Applicable_Platforms, Demonstrative_Examples, Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2024-02-29","ModificationComment":"updated Mapping_Notes","ModificationVersion":"4.14","ModificationReleaseDate":"2024-02-29"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-12-11","ModificationComment":"updated Common_Consequences, Description, Detection_Factors, Time_of_Introduction","ModificationVersion":"4.19","ModificationReleaseDate":"2025-12-11"},{"Type":"Contribution","ContributionName":"Drew Buttner","ContributionOrganization":"MITRE","ContributionDate":"2022-08-15","ContributionComment":"Suggested new demonstrative examples, mitigations, and applicable platforms.","ContributionType":"Content"}]}