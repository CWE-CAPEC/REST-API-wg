{"ID":"1190","Name":"DMA Device Enabled Too Early in Boot Phase","Abstraction":"Base","Structure":"Simple","Status":"Draft","Description":"The product enables a Direct Memory Access (DMA) capable device before the security configuration settings are established, which allows an attacker to extract data from or gain privileges on the product.","ExtendedDescription":"\n\nDMA is included in a number of devices because it allows data transfer between the computer and the connected device, using direct hardware access to read or write directly to main memory without any OS interaction. An attacker could exploit this to access secrets. Several virtualization-based mitigations have been introduced to thwart DMA attacks. These are usually configured/setup during boot time. However, certain IPs that are powered up before boot is complete (known as early boot IPs) may be DMA capable. Such IPs, if not trusted, could launch DMA attacks and gain access to assets that should otherwise be protected.\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"696","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Class":"System on Chip","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design"}],"CommonConsequences":[{"Scope":["Access Control"],"Impact":["Bypass Protection Mechanism","Modify Memory"],"Likelihood":["High"],"Note":"DMA devices have direct write access to main memory and due to time of attack will be able to bypass OS or Bootloader access control."}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Utilize an IOMMU to orchestrate IO access from the start of the boot process."}],"RelatedAttackPatterns":["180"],"References":[{"ExternalReferenceID":"REF-1038","Title":"DMA attack","PublicationYear":"2019","PublicationMonth":"10","PublicationDay":"19","URL":"https://en.wikipedia.org/wiki/DMA_attack"},{"ExternalReferenceID":"REF-1039","Authors":["A. Theodore Markettos","Colin Rothwell","Brett F. Gutstein","Allison Pearce","Peter G. Neumann","Simon W. Moore","Robert N. M. Watson"],"Title":"Thunderclap: Exploring Vulnerabilities in Operating System IOMMU Protection via DMA from Untrustworthy Peripherals","PublicationYear":"2019","PublicationMonth":"02","PublicationDay":"25","URL":"https://www.ndss-symposium.org/wp-content/uploads/2019/02/ndss2019_05A-1_Markettos_paper.pdf"},{"ExternalReferenceID":"REF-1040","Authors":["Maximillian Dornseif","Michael Becher","Christian N. Klein"],"Title":"FireWire all your memory are belong to us","PublicationYear":"2005","URL":"http://www.orkspace.net/secdocs/Conferences/CanSecWest/2005/0wn3d%20by%20an%20iPod%20-%20Firewire1394%20Issues.pdf","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1041","Authors":["Rory Breuk","Albert Spruyt","Adam Boileau"],"Title":"Integrating DMA attacks in exploitation frameworks","PublicationYear":"2012","PublicationMonth":"02","PublicationDay":"20","URL":"https://www.os3.nl/_media/2011-2012/courses/rp1/p14_report.pdf"},{"ExternalReferenceID":"REF-1042","Authors":["Maximillian Dornseif"],"Title":"Owned by an iPod","PublicationYear":"2004","URL":"https://web.archive.org/web/20060505224959/https://pacsec.jp/psj04/psj04-dornseif-e.ppt","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1044","Authors":["Dmytro Oleksiuk"],"Title":"My aimful life","PublicationYear":"2015","PublicationMonth":"09","PublicationDay":"12","URL":"http://blog.cr4.sh/2015/09/breaking-uefi-security-with-software.html"},{"ExternalReferenceID":"REF-1046","Authors":["A. Theodore Markettos","Adam Boileau"],"Title":"Hit by a Bus:Physical Access Attacks with Firewire","PublicationYear":"2006","URL":"https://security-assessment.com/files/presentations/ab_firewire_rux2k6-final.pdf"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"Arun Kanuparthi, Hareesh Khattri, Parbati Kumar Manna, Narasimha Kumar V Mangipudi","SubmissionOrganization":"Intel Corporation","SubmissionDate":"2019-10-15","SubmissionVersion":"4.0","SubmissionReleaseDate":"2020-02-24"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-08-20","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}