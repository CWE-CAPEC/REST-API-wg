{"ID":"941","Name":"Incorrectly Specified Destination in a Communication Channel","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The product creates a communication channel to initiate an outgoing request to an actor, but it does not correctly specify the intended destination for that actor.","ExtendedDescription":"\n\nAttackers at the destination may be able to spoof trusted servers to steal data or cause a denial of service.\n\n\nThere are at least two distinct weaknesses that can cause the product to communicate with an unintended destination:\n\n\n  - If the product allows an attacker to control which destination is specified, then the attacker can cause it to connect to an untrusted or malicious destination. For example, because UDP is a connectionless protocol, UDP packets can be spoofed by specifying a false source address in the packet; when the server receives the packet and sends a reply, it will specify a destination by using the source of the incoming packet - i.e., the false source. The server can then be tricked into sending traffic to the wrong host, which is effective for hiding the real source of an attack and for conducting a distributed denial of service (DDoS). As another example, server-side request forgery (SSRF) and XML External Entity (XXE) can be used to trick a server into making outgoing requests to hosts that cannot be directly accessed by the attacker due to firewall restrictions.\n\n  - If the product incorrectly specifies the destination, then an attacker who can control this destination might be able to spoof trusted servers. While the most common occurrence is likely due to misconfiguration by an administrator, this can be resultant from other weaknesses. For example, the product might incorrectly parse an e-mail or IP address and send sensitive data to an unintended destination. As another example, an Android application may use a \"sticky broadcast\" to communicate with a receiver for a particular application, but since sticky broadcasts can be processed by *any* receiver, this can allow a malicious application to access restricted data that was only intended for a different application.\n\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"923","ViewID":"1000","Ordinal":"Primary"},{"Nature":"CanPrecede","CweID":"406","ViewID":"1000"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Class":"Mobile","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design"},{"Phase":"Implementation","Note":"REALIZATION: This weakness is caused during implementation of an architectural security tactic."}],"CommonConsequences":[{"Scope":["Access Control","Other"],"Impact":["Gain Privileges or Assume Identity","Varies by Context","Bypass Protection Mechanism"],"Note":"An attacker can access any functionality that is inadvertently accessible to the source."}],"DemonstrativeExamples":[{"ID":"DX-113","Entries":[{"IntroText":"This code listens on a port for DNS requests and sends the result to the requesting address."},{"Nature":"Bad","Language":"Python","ExampleCode":"```\n\tsock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\n\tsock.bind( (UDP_IP,UDP_PORT) )\n\twhile true:\n\t\t\tdata = sock.recvfrom(1024)\n\t\t\tif not data:\n\t\t\t\tbreak\n\t\t\t(requestIP, nameToResolve) = parseUDPpacket(data)\n\t\t\trecord = resolveName(nameToResolve)\n\t\t\tsendResponse(requestIP,record)\n```"},{"BodyText":"This code sends a DNS record to a requesting IP address. UDP allows the source IP address to be easily changed ('spoofed'), thus allowing an attacker to redirect responses to a target, which may be then be overwhelmed by the network traffic."}]}],"ObservedExamples":[{"Reference":"CVE-2013-5211","Description":"composite: NTP feature generates large responses (high amplification factor) with spoofed UDP source addresses.","Link":"https://www.cve.org/CVERecord?id=CVE-2013-5211"},{"Reference":"CVE-1999-0513","Description":"Classic \"Smurf\" attack, using spoofed ICMP packets to broadcast addresses.","Link":"https://www.cve.org/CVERecord?id=CVE-1999-0513"},{"Reference":"CVE-1999-1379","Description":"DNS query with spoofed source address causes more traffic to be returned to spoofed address than was sent by the attacker.","Link":"https://www.cve.org/CVERecord?id=CVE-1999-1379"}],"References":[{"ExternalReferenceID":"REF-941","Authors":["US-CERT"],"Title":"UDP-based Amplification Attacks","PublicationYear":"2014","PublicationMonth":"01","PublicationDay":"17","URL":"https://www.cisa.gov/ncas/alerts/TA14-017A","URLDate":"2025-08-04"},{"ExternalReferenceID":"REF-942","Authors":["Fortify"],"Title":"Android Bad Practices: Sticky Broadcast","URL":"https://www.hpe.com/us/en/solutions/infrastructure-security.html?jumpid=va_wnmstr1ug6_aid-510326901","URLDate":"2023-04-07"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2014-02-13","SubmissionVersion":"2.6","SubmissionReleaseDate":"2014-02-19"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Modes_of_Introduction, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Applicable_Platforms, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Maintenance_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-09-09","ModificationComment":"updated References","ModificationVersion":"4.18","ModificationReleaseDate":"2025-09-09"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-12-11","ModificationComment":"updated Common_Consequences, Relationships, Weakness_Ordinalities","ModificationVersion":"4.19","ModificationReleaseDate":"2025-12-11"}]}