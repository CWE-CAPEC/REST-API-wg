{"ID":"69","Name":"Improper Handling of Windows ::DATA Alternate Data Stream","Abstraction":"Variant","Structure":"Simple","Status":"Incomplete","Description":"The product does not properly prevent access to, or detect usage of, alternate data streams (ADS).","ExtendedDescription":"An attacker can use an ADS to hide information about a file (e.g. size, the name of the process) from a system or file browser tools such as Windows Explorer and 'dir' at the command line utility. Alternately, the attacker might be able to bypass intended access restrictions for the associated data fork.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"66","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Operating_System","Class":"Windows","Prevalence":"Undetermined"}],"BackgroundDetails":["Alternate data streams (ADS) were first implemented in the Windows NT operating system to provide compatibility between NTFS and the Macintosh Hierarchical File System (HFS). In HFS, data and resource forks are used to store information about a file. The data fork provides information about the contents of the file while the resource fork stores metadata such as file type."],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Access Control","Non-Repudiation","Other"],"Impact":["Bypass Protection Mechanism","Hide Activities","Other"]}],"PotentialMitigations":[{"Phase":["Testing"],"Description":"Software tools are capable of finding ADSs on your system."},{"Phase":["Implementation"],"Description":"Ensure that the source code correctly parses the filename to read or write to the correct stream."}],"ObservedExamples":[{"Reference":"CVE-1999-0278","Description":"In IIS, remote attackers can obtain source code for ASP files by appending \"::$DATA\" to the URL.","Link":"https://www.cve.org/CVERecord?id=CVE-1999-0278"},{"Reference":"CVE-2000-0927","Description":"Product does not properly record file sizes if they are stored in alternative data streams, which allows users to bypass quota restrictions.","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0927"}],"AffectedResources":["System Process"],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Windows ::DATA alternate data stream"}],"RelatedAttackPatterns":["168"],"References":[{"ExternalReferenceID":"REF-562","Authors":["Don Parker"],"Title":"Windows NTFS Alternate Data Streams","PublicationYear":"2005","PublicationMonth":"02","PublicationDay":"16","URL":"https://seclists.org/basics/2005/Feb/312","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-7","Authors":["Michael Howard","David LeBlanc"],"Title":"Writing Secure Code","Edition":"2nd Edition","PublicationYear":"2002","PublicationMonth":"12","PublicationDay":"04","Publisher":"Microsoft Press","URL":"https://www.microsoftpressstore.com/store/writing-secure-code-9780735617223"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Theoretical","Note":"This and similar problems exist because the same resource can have multiple identifiers that dictate which behavior can be performed on the resource."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Applicable_Platforms, Background_Details, Description, Relationships, Other_Notes, References, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-10-29","ModificationComment":"updated Other_Notes, Theoretical_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-04-05","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-12-13","ModificationComment":"updated Name"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Observed_Examples, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2018-03-27","ModificationComment":"updated References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Rename","PreviousEntryName":"Windows ::DATA Alternate Data Stream","Date":"2008-04-11"},{"Type":"Rename","PreviousEntryName":"Failure to Handle Windows ::DATA Alternate Data Stream","Date":"2010-12-13"}]}