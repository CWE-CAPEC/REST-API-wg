{"ID":"369","Name":"Divide By Zero","Abstraction":"Base","Structure":"Simple","Status":"Draft","Description":"The product divides a value by zero.","ExtendedDescription":"This weakness typically occurs when an unexpected value is provided to the product, or if an error occurs that is not properly detected. It frequently occurs in calculations involving physical dimensions such as size, length, width, and height.","LikelihoodOfExploit":"Medium","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"682","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"682","ViewID":"1003","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"682","ViewID":"1305","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"682","ViewID":"1340","Ordinal":"Primary"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Availability"],"Impact":["DoS: Crash, Exit, or Restart"],"Note":"A Divide by Zero results in a crash."}],"DetectionMethods":[{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)","Effectiveness":"High"},{"DetectionMethodID":"DM-13","Method":"Fuzzing","Description":"Fuzz testing (fuzzing) is a powerful technique for generating large numbers of diverse inputs - either randomly or algorithmically - and dynamically invoking the code with those inputs. Even with random inputs, it is often capable of generating unexpected results such as crashes, memory corruption, or resource consumption. Fuzzing effectively produces repeatable test cases that clearly indicate bugs, which helps developers to diagnose the issues.","Effectiveness":"High"}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"The following Java example contains a function to compute an average but does not validate that the input value used as the denominator is not zero. This will create an exception for attempting to divide by zero. If this error is not handled by Java exception handling, unexpected results can occur."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tpublic int computeAverageResponseTime (int totalTime, int numRequests) {\n\t\treturn totalTime / numRequests;\n\t}\n```"},{"BodyText":"By validating the input value used as the denominator the following code will ensure that a divide by zero error will not cause unexpected results. The following Java code example will validate the input value, output an error message, and throw an exception."},{"Nature":"Good","Language":"Java","ExampleCode":"```\n\tpublic int computeAverageResponseTime (int totalTime, int numRequests) throws ArithmeticException {\n\t\tif (numRequests == 0) {\n\t\t\tSystem.out.println(\"Division by zero attempted!\");\n\t\t\tthrow ArithmeticException;\n\t\t}\n\t\treturn totalTime / numRequests;\n\t}\n```"}]},{"Entries":[{"IntroText":"The following C/C++ example contains a function that divides two numeric values without verifying that the input value used as the denominator is not zero. This will create an error for attempting to divide by zero, if this error is not caught by the error handling capabilities of the language, unexpected results can occur."},{"Nature":"Bad","Language":"C","ExampleCode":"```\n\tdouble divide(double x, double y){\n\t\treturn x/y;\n\t}\n```"},{"BodyText":"By validating the input value used as the denominator the following code will ensure that a divide by zero error will not cause unexpected results. If the method is called and a zero is passed as the second argument a DivideByZero error will be thrown and should be caught by the calling block with an output message indicating the error."},{"Nature":"Good","Language":"C","ExampleCode":"```\n\tconst int DivideByZero = 10;\n\tdouble divide(double x, double y){\n\t\tif ( 0 == y ){\n\t\t\tthrow DivideByZero;\n\t\t}\n\t\treturn x/y;\n\t}\n\t...\n\ttry{\n\t\tdivide(10, 0);\n\t}\n\tcatch( int i ){\n\t\tif(i==DivideByZero) {\n\t\t\tcerr\u003c\u003c\"Divide by zero error\";\n\t\t}\n\t}\n```"},{"Reference":"REF-371"}]},{"Entries":[{"IntroText":"The following C# example contains a function that divides two numeric values without verifying that the input value used as the denominator is not zero. This will create an error for attempting to divide by zero, if this error is not caught by the error handling capabilities of the language, unexpected results can occur."},{"Nature":"Bad","Language":"C#","ExampleCode":"```\n\tint Division(int x, int y){\n\t\treturn (x / y);\n\t}\n```"},{"BodyText":"The method can be modified to raise, catch and handle the DivideByZeroException if the input value used as the denominator is zero."},{"Nature":"Good","Language":"C#","ExampleCode":"```\n\tint SafeDivision(int x, int y){\n\t\ttry{\n\t\t\treturn (x / y);\n\t\t}\n\t\tcatch (System.DivideByZeroException dbz){\n\t\t\tSystem.Console.WriteLine(\"Division by zero attempted!\");\n\t\t\treturn 0;\n\t\t}\n\t}\n```"},{"Reference":"REF-372"}]}],"ObservedExamples":[{"Reference":"CVE-2007-3268","Description":"Invalid size value leads to divide by zero.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-3268"},{"Reference":"CVE-2007-2723","Description":"\"Empty\" content triggers divide by zero.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-2723"},{"Reference":"CVE-2007-2237","Description":"Height value of 0 triggers divide by zero.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-2237"}],"TaxonomyMappings":[{"TaxonomyName":"OWASP Top Ten 2004","EntryID":"A9","EntryName":"Denial of Service","MappingFit":"CWE More Specific"},{"TaxonomyName":"CERT C Secure Coding","EntryID":"FLP03-C","EntryName":"Detect and handle floating point errors"},{"TaxonomyName":"CERT C Secure Coding","EntryID":"INT33-C","EntryName":"Ensure that division and remainder operations do not result in divide-by-zero errors","MappingFit":"Exact"},{"TaxonomyName":"The CERT Oracle Secure Coding Standard for Java (2011)","EntryID":"NUM02-J","EntryName":"Ensure that division and modulo operations do not result in divide-by-zero errors"},{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP1","EntryName":"Glitch in computation"}],"References":[{"ExternalReferenceID":"REF-371","Authors":["Alex Allain"],"Title":"Handling Errors Exceptionally Well in C++","URL":"https://www.cprogramming.com/tutorial/exceptions.html","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-372","Authors":["Microsoft"],"Title":"Exceptions and Exception Handling (C# Programming Guide)","URL":"https://msdn.microsoft.com/pl-pl/library/ms173160(v=vs.100).aspx"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Community","SubmissionDate":"2008-04-11","SubmissionComment":"Submitted by members of the CWE community to extend early CWE versions","SubmissionVersion":"Draft 9","SubmissionReleaseDate":"2008-04-11"},{"Type":"Modification","ModificationName":"Sean Eidemiller","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"added/updated demonstrative examples"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Common_Consequences, Description, Relationships, Other_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-11-24","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-05-27","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-10-29","ModificationComment":"updated Other_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-09-13","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2015-12-07","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Demonstrative_Examples, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-08-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-12-10","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Demonstrative_Examples, Detection_Factors, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-04-03","ModificationComment":"updated Demonstrative_Examples","ModificationVersion":"4.17","ModificationReleaseDate":"2025-04-03"}]}