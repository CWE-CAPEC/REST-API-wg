{"ID":"1037","Name":"Processor Optimization Removal or Modification of Security-critical Code","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The developer builds a security-critical protection mechanism into the software, but the processor optimizes the execution of the program such that the mechanism is removed or modified.","LikelihoodOfExploit":"Low","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"1038","ViewID":"1000","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Primary","Description":"This weakness does not depend on other weaknesses and is the result of choices made by the processor in executing the specified application."}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Rarely"},{"Type":"Technology","Name":"Processor Hardware","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design","Note":"Optimizations built into the design of the processor can have unintended consequences during the execution of an application."}],"CommonConsequences":[{"Scope":["Integrity"],"Impact":["Bypass Protection Mechanism"],"Likelihood":["High"],"Note":"A successful exploitation of this weakness will change the order of an application's execution and will likely be used to bypass specific protection mechanisms. This bypass can be exploited further to potentially read data that should otherwise be unaccessible."}],"DetectionMethods":[{"Method":"White Box","Description":"In theory this weakness can be detected through the use of white box testing techniques where specifically crafted test cases are used in conjunction with debuggers to verify the order of statements being executed.","Effectiveness":"Opportunistic","EffectivenessNotes":"Although the mentioned detection method is theoretically possible, the use of speculative execution is a preferred way of increasing processor performance. The reality is that a large number of statements are executed out of order, and determining if any of them break an access control property would be extremely opportunistic."}],"ObservedExamples":[{"Reference":"CVE-2017-5715","Description":"Intel, ARM, and AMD processor optimizations related to speculative execution and branch prediction cause access control checks to be bypassed when placing data into the cache. Often known as \"Spectre\".","Link":"https://www.cve.org/CVERecord?id=CVE-2017-5715"},{"Reference":"CVE-2017-5753","Description":"Intel, ARM, and AMD processor optimizations related to speculative execution and branch prediction cause access control checks to be bypassed when placing data into the cache. Often known as \"Spectre\".","Link":"https://www.cve.org/CVERecord?id=CVE-2017-5753"},{"Reference":"CVE-2017-5754","Description":"Intel processor optimizations related to speculative execution cause access control checks to be bypassed when placing data into the cache. Often known as \"Meltdown\".","Link":"https://www.cve.org/CVERecord?id=CVE-2017-5754"}],"RelatedAttackPatterns":["663"],"References":[{"ExternalReferenceID":"REF-11","Authors":["Paul Kocher","Daniel Genkin","Daniel Gruss","Werner Haas","Mike Hamburg","Moritz Lipp","Stefan Mangard","Thomas Prescher","Michael Schwarz","Yuval Yarom"],"Title":"Spectre Attacks: Exploiting Speculative Execution","PublicationYear":"2018","PublicationMonth":"01","PublicationDay":"03","URL":"https://arxiv.org/abs/1801.01203"},{"ExternalReferenceID":"REF-12","Authors":["Moritz Lipp","Michael Schwarz","Daniel Gruss","Thomas Prescher","Werner Haas","Stefan Mangard","Paul Kocher","Daniel Genkin","Yuval Yarom","Mike Hamburg"],"Title":"Meltdown","PublicationYear":"2018","PublicationMonth":"01","PublicationDay":"03","URL":"https://arxiv.org/abs/1801.01207"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Maintenance","Note":"As of CWE 4.9, members of the CWE Hardware SIG are closely analyzing this entry and others to improve CWE's coverage of transient execution weaknesses, which include issues related to Spectre, Meltdown, and other attacks. Additional investigation may include other weaknesses related to microarchitectural state. As a result, this entry might change significantly in CWE 4.10."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2018-03-07","SubmissionVersion":"3.1","SubmissionReleaseDate":"2018-03-29"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-06-25","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Applicable_Platforms, Maintenance_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}