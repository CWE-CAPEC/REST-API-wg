{"ID":"705","Name":"Incorrect Control Flow Scoping","Abstraction":"Class","Structure":"Simple","Status":"Incomplete","Description":"The product does not properly return control flow to the proper location after it has completed a task or detected an unusual condition.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"691","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Other"],"Impact":["Alter Execution Logic","Other"]}],"DemonstrativeExamples":[{"ID":"DX-39","Entries":[{"IntroText":"The following example attempts to resolve a hostname."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tprotected void doPost (HttpServletRequest req, HttpServletResponse res) throws IOException {\n\t\tString ip = req.getRemoteAddr();\n\t\tInetAddress addr = InetAddress.getByName(ip);\n\t\t...\n\t\tout.println(\"hello \" + addr.getHostName());\n\t}\n```"},{"BodyText":"A DNS lookup failure will cause the Servlet to throw an exception."}]},{"ID":"DX-180","Entries":[{"IntroText":"This code queries a server and displays its status when a request comes from an authorized IP address."},{"Nature":"Bad","Language":"PHP","ExampleCode":"```\n\t$requestingIP = $_SERVER['REMOTE_ADDR'];\n\tif(!in_array($requestingIP,$ipAllowList)){\n\t\techo \"You are not authorized to view this page\";\n\t\thttp_redirect($errorPageURL);\n\t}\n\t$status = getServerStatus();\n\techo $status;\n```\n...*"},{"BodyText":"This code redirects unauthorized users, but continues to execute code after calling http_redirect(). This means even unauthorized users may be able to access the contents of the page or perform a DoS attack on the server being queried. Also, note that this code is vulnerable to an IP address spoofing attack (CWE-212)."}]},{"ID":"DX-199","Entries":[{"IntroText":"Included in the doPost() method defined below is a call to System.exit() in the event of a specific exception."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tPublic void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n\t\ttry {\n\t\t\t...\n\t\t} catch (ApplicationSpecificException ase) {\n\t\t\tlogger.error(\"Caught: \" + ase.toString());\n\t\t\tSystem.exit(1);\n\t\t}\n\t}\n```"}]}],"ObservedExamples":[{"Reference":"CVE-2023-21087","Description":"Java code in a smartphone OS can encounter a \"boot loop\" due to an uncaught exception","Link":"https://www.cve.org/CVERecord?id=CVE-2023-21087"},{"Reference":"CVE-2014-1266","Description":"chain: incorrect \"goto\" in Apple SSL product bypasses certificate validation, allowing Adversary-in-the-Middle (AITM) attack (Apple \"goto fail\" bug). CWE-705 (Incorrect Control Flow Scoping) -\u003e CWE-561 (Dead Code) -\u003e CWE-295 (Improper Certificate Validation) -\u003e CWE-393 (Return of Wrong Status Code) -\u003e CWE-300 (Channel Accessible by Non-Endpoint).","Link":"https://www.cve.org/CVERecord?id=CVE-2014-1266"}],"TaxonomyMappings":[{"TaxonomyName":"CERT C Secure Coding","EntryID":"ENV32-C","EntryName":"All exit handlers must return normally","MappingFit":"CWE More Abstract"},{"TaxonomyName":"CERT C Secure Coding","EntryID":"ERR04-C","EntryName":"Choose an appropriate termination strategy"},{"TaxonomyName":"The CERT Oracle Secure Coding Standard for Java (2011)","EntryID":"THI05-J","EntryName":"Do not use Thread.stop() to terminate threads"},{"TaxonomyName":"The CERT Oracle Secure Coding Standard for Java (2011)","EntryID":"ERR04-J","EntryName":"Do not complete abruptly from a finally block"},{"TaxonomyName":"The CERT Oracle Secure Coding Standard for Java (2011)","EntryID":"ERR05-J","EntryName":"Do not let checked exceptions escape from a finally block"},{"TaxonomyName":"SEI CERT Perl Coding Standard","EntryID":"EXP31-PL","EntryName":"Do not suppress or ignore exceptions","MappingFit":"Imprecise"}],"MappingNotes":{"Usage":"Allowed-with-Review","Rationale":"This CWE entry is a Class and might have Base-level children that would be more appropriate","Comments":"Examine children of this entry to see if there is a better fit","Reasons":["Abstraction"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2008-09-09","SubmissionComment":"Note: this date reflects when the entry was first published. Draft versions of this entry were provided to members of the CWE community and modified between Draft 9 and 1.0.","SubmissionVersion":"1.0","SubmissionReleaseDate":"2008-09-09"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-11-24","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-09-13","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-06-23","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-01-19","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Observed_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-07-20","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2024-02-29","ModificationComment":"updated Demonstrative_Examples, Observed_Examples","ModificationVersion":"4.14","ModificationReleaseDate":"2024-02-29"}]}