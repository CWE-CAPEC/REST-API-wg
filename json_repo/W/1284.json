{"ID":"1284","Name":"Improper Validation of Specified Quantity in Input","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.","ExtendedDescription":"\n\nSpecified quantities include size, length, frequency, price, rate, number of operations, time, and others. Code may rely on specified quantities to allocate resources, perform calculations, control iteration, etc. \n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"20","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"20","ViewID":"1003","Ordinal":"Primary"},{"Nature":"CanPrecede","CweID":"789","ViewID":"1000"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Often"}],"ModesOfIntroduction":[{"Phase":"Implementation","Note":"Since quantities are often used to affect resource allocation or process financial data, they are often present in many places in the code."}],"CommonConsequences":[{"Scope":["Other","Integrity","Availability"],"Impact":["Varies by Context","DoS: Resource Consumption (CPU)","Modify Memory","Read Memory"],"Note":"When the quantity is not properly validated, then attackers can specify malicious quantities to cause excessive resource allocation, trigger unexpected failures, enable buffer overflows, etc."}],"DetectionMethods":[{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)"}],"PotentialMitigations":[{"MitigationID":"MIT-5","Phase":["Implementation"],"Strategy":"Input Validation","Description":"\n\nAssume all input is malicious. Use an \"accept known good\" input validation strategy, i.e., use a list of acceptable inputs that strictly conform to specifications. Reject any input that does not strictly conform to specifications, or transform it into something that does.\n\n\nWhen performing input validation, consider all potentially relevant properties, including length, type of input, the full range of acceptable values, missing or extra inputs, syntax, consistency across related fields, and conformance to business rules. As an example of business rule logic, \"boat\" may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as \"red\" or \"blue.\"\n\n\nDo not rely exclusively on looking for malicious or malformed inputs. This is likely to miss at least one undesirable input, especially if the code's environment changes. This can give attackers enough room to bypass the intended validation. However, denylists can be useful for detecting potential attacks or determining which inputs are so malformed that they should be rejected outright.\n","Effectiveness":"High"}],"DemonstrativeExamples":[{"ID":"DX-135","Entries":[{"IntroText":"This example demonstrates a shopping interaction in which the user is free to specify the quantity of items to be purchased and a total is calculated."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\t...\n\tpublic static final double price = 20.00;\n\tint quantity = currentUser.getAttribute(\"quantity\");\n\tdouble total = price * quantity;\n\tchargeUser(total);\n\t...\n```"},{"BodyText":"The user has no control over the price variable, however the code does not prevent a negative value from being specified for quantity. If an attacker were to provide a negative value, then the user would have their account credited instead of debited."}]},{"ID":"DX-136","Entries":[{"IntroText":"This example asks the user for a height and width of an m X n game board with a maximum dimension of 100 squares."},{"Nature":"Bad","Language":"C","ExampleCode":"```\n\t...\n\t#define MAX_DIM 100\n\t...\n```\n/* board dimensions */* \n\t\n\tint m,n, error;\n\tboard_square_t *board;\n\tprintf(\"Please specify the board height: \\n\");\n\terror = scanf(\"%d\", \u0026m);\n\tif ( EOF == error ){\n\t```\n\t\tdie(\"No integer passed: Die evil hacker!\\n\");\n\t}\n\tprintf(\"Please specify the board width: \\n\");\n\terror = scanf(\"%d\", \u0026n);\n\tif ( EOF == error ){\n\t\tdie(\"No integer passed: Die evil hacker!\\n\");\n\t}\n\tif ( m \u003e MAX_DIM || n \u003e MAX_DIM ) {\n\t\tdie(\"Value too large: Die evil hacker!\\n\");\n\t}\n\tboard = (board_square_t*) malloc( m * n * sizeof(board_square_t));\n\t...\n```"},{"BodyText":"While this code checks to make sure the user cannot specify large, positive integers and consume too much memory, it does not check for negative values supplied by the user. As a result, an attacker can perform a resource consumption (CWE-400) attack against this program by specifying two, large negative values that will not overflow, resulting in a very large memory allocation (CWE-789) and possibly a system crash. Alternatively, an attacker can provide very large negative values which will cause an integer overflow (CWE-190) and unexpected behavior will follow depending on how the values are treated in the remainder of the program."}]},{"ID":"DX-236","Entries":[{"IntroText":"The following code is a workflow job written using YAML. The code attempts to download pull request artifacts, unzip from the artifact called pr.zip and extract the value of the file NR into a variable \"pr_number\" that will be used later in another job. It attempts to create a github workflow environment variable, writing to $GITHUB_ENV. The environment variable value is retrieved from an external resource."},{"Nature":"Bad","Language":"Other","ExampleCode":"name: Deploy Preview\n jobs:\n\n```\n\t deploy:\n\t\t runs-on: ubuntu-latest\n\t\t steps:\n\t\t\t - name: 'Download artifact'\n\t\t\t uses: actions/github-script\n\t\t\t with:\n\t\t\t\t script: |\n\t\t\t\t\t var artifacts = await github.actions.listWorkflowRunArtifacts({\n\t\t\t\t\t\t owner: context.repo.owner,\n\t\t\t\t\t\t repo: context.repo.repo,\n\t\t\t\t\t\t run_id: ${{ github.event.workflow_run.id }},\n\t\t\t\t\t });\n\t\t\t\t\t var matchPrArtifact = artifacts.data.artifacts.filter((artifact) =\u003e {\n\t\t\t\t\t\t return artifact.name == \"pr\"\n\t\t\t\t\t })[0];\n\t\t\t\t\t var downloadPr = await github.actions.downloadArtifact({\n\t\t\t\t\t\t owner: context.repo.owner,\n\t\t\t\t\t\t repo: context.repo.repo,\n\t\t\t\t\t\t artifact_id: matchPrArtifact.id,\n\t\t\t\t\t\t archive_format: 'zip',\n\t\t\t\t\t });\n\t\t\t\t\t var fs = require('fs');\n\t\t\t\t\t fs.writeFileSync('${{github.workspace}}/pr.zip', Buffer.from(downloadPr.data));\n\t\t\t - run: |\n\t\t\t\t unzip pr.zip\n\t\t\t\t echo \"pr_number=$(cat NR)\" \u003e\u003e $GITHUB_ENV \n```"},{"BodyText":"The code does not neutralize the value of the file NR, e.g. by validating that NR only contains a number (CWE-1284). The NR file is attacker controlled because it originates from a pull request that produced pr.zip.\n\n\nThe attacker could escape the existing pr_number and create a new variable using a \"\\n\" (CWE-93) followed by any environment variable to be added such as:"},{"Nature":"Attack","ExampleCode":"\\nNODE_OPTIONS=\"--experimental-modules --experiments-loader=data:text/javascript,console.log('injected code');//\""},{"BodyText":"This would result in injecting and running javascript code (CWE-94) on the workflow runner with elevated privileges."},{"Nature":"Good","Language":"Other","ExampleCode":"The code could be modified to validate that the NR file only contains a numeric value, or the code could retrieve the PR number from a more trusted source."}]}],"ObservedExamples":[{"Reference":"CVE-2025-46687","Description":"Chain: Javascript engine code does not perform a length check (CWE-1284) leading to integer overflow (CWE-190) causing allocation of smaller buffer than expected (CWE-131) resulting in a heap-based buffer overflow (CWE-122)","Link":"https://www.cve.org/CVERecord?id=CVE-2025-46687"},{"Reference":"CVE-2019-19911","Description":"Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).","Link":"https://www.cve.org/CVERecord?id=CVE-2019-19911"},{"Reference":"CVE-2008-1440","Description":"lack of validation of length field leads to infinite loop","Link":"https://www.cve.org/CVERecord?id=CVE-2008-1440"},{"Reference":"CVE-2008-2374","Description":"lack of validation of string length fields allows memory consumption or buffer over-read","Link":"https://www.cve.org/CVERecord?id=CVE-2008-2374"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Maintenance","Note":"This entry is still under development and will continue to see updates and content improvements."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2020-06-24","SubmissionVersion":"4.1","SubmissionReleaseDate":"2020-02-24"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Observed_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-09-09","ModificationComment":"updated Observed_Examples","ModificationVersion":"4.18","ModificationReleaseDate":"2025-09-09"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-12-11","ModificationComment":"updated Common_Consequences, Demonstrative_Examples, Description, Detection_Factors, Modes_of_Introduction, Observed_Examples, Weakness_Ordinalities","ModificationVersion":"4.19","ModificationReleaseDate":"2025-12-11"}]}