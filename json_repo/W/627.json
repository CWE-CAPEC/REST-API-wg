{"ID":"627","Name":"Dynamic Variable Evaluation","Abstraction":"Variant","Structure":"Simple","Status":"Incomplete","Description":"In a language where the user can influence the name of a variable at runtime, if the variable names are not controlled, an attacker can read or write to arbitrary variables, or access arbitrary functions.","ExtendedDescription":"The resultant vulnerabilities depend on the behavior of the application, both at the crossover point and in any control/data flow that is reachable by the related variables or functions.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"914","ViewID":"1000","Ordinal":"Primary"},{"Nature":"PeerOf","CweID":"183","ViewID":"1000"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Name":"PHP","Prevalence":"Undetermined"},{"Type":"Language","Name":"Perl","Prevalence":"Undetermined"}],"BackgroundDetails":["Many interpreted languages support the use of a \"$$varname\" construct to set a variable whose name is specified by the $varname variable. In PHP, these are referred to as \"variable variables.\" Functions might also be invoked using similar syntax, such as $$funcname(arg1, arg2)."],"AlternateTerms":[{"Term":"Dynamic evaluation"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Confidentiality","Integrity","Availability"],"Impact":["Modify Application Data","Execute Unauthorized Code or Commands"],"Note":"An attacker could gain unauthorized access to internal program variables and execute arbitrary code."}],"PotentialMitigations":[{"Phase":["Implementation"],"Strategy":"Refactoring","Description":"Refactor the code to avoid dynamic variable evaluation whenever possible."},{"Phase":["Implementation"],"Strategy":"Input Validation","Description":"Use only allowlists of acceptable variable or function names."},{"Phase":["Implementation"],"Description":"For function names, ensure that you are only calling functions that accept the proper number of arguments, to avoid unexpected null arguments."}],"ObservedExamples":[{"Reference":"CVE-2009-0422","Description":"Chain: Dynamic variable evaluation allows resultant remote file inclusion and path traversal.","Link":"https://www.cve.org/CVERecord?id=CVE-2009-0422"},{"Reference":"CVE-2007-2431","Description":"Chain: dynamic variable evaluation in PHP program used to modify critical, unexpected $_SERVER variable for resultant XSS.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-2431"},{"Reference":"CVE-2006-4904","Description":"Chain: dynamic variable evaluation in PHP program used to conduct remote file inclusion.","Link":"https://www.cve.org/CVERecord?id=CVE-2006-4904"},{"Reference":"CVE-2006-4019","Description":"Dynamic variable evaluation in mail program allows reading and modifying attachments and preferences of other users.","Link":"https://www.cve.org/CVERecord?id=CVE-2006-4019"}],"References":[{"ExternalReferenceID":"REF-517","Authors":["Steve Christey"],"Title":"Dynamic Evaluation Vulnerabilities in PHP applications","Publication":"Full-Disclosure","PublicationYear":"2006","PublicationMonth":"05","PublicationDay":"03","URL":"https://seclists.org/fulldisclosure/2006/May/35","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-518","Authors":["Shaun Clowes"],"Title":"A Study In Scarlet: Exploiting Common Vulnerabilities in PHP Applications","URL":"https://securereality.com.au/study-in-scarlett/","URLDate":"2023-04-07"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Research Gap","Note":"Under-studied, probably under-reported. Few researchers look for this issue; most public reports are for PHP, although other languages are affected. This issue is likely to grow in PHP as developers begin to implement functionality in place of register_globals."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2007-05-07","SubmissionVersion":"Draft 6","SubmissionReleaseDate":"2007-05-07"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Applicable_Platforms, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Background_Details, Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Common_Consequences, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2013-02-21","ModificationComment":"updated Common_Consequences, Observed_Examples, Potential_Mitigations, Relationships, Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-06-25","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships, Type"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}