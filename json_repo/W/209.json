{"ID":"209","Name":"Generation of Error Message Containing Sensitive Information","Abstraction":"Base","Structure":"Simple","Status":"Draft","Description":"The product generates an error message that includes sensitive information about its environment, users, or associated data.","ExtendedDescription":"\n\nThe sensitive information may be valuable information on its own (such as a password), or it may be useful for launching other, more serious attacks. The error message may be created in different ways:\n\n\n  - self-generated: the source code explicitly constructs the error message and delivers it\n\n  - externally-generated: the external environment, such as a language interpreter, handles the error and constructs its own message, whose contents are not under direct control by the programmer\n\nAn attacker may use the contents of error messages to help launch another, more focused attack. For example, an attempt to exploit a path traversal weakness (CWE-22) might yield the full pathname of the installed application. In turn, this could be used to select the proper number of \"..\" sequences to navigate to the targeted file. An attack using SQL injection (CWE-89) might not initially succeed, but an error message could reveal the malformed query, which would expose query logic and possibly even passwords or other sensitive information used within the query.","LikelihoodOfExploit":"High","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"200","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"200","ViewID":"1003","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"755","ViewID":"1000"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"},{"Ordinality":"Resultant"}],"ApplicablePlatforms":[{"Type":"Language","Name":"PHP","Prevalence":"Often"},{"Type":"Language","Name":"Java","Prevalence":"Often"},{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design"},{"Phase":"Implementation","Note":"REALIZATION: This weakness is caused during implementation of an architectural security tactic."},{"Phase":"System Configuration"},{"Phase":"Operation"}],"CommonConsequences":[{"Scope":["Confidentiality"],"Impact":["Read Application Data"],"Note":"Often this will either reveal sensitive information which may be used for a later attack or private information stored in the server."}],"DetectionMethods":[{"Method":"Manual Analysis","Description":"This weakness generally requires domain-specific interpretation using manual analysis. However, the number of potential error conditions may be too large to cover completely within limited time constraints.","Effectiveness":"High"},{"Method":"Automated Analysis","Description":"Automated methods may be able to detect certain idioms automatically, such as exposed stack traces or pathnames, but violation of business rules or privacy requirements is not typically feasible.","Effectiveness":"Moderate"},{"DetectionMethodID":"DM-2","Method":"Automated Dynamic Analysis","Description":"\n\nThis weakness can be detected using dynamic tools and techniques that interact with the software using large test suites with many diverse inputs, such as fuzz testing (fuzzing), robustness testing, and fault injection. The software's operation may slow down, but it should not become unstable, crash, or generate incorrect results.\n\n\nError conditions may be triggered with a stress-test by calling the software simultaneously from a large number of threads or processes, and look for evidence of any unexpected behavior.\n","Effectiveness":"Moderate"},{"DetectionMethodID":"DM-12","Method":"Manual Dynamic Analysis","Description":"Identify error conditions that are not likely to occur during normal usage and trigger them. For example, run the program under low memory conditions, run with insufficient privileges or permissions, interrupt a transaction before it is completed, or disable connectivity to basic network services such as DNS. Monitor the software for any unexpected behavior. If you trigger an unhandled exception or similar error that was discovered and handled by the application's environment, it may still indicate unexpected conditions that were not handled by the application itself."},{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)"}],"PotentialMitigations":[{"MitigationID":"MIT-39","Phase":["Implementation"],"Description":"\n\nEnsure that error messages only contain minimal details that are useful to the intended audience and no one else. The messages need to strike the balance between being too cryptic (which can confuse users) or being too detailed (which may reveal more than intended). The messages should not reveal the methods that were used to determine the error. Attackers can use detailed information to refine or optimize their original attack, thereby increasing their chances of success.\n\n\nIf errors must be captured in some detail, record them in log messages, but consider what could occur if the log messages can be viewed by attackers. Highly sensitive information such as passwords should never be saved to log files.\n\n\nAvoid inconsistent messaging that might accidentally tip off an attacker about internal state, such as whether a user account exists or not.\n"},{"Phase":["Implementation"],"Description":"Handle exceptions internally and do not display errors containing potentially sensitive information to a user."},{"MitigationID":"MIT-33","Phase":["Implementation"],"Strategy":"Attack Surface Reduction","Description":"Use naming conventions and strong types to make it easier to spot when sensitive data is being used. When creating structures, objects, or other complex entities, separate the sensitive and non-sensitive data as much as possible.","Effectiveness":"Defense in Depth","EffectivenessNotes":"This makes it easier to spot places in the code where data is being used that is unencrypted."},{"MitigationID":"MIT-40","Phase":["Implementation","Build and Compilation"],"Strategy":"Compilation or Build Hardening","Description":"Debugging information should not make its way into a production release."},{"MitigationID":"MIT-40","Phase":["Implementation","Build and Compilation"],"Strategy":"Environment Hardening","Description":"Debugging information should not make its way into a production release."},{"Phase":["System Configuration"],"Description":"Where available, configure the environment to use less verbose error messages. For example, in PHP, disable the display_errors setting during configuration, or at runtime using the error_reporting() function."},{"Phase":["System Configuration"],"Description":"Create default error pages or messages that do not leak any information."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"In the following example, sensitive information might be printed depending on the exception that occurs."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\ttry {\n\t\t/.../\n\t}\n\tcatch (Exception e) {\n\t\tSystem.out.println(e);\n\t}\n```"},{"BodyText":"If an exception related to SQL is handled by the catch, then the output might contain sensitive information such as SQL query structure or private information. If this output is redirected to a web user, this may represent a security problem."}]},{"ID":"DX-118","Entries":[{"IntroText":"This code tries to open a database connection, and prints any exceptions that occur."},{"Nature":"Bad","Language":"PHP","ExampleCode":"```\n\ttry {\n\t\topenDbConnection();\n\t}\n```\n//print exception message that includes exception message and configuration file location* \n\tcatch (Exception $e) {\n\t```\n\t\techo 'Caught exception: ', $e-\u003egetMessage(), '\\n';\n\t\techo 'Check credentials in config file at: ', $Mysql_config_location, '\\n';\n\t}\n```"},{"BodyText":"If an exception occurs, the printed message exposes the location of the configuration file the script is using. An attacker can use this information to target the configuration file (perhaps exploiting a Path Traversal weakness). If the file can be read, the attacker could gain credentials for accessing the database. The attacker may also be able to replace the file with a malicious one, causing the application to use an arbitrary database."}]},{"Entries":[{"IntroText":"The following code generates an error message that leaks the full pathname of the configuration file."},{"Nature":"Bad","Language":"Perl","ExampleCode":"```\n\t$ConfigDir = \"/home/myprog/config\";\n\t$uname = GetUserInput(\"username\");\n```\n# avoid CWE-22, CWE-78, others.* \n\tExitError(\"Bad hacker!\") if ($uname !~ /^\\w+$/);\n\t$file = \"$ConfigDir/$uname.txt\";\n\tif (! (-e $file)) {\n\t```\n\t\tExitError(\"Error: $file does not exist\");\n\t}\n\t...\n```"},{"BodyText":"If this code is running on a server, such as a web application, then the person making the request should not know what the full pathname of the configuration directory is. By submitting a username that does not produce a $file that exists, an attacker could get this pathname. It could then be used to exploit path traversal or symbolic link following problems that may exist elsewhere in the application."}]},{"ID":"DX-119","Entries":[{"IntroText":"In the example below, the method getUserBankAccount retrieves a bank account object from a database using the supplied username and account number to query the database. If an SQLException is raised when querying the database, an error message is created and output to a log file."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tpublic BankAccount getUserBankAccount(String username, String accountNumber) {\n\t\t\tBankAccount userAccount = null;\n\t\t\tString query = null;\n\t\t\ttry {\n\t\t\t\tif (isAuthorizedUser(username)) {\n\t\t\t\t\tquery = \"SELECT * FROM accounts WHERE owner = \"\n\t\t\t\t\t+ username + \" AND accountID = \" + accountNumber;\n\t\t\t\t\tDatabaseManager dbManager = new DatabaseManager();\n\t\t\t\t\tConnection conn = dbManager.getConnection();\n\t\t\t\t\tStatement stmt = conn.createStatement();\n\t\t\t\t\tResultSet queryResult = stmt.executeQuery(query);\n\t\t\t\t\tuserAccount = (BankAccount)queryResult.getObject(accountNumber);\n\t\t\t\t}\n\t\t\t} catch (SQLException ex) {\n\t\t\t\tString logMessage = \"Unable to retrieve account information from database,\\nquery: \" + query;\n\t\t\t\tLogger.getLogger(BankManager.class.getName()).log(Level.SEVERE, logMessage, ex);\n\t\t\t}\n\t\t\treturn userAccount;\n\t}\n```"},{"BodyText":"The error message that is created includes information about the database query that may contain sensitive information about the database or query logic. In this case, the error message will expose the table name and column names used in the database. This data could be used to simplify other attacks, such as SQL injection (CWE-89) to directly access the database."}]}],"ObservedExamples":[{"Reference":"CVE-2008-2049","Description":"POP3 server reveals a password in an error message after multiple APOP commands are sent. Might be resultant from another weakness.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-2049"},{"Reference":"CVE-2007-5172","Description":"Program reveals password in error message if attacker can trigger certain database errors.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-5172"},{"Reference":"CVE-2008-4638","Description":"Composite: application running with high privileges (CWE-250) allows user to specify a restricted file to process, which generates a parsing error that leaks the contents of the file (CWE-209).","Link":"https://www.cve.org/CVERecord?id=CVE-2008-4638"},{"Reference":"CVE-2008-1579","Description":"Existence of user names can be determined by requesting a nonexistent blog and reading the error message.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-1579"},{"Reference":"CVE-2007-1409","Description":"Direct request to library file in web application triggers pathname leak in error message.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-1409"},{"Reference":"CVE-2008-3060","Description":"Malformed input to login page causes leak of full path when IMAP call fails.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-3060"},{"Reference":"CVE-2005-0603","Description":"Malformed regexp syntax leads to information exposure in error message.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-0603"},{"Reference":"CVE-2017-9615","Description":"verbose logging stores admin credentials in a world-readablelog file","Link":"https://www.cve.org/CVERecord?id=CVE-2017-9615"},{"Reference":"CVE-2018-1999036","Description":"SSH password for private key stored in build log","Link":"https://www.cve.org/CVERecord?id=CVE-2018-1999036"}],"TaxonomyMappings":[{"TaxonomyName":"CLASP","EntryName":"Accidental leaking of sensitive information through error messages"},{"TaxonomyName":"OWASP Top Ten 2007","EntryID":"A6","EntryName":"Information Leakage and Improper Error Handling","MappingFit":"CWE More Specific"},{"TaxonomyName":"OWASP Top Ten 2004","EntryID":"A7","EntryName":"Improper Error Handling","MappingFit":"CWE More Specific"},{"TaxonomyName":"OWASP Top Ten 2004","EntryID":"A10","EntryName":"Insecure Configuration Management","MappingFit":"CWE More Specific"},{"TaxonomyName":"The CERT Oracle Secure Coding Standard for Java (2011)","EntryID":"ERR01-J","EntryName":"Do not allow exceptions to expose sensitive information"},{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP23","EntryName":"Exposed Data"}],"RelatedAttackPatterns":["215","463","54","7"],"References":[{"ExternalReferenceID":"REF-174","Authors":["Web Application Security Consortium"],"Title":"Information Leakage","URL":"http://projects.webappsec.org/w/page/13246936/Information%20Leakage","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-175","Section":"Section 9.2, Page 326","Authors":["Brian Chess","Jacob West"],"Title":"Secure Programming with Static Analysis","PublicationYear":"2007","Publisher":"Addison-Wesley"},{"ExternalReferenceID":"REF-176","Section":"Chapter 16, \"General Good Practices.\" Page 415","Authors":["Michael Howard","David LeBlanc"],"Title":"Writing Secure Code","Edition":"1st Edition","PublicationYear":"2001","PublicationMonth":"11","PublicationDay":"13","Publisher":"Microsoft Press"},{"ExternalReferenceID":"REF-44","Section":"\"Sin 11: Failure to Handle Errors Correctly.\" Page 183","Authors":["Michael Howard","David LeBlanc","John Viega"],"Title":"24 Deadly Sins of Software Security","Publication":"McGraw-Hill","PublicationYear":"2010"},{"ExternalReferenceID":"REF-44","Section":"\"Sin 12: Information Leakage.\" Page 191","Authors":["Michael Howard","David LeBlanc","John Viega"],"Title":"24 Deadly Sins of Software Security","Publication":"McGraw-Hill","PublicationYear":"2010"},{"ExternalReferenceID":"REF-179","Authors":["Johannes Ullrich"],"Title":"Top 25 Series - Rank 16 - Information Exposure Through an Error Message","PublicationYear":"2010","PublicationMonth":"03","PublicationDay":"17","Publisher":"SANS Software Security Institute","URL":"http://software-security.sans.org/blog/2010/03/17/top-25-series-rank-16-information-exposure-through-an-error-message"},{"ExternalReferenceID":"REF-62","Section":"Chapter 3, \"Overly Verbose Error Messages\", Page 75","Authors":["Mark Dowd","John McDonald","Justin Schuh"],"Title":"The Art of Software Security Assessment","Edition":"1st Edition","PublicationYear":"2006","Publisher":"Addison Wesley"},{"ExternalReferenceID":"REF-18","Authors":["Secure Software, Inc."],"Title":"The CLASP Application Security Process","PublicationYear":"2005","URL":"https://cwe.mitre.org/documents/sources/TheCLASPApplicationSecurityProcess.pdf","URLDate":"2024-11-17"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CLASP","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationOrganization":"Veracode","ModificationDate":"2008-08-15","ModificationComment":"Suggested OWASP Top Ten 2004 mapping"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Applicable_Platforms, Common_Consequences, Relationships, Other_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-01-12","ModificationComment":"updated Demonstrative_Examples, Description, Name, Observed_Examples, Other_Notes, Potential_Mitigations, Relationships, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-03-10","ModificationComment":"updated Demonstrative_Examples, Potential_Mitigations, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-12-28","ModificationComment":"updated Demonstrative_Examples, Name, Potential_Mitigations, References, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-02-16","ModificationComment":"updated Detection_Factors, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-04-05","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-06-21","ModificationComment":"updated Common_Consequences, Detection_Factors, Potential_Mitigations, References"},{"Type":"Modification","ModificationOrganization":"Veracode","ModificationDate":"2010-09-09","ModificationComment":"Suggested OWASP Top Ten mapping"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-09-27","ModificationComment":"updated Potential_Mitigations, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Demonstrative_Examples, Observed_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-09-13","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated References, Related_Attack_Patterns, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2013-07-17","ModificationComment":"updated References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-06-23","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Modes_of_Introduction, References, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2018-03-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-06-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-09-19","ModificationComment":"updated Demonstrative_Examples, Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Applicable_Platforms, Description, Name, Observed_Examples, References, Relationships, Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-12-10","ModificationComment":"updated Potential_Mitigations, Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-07-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Detection_Factors, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Contribution","ContributionName":"Nick Johnston","ContributionDate":"2022-07-11","ContributionComment":"Identified incorrect language tag in demonstrative example.","ContributionType":"Feedback"},{"Type":"Rename","PreviousEntryName":"Error Message Information Leaks","Date":"2009-01-12"},{"Type":"Rename","PreviousEntryName":"Error Message Information Leak","Date":"2009-12-28"},{"Type":"Rename","PreviousEntryName":"Information Exposure Through an Error Message","Date":"2020-02-24"}]}