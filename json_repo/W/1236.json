{"ID":"1236","Name":"Improper Neutralization of Formula Elements in a CSV File","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The product saves user-provided information into a Comma-Separated Value (CSV) file, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as a command when the file is opened by a spreadsheet product.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"74","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"74","ViewID":"1003","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Operating_System","Class":"Not OS-Specific","Prevalence":"Undetermined"},{"Type":"Architecture","Class":"Not Architecture-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Other","Prevalence":"Undetermined"}],"BackgroundDetails":["User-provided data is often saved to traditional databases. This data can be exported to a CSV file, which allows users to read the data using spreadsheet software such as Excel, Numbers, or Calc. This software interprets entries beginning with '=' as formulas, which are then executed by the spreadsheet software. The software's formula language often allows methods to access hyperlinks or the local command line, and frequently allows enough characters to invoke an entire script."],"AlternateTerms":[{"Term":"CSV Injection"},{"Term":"Formula Injection"},{"Term":"Excel Macro Injection"}],"ModesOfIntroduction":[{"Phase":"Implementation","Note":"The weakness is in the implementation of a software's CSV export feature, in particular how it formats formula entries as the output gets flattened into a text file."}],"CommonConsequences":[{"Scope":["Confidentiality"],"Impact":["Read Application Data","Execute Unauthorized Code or Commands"],"Likelihood":["Low"],"Note":"Attackers can populate data fields which, when saved to a CSV file, may attempt information exfiltration or other malicious activity when automatically executed by the spreadsheet software. Note that current versions of Excel warn users of untrusted content."}],"DetectionMethods":[{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)","Effectiveness":"High"}],"PotentialMitigations":[{"Phase":["Implementation"],"Description":"When generating CSV output, ensure that formula-sensitive metacharacters are effectively escaped or removed from all data before storage in the resultant CSV. Risky characters include '=' (equal), '+' (plus), '-' (minus), and '@' (at).","Effectiveness":"Moderate","EffectivenessNotes":"Unfortunately, there is no perfect solution, since different spreadsheet products act differently."},{"Phase":["Implementation"],"Description":"If a field starts with a formula character, prepend it with a ' (single apostrophe), which prevents Excel from executing the formula.","Effectiveness":"Moderate","EffectivenessNotes":"It is not clear how effective this mitigation is with other spreadsheet software."},{"Phase":["Architecture and Design"],"Description":"Certain implementations of spreadsheet software might disallow formulas from executing if the file is untrusted, or if the file is not authored by the current user.","Effectiveness":"Limited","EffectivenessNotes":"This mitigation has limited effectiveness because it often depends on end users opening spreadsheet software safely."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"Hyperlinks or other commands can be executed when a cell begins with the formula identifier, '='"},{"Nature":"Attack","Language":"Other","ExampleCode":"=HYPERLINK(link_location, [friendly_name])"},{"BodyText":"Stripping the leading equals sign, or simply not executing formulas from untrusted sources, impedes malicious activity."},{"Nature":"Good","Language":"Other","ExampleCode":"HYPERLINK(link_location, [friendly_name])"}]}],"ObservedExamples":[{"Reference":"CVE-2019-12134","Description":"Low privileged user can trigger CSV injection through a contact form field value","Link":"https://www.cve.org/CVERecord?id=CVE-2019-12134"},{"Reference":"CVE-2019-4521","Description":"Cloud management product allows arbitrary command execution via CSV injection","Link":"https://www.cve.org/CVERecord?id=CVE-2019-4521"},{"Reference":"CVE-2019-17661","Description":"CSV injection in content management system via formula code in a first or last name","Link":"https://www.cve.org/CVERecord?id=CVE-2019-17661"}],"References":[{"ExternalReferenceID":"REF-21","Authors":["OWASP"],"Title":"CSV Injection","PublicationYear":"2020","PublicationMonth":"02","PublicationDay":"02","URL":"https://owasp.org/www-community/attacks/CSV_Injection"},{"ExternalReferenceID":"REF-22","Authors":["Jamie Rougvie"],"Title":"Data Extraction to Command Execution CSV Injection","PublicationYear":"2019","PublicationMonth":"09","PublicationDay":"06","URL":"https://www.veracode.com/blog/secure-development/data-extraction-command-execution-csv-injection"},{"ExternalReferenceID":"REF-23","Authors":["George Mauer"],"Title":"The Absurdly Underestimated Dangers of CSV Injection","PublicationYear":"2017","PublicationMonth":"10","PublicationDay":"07","URL":"https://georgemauer.net/2017/10/07/csv-injection.html","URLDate":"2025-07-25"},{"ExternalReferenceID":"REF-24","Authors":["James Kettle"],"Title":"Comma Separated Vulnerabilities","PublicationYear":"2014","PublicationMonth":"08","PublicationDay":"29","URL":"https://rstforums.com/forum/topic/82690-comma-separated-vulnerabilities/","URLDate":"2023-04-07"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2019-11-21","SubmissionVersion":"4.0","SubmissionReleaseDate":"2020-02-24"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-08-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Description, Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-04-03","ModificationComment":"updated Demonstrative_Examples","ModificationVersion":"4.17","ModificationReleaseDate":"2025-04-03"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-09-09","ModificationComment":"updated References","ModificationVersion":"4.18","ModificationReleaseDate":"2025-09-09"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-12-11","ModificationComment":"updated Background_Details, Common_Consequences, Description, Detection_Factors, Weakness_Ordinalities","ModificationVersion":"4.19","ModificationReleaseDate":"2025-12-11"}]}