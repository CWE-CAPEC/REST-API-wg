{"ID":"923","Name":"Improper Restriction of Communication Channel to Intended Endpoints","Abstraction":"Class","Structure":"Simple","Status":"Incomplete","Description":"The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint.","ExtendedDescription":"\n\nAttackers might be able to spoof the intended endpoint from a different system or process, thus gaining the same level of access as the intended endpoint.\n\n\nWhile this issue frequently involves authentication between network-based clients and servers, other types of communication channels and endpoints can have this weakness.\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"284","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design","Note":"REALIZATION: This weakness is caused during implementation of an architectural security tactic."}],"CommonConsequences":[{"Scope":["Integrity","Confidentiality"],"Impact":["Gain Privileges or Assume Identity"],"Note":"If an attacker can spoof the endpoint, the attacker gains all the privileges that were intended for the original endpoint."}],"DetectionMethods":[{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)","Effectiveness":"High"}],"DemonstrativeExamples":[{"ID":"DX-208","Entries":[{"IntroText":"These cross-domain policy files mean to allow Flash and Silverlight applications hosted on other domains to access its data:"},{"BodyText":"Flash crossdomain.xml :"},{"Nature":"Bad","Language":"XML","ExampleCode":"```\n\t\u003ccross-domain-policy xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\txsi:noNamespaceSchemaLocation=\"http://www.adobe.com/xml/schemas/PolicyFile.xsd\"\u003e\n\t\u003callow-access-from domain=\"*.example.com\"/\u003e\n\t\u003callow-access-from domain=\"*\"/\u003e\n\t\u003c/cross-domain-policy\u003e\n```"},{"BodyText":"Silverlight clientaccesspolicy.xml :"},{"Nature":"Bad","Language":"XML","ExampleCode":"```\n\t\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\n\t\u003caccess-policy\u003e\n\t\u003ccross-domain-access\u003e\n\t\u003cpolicy\u003e\n\t\u003callow-from http-request-headers=\"SOAPAction\"\u003e\n\t\u003cdomain uri=\"*\"/\u003e\n\t\u003c/allow-from\u003e\n\t\u003cgrant-to\u003e\n\t\u003cresource path=\"/\" include-subpaths=\"true\"/\u003e\n\t\u003c/grant-to\u003e\n\t\u003c/policy\u003e\n\t\u003c/cross-domain-access\u003e\n\t\u003c/access-policy\u003e\n```"},{"BodyText":"These entries are far too permissive, allowing any Flash or Silverlight application to send requests. A malicious application hosted on any other web site will be able to send requests on behalf of any user tricked into executing it."}]},{"ID":"DX-112","Entries":[{"IntroText":"This Android application will remove a user account when it receives an intent to do so:"},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tIntentFilter filter = new IntentFilter(\"com.example.RemoveUser\");\n\tMyReceiver receiver = new MyReceiver();\n\tregisterReceiver(receiver, filter);\n\tpublic class DeleteReceiver extends BroadcastReceiver {\n\t\t@Override\n\t\tpublic void onReceive(Context context, Intent intent) {\n\t\t\tint userID = intent.getIntExtra(\"userID\");\n\t\t\tdestroyUserData(userID);\n\t\t}\n\t}\n```"},{"BodyText":"This application does not check the origin of the intent, thus allowing any malicious application to remove a user. Always check the origin of an intent, or create an allowlist of trusted applications using the manifest.xml file."}]}],"ObservedExamples":[{"Reference":"CVE-2022-30319","Description":"S-bus functionality in a home automation product performs access control using an IP allowlist, which can be bypassed by a forged IP address.","Link":"https://www.cve.org/CVERecord?id=CVE-2022-30319"},{"Reference":"CVE-2022-22547","Description":"A troubleshooting tool exposes a web server on a random port between 9000-65535 that could be used for information gathering","Link":"https://www.cve.org/CVERecord?id=CVE-2022-22547"},{"Reference":"CVE-2022-4390","Description":"A WAN interface on a router has firewall restrictions enabled for IPv4, but it does not for IPv6, which is enabled by default","Link":"https://www.cve.org/CVERecord?id=CVE-2022-4390"},{"Reference":"CVE-2012-2292","Description":"Product has a Silverlight cross-domain policy that does not restrict access to another application, which allows remote attackers to bypass the Same Origin Policy.","Link":"https://www.cve.org/CVERecord?id=CVE-2012-2292"},{"Reference":"CVE-2012-5810","Description":"Mobile banking application does not verify hostname, leading to financial loss.","Link":"https://www.cve.org/CVERecord?id=CVE-2012-5810"},{"Reference":"CVE-2014-1266","Description":"chain: incorrect \"goto\" in Apple SSL product bypasses certificate validation, allowing Adversry-in-the-Middle (AITM) attack (Apple \"goto fail\" bug). CWE-705 (Incorrect Control Flow Scoping) -\u003e CWE-561 (Dead Code) -\u003e CWE-295 (Improper Certificate Validation) -\u003e CWE-393 (Return of Wrong Status Code) -\u003e CWE-300 (Channel Accessible by Non-Endpoint).","Link":"https://www.cve.org/CVERecord?id=CVE-2014-1266"},{"Reference":"CVE-2000-1218","Description":"DNS server can accept DNS updates from hosts that it did not query, leading to cache poisoning","Link":"https://www.cve.org/CVERecord?id=CVE-2000-1218"}],"RelatedAttackPatterns":["161","481","501","697"],"MappingNotes":{"Usage":"Allowed-with-Review","Rationale":"This CWE entry is a Class and might have Base-level children that would be more appropriate","Comments":"Examine children of this entry to see if there is a better fit","Reasons":["Abstraction"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2013-06-23","SubmissionVersion":"2.5","SubmissionReleaseDate":"2013-07-17"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-02-18","ModificationComment":"updated Description, Name, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Modes_of_Introduction, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Maintenance_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Related_Attack_Patterns, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description, Related_Attack_Patterns, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Detection_Factors, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-10-26","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2024-02-29","ModificationComment":"updated Demonstrative_Examples","ModificationVersion":"4.14","ModificationReleaseDate":"2024-02-29"},{"Type":"Rename","PreviousEntryName":"Improper Authentication of Endpoint in a Communication Channel","Date":"2014-02-18"}]}