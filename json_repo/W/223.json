{"ID":"223","Name":"Omission of Security-relevant Information","Abstraction":"Base","Structure":"Simple","Status":"Draft","Description":"The product does not record or display information that would be important for identifying the source or nature of an attack, or determining if an action is safe.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"221","ViewID":"1000","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"},{"Ordinality":"Resultant"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design","Note":"OMISSION: This weakness is caused by missing a security tactic during the architecture and design phase."},{"Phase":"Implementation"},{"Phase":"Operation"}],"CommonConsequences":[{"Scope":["Non-Repudiation"],"Impact":["Hide Activities"],"Note":"The source of an attack will be difficult or impossible to determine. This can allow attacks to the system to continue without notice."}],"DemonstrativeExamples":[{"ID":"DX-174","Entries":[{"IntroText":"This code logs suspicious multiple login attempts."},{"Nature":"Bad","Language":"PHP","ExampleCode":"```\n\tfunction login($userName,$password){\n\t\t\tif(authenticate($userName,$password)){\n\t\t\t\treturn True;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tincrementLoginAttempts($userName);\n\t\t\t\tif(recentLoginAttempts($userName) \u003e 5){\n\t\t\t\t\twriteLog(\"Failed login attempt by User: \" . $userName . \" at \" + date('r') );\n\t\t\t\t}\n\t\t\t}\n\t}\n```"},{"BodyText":"This code only logs failed login attempts when a certain limit is reached. If an attacker knows this limit, they can stop their attack from being discovered by avoiding the limit."}]},{"ID":"DX-175","Entries":[{"IntroText":"This code prints the contents of a file if a user has permission."},{"Nature":"Bad","Language":"PHP","ExampleCode":"```\n\tfunction readFile($filename){\n\t\t\t$user = getCurrentUser();\n\t\t\t$realFile = $filename;\n```\n//resolve file if its a symbolic link* \n\t\t\tif(is_link($filename)){\n\t\t\t```\n\t\t\t\t$realFile = readlink($filename);\n\t\t\t}\n\t\t\tif(fileowner($realFile) == $user){\n\t\t\t\techo file_get_contents($realFile);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse{\n\t\t\t\techo 'Access denied';\n\t\t\t\twriteLog($user . ' attempted to access the file '. $filename . ' on '. date('r'));\n\t\t\t}\n\t}\n```"},{"BodyText":"While the code logs a bad access attempt, it logs the user supplied name for the file, not the canonicalized file name. An attacker can obscure their target by giving the script the name of a link to the file they are attempting to access. Also note this code contains a race condition between the is_link() and readlink() functions (CWE-363)."}]}],"ObservedExamples":[{"Reference":"CVE-1999-1029","Description":"Login attempts are not recorded if the user disconnects before the maximum number of tries.","Link":"https://www.cve.org/CVERecord?id=CVE-1999-1029"},{"Reference":"CVE-2002-1839","Description":"Sender's IP address not recorded in outgoing e-mail.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1839"},{"Reference":"CVE-2000-0542","Description":"Failed authentication attempts are not recorded if later attempt succeeds.","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0542"}],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Omission of Security-relevant Information"}],"References":[{"ExternalReferenceID":"REF-62","Section":"Chapter 2, \"Accountability\", Page 40","Authors":["Mark Dowd","John McDonald","Justin Schuh"],"Title":"The Art of Software Security Assessment","Edition":"1st Edition","PublicationYear":"2006","Publisher":"Addison Wesley"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-07-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Common_Consequences, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Demonstrative_Examples, Modes_of_Introduction, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2018-03-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-10-26","ModificationComment":"updated Demonstrative_Examples, Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-04-03","ModificationComment":"updated Relationships","ModificationVersion":"4.17","ModificationReleaseDate":"2025-04-03"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-12-11","ModificationComment":"updated Relationships, Weakness_Ordinalities","ModificationVersion":"4.19","ModificationReleaseDate":"2025-12-11"}]}