{"ID":"926","Name":"Improper Export of Android Application Components","Abstraction":"Variant","Structure":"Simple","Status":"Incomplete","Description":"The Android application exports a component for use by other applications, but does not properly restrict which applications can launch the component or access the data it contains.","ExtendedDescription":"\n\nThe attacks and consequences of improperly exporting a component may depend on the exported component:\n\n\n  - If access to an exported Activity is not restricted, any application will be able to launch the activity. This may allow a malicious application to gain access to sensitive information, modify the internal state of the application, or trick a user into interacting with the victim application while believing they are still interacting with the malicious application.\n\n  - If access to an exported Service is not restricted, any application may start and bind to the Service. Depending on the exposed functionality, this may allow a malicious application to perform unauthorized actions, gain access to sensitive information, or corrupt the internal state of the application.\n\n  - If access to a Content Provider is not restricted to only the expected applications, then malicious applications might be able to access the sensitive data. Note that in Android before 4.2, the Content Provider is automatically exported unless it has been explicitly declared as NOT exported.\n\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"285","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Class":"Mobile","Prevalence":"Undetermined"}],"BackgroundDetails":["\n\nThere are three types of components that can be exported in an Android application.\n\n\n  - An Activity is an application component that provides a UI for users to interact with. A typical application will have multiple Activity screens that perform different functions, such as a main Activity screen and a separate settings Activity screen.\n\n  - A Service is an application component that is started by another component to execute an operation in the background, even after the invoking component is terminated. Services do not have a UI component visible to the user.\n\n  - The Content Provider mechanism can be used to share data with other applications or internally within the same application.\n\n"],"ModesOfIntroduction":[{"Phase":"Architecture and Design"}],"CommonConsequences":[{"Scope":["Availability","Integrity"],"Impact":["Unexpected State","DoS: Crash, Exit, or Restart","DoS: Instability","Varies by Context"],"Note":"Other applications, possibly untrusted, can launch the Activity."},{"Scope":["Availability","Integrity"],"Impact":["Unexpected State","Gain Privileges or Assume Identity","DoS: Crash, Exit, or Restart","DoS: Instability","Varies by Context"],"Note":"Other applications, possibly untrusted, can bind to the Service."},{"Scope":["Confidentiality","Integrity"],"Impact":["Read Application Data","Modify Application Data"],"Note":"Other applications, possibly untrusted, can read or modify the data that is offered by the Content Provider."}],"DetectionMethods":[{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)","Effectiveness":"High"}],"PotentialMitigations":[{"Phase":["Build and Compilation"],"Strategy":"Attack Surface Reduction","Description":"If they do not need to be shared by other applications, explicitly mark components with android:exported=\"false\" in the application manifest."},{"Phase":["Build and Compilation"],"Strategy":"Attack Surface Reduction","Description":"If you only intend to use exported components between related apps under your control, use android:protectionLevel=\"signature\" in the xml manifest to restrict access to applications signed by you."},{"Phase":["Build and Compilation","Architecture and Design"],"Strategy":"Attack Surface Reduction","Description":"Limit Content Provider permissions (read/write) as appropriate."},{"Phase":["Build and Compilation","Architecture and Design"],"Strategy":"Separation of Privilege","Description":"Limit Content Provider permissions (read/write) as appropriate."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"This application is exporting an activity and a service in its manifest.xml:"},{"Nature":"Bad","Language":"XML","ExampleCode":"```\n\t\u003cactivity android:name=\"com.example.vulnerableApp.mainScreen\"\u003e\n```\n...* \n\t\t\t\u003cintent-filter\u003e\n\t\t\t```\n\t\t\t\t\u003caction android:name=\"com.example.vulnerableApp.OPEN_UI\" /\u003e\n\t\t\t\t\u003ccategory android:name=\"android.intent.category.DEFAULT\" /\u003e\n\t\t\t\u003c/intent-filter\u003e\n```\n...* \n\t\t\t\u003c/activity\u003e\n\t\u003cservice android:name=\"com.example.vulnerableApp.backgroundService\"\u003e\n\t```\n```\n...* \n\t\t\t\u003cintent-filter\u003e\n\t\t\t```\n\t\t\t\t\u003caction android:name=\"com.example.vulnerableApp.START_BACKGROUND\" /\u003e\n\t\t\t\u003c/intent-filter\u003e\n```\n...* \n\t\t\t\u003c/service\u003e"},{"BodyText":"Because these components have intent filters but have not explicitly set 'android:exported=false' elsewhere in the manifest, they are automatically exported so that any other application can launch them. This may lead to unintended behavior or exploits."}]},{"Entries":[{"IntroText":"This application has created a content provider to enable custom search suggestions within the application:"},{"Nature":"Bad","Language":"XML","ExampleCode":"```\n\t\u003cprovider\u003e\n\t\tandroid:name=\"com.example.vulnerableApp.searchDB\"\n\t\tandroid:authorities=\"com.example.vulnerableApp.searchDB\"\u003e\n\t\u003c/provider\u003e\n```"},{"BodyText":"Because this content provider is only intended to be used within the application, it does not need to be exported. However, in Android before 4.2, it is automatically exported thus potentially allowing malicious applications to access sensitive information."}]}],"References":[{"ExternalReferenceID":"REF-923","Authors":["Android Open Source Project"],"Title":"Security Tips","PublicationYear":"2013","PublicationMonth":"07","PublicationDay":"16","URL":"https://developer.android.com/training/articles/security-tips#ContentProviders","URLDate":"2023-04-07"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2013-07-02","SubmissionVersion":"2.5","SubmissionReleaseDate":"2013-07-17"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-01-22","ModificationComment":"Expanded entry to be more general and include all types of Android components that may be improperly exported."},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-02-18","ModificationComment":"updated Background_Details, Common_Consequences, Demonstrative_Examples, Description, Maintenance_Notes, Name, Potential_Mitigations, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Applicable_Platforms, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Background_Details"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Detection_Factors, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Rename","PreviousEntryName":"Improper Restriction of Content Provider Export to Other Applications","Date":"2014-02-18"}]}