{"ID":"1319","Name":"Improper Protection against Electromagnetic Fault Injection (EM-FI)","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The device is susceptible to electromagnetic fault injection attacks, causing device internal information to be compromised or security mechanisms to be bypassed.","ExtendedDescription":"\n\nElectromagnetic fault injection may allow an attacker to locally and dynamically modify the signals (both internal and external) of an integrated circuit. EM-FI attacks consist of producing a local, transient magnetic field near the device, inducing current in the device wires. A typical EMFI setup is made up of a pulse injection circuit that generates a high current transient in an EMI coil, producing an abrupt magnetic pulse which couples to the target producing faults in the device, which can lead to:\n\n\n  - Bypassing security mechanisms such as secure JTAG or Secure Boot\n\n  - Leaking device information\n\n  - Modifying program flow\n\n  - Perturbing secure hardware modules (e.g. random number generators)\n\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"693","ViewID":"1000","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Operating_System","Class":"Not OS-Specific","Prevalence":"Undetermined"},{"Type":"Architecture","Class":"Not Architecture-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Class":"System on Chip","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Microcontroller Hardware","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Memory Hardware","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Power Management Hardware","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Processor Hardware","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Test/Debug Hardware","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Sensor Hardware","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design"},{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Confidentiality","Integrity","Access Control","Availability"],"Impact":["Modify Memory","Read Memory","Gain Privileges or Assume Identity","Bypass Protection Mechanism","Execute Unauthorized Code or Commands"]}],"PotentialMitigations":[{"Phase":["Architecture and Design","Implementation"],"Description":"\n\n  - 1. Redundancy - By replicating critical operations and comparing the two outputs can help indicate whether a fault has been injected.\n\n  - 2. Error detection and correction codes - Gay, Mael, et al. proposed a new scheme that not only detects faults injected by a malicious adversary but also automatically corrects single nibble/byte errors introduced by low-multiplicity faults.\n\n  - 3. Fail by default coding - When checking conditions (switch or if) check all possible cases and fail by default because the default case in a switch (or the else part of a cascaded if-else-if construct) is used for dealing with the last possible (and valid) value without checking. This is prone to fault injection because this alternative is easily selected as a result of potential data manipulation [REF-1141].\n\n  - 4. Random Behavior - adding random delays before critical operations, so that timing is not predictable.\n\n  - 5. Program Flow Integrity Protection - The program flow can be secured by integrating run-time checking aiming at detecting control flow inconsistencies. One such example is tagging the source code to indicate the points not to be bypassed [REF-1147].\n\n  - 6. Sensors - Usage of sensors can detect variations in voltage and current.\n\n  - 7. Shields - physical barriers to protect the chips from malicious manipulation.\n\n"}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"In many devices, security related information is stored in fuses. These fuses are loaded into shadow registers at boot time. Disturbing this transfer phase with EM-FI can lead to the shadow registers storing erroneous values potentially resulting in reduced security."},{"BodyText":"Colin O'Flynn has demonstrated an attack scenario [REF-1144] that uses electro-magnetic glitching during booting to bypass security and gain read access to flash, read and erase access to shadow memory area (where the private password is stored). Most devices in the MPC55xx and MPC56xx series that include the Boot Assist Module (BAM) (a serial or CAN bootloader mode) are susceptible to this attack. In this paper, a GM ECU was used as a real life target. While the success rate appears low (less than 2 percent), in practice a success can be found within 1-5 minutes once the EMFI tool is setup. In a practical scenario, the author showed that success can be achieved within 30-60 minutes from a cold start."}]}],"ObservedExamples":[{"Reference":"CVE-2020-27211","Description":"Chain: microcontroller system-on-chip uses a register value stored in flash to set product protection state on the memory bus and does not contain protection against fault injection (CWE-1319) which leads to an incorrect initialization of the memory bus (CWE-1419) leading the product to be in an unprotected state.","Link":"https://www.cve.org/CVERecord?id=CVE-2020-27211"}],"RelatedAttackPatterns":["624","625"],"References":[{"ExternalReferenceID":"REF-1141","Authors":["Marc Witteman"],"Title":"Secure Application Programming in the presence of Side Channel Attacks","PublicationYear":"2017","URL":"https://riscureprodstorage.blob.core.windows.net/production/2017/08/Riscure_Whitepaper_Side_Channel_Patterns.pdf","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1142","Authors":["A. Dehbaoui, J. M. Dutertre, B. Robisson, P. Orsatelli, P. Maurine, A. Tria"],"Title":"Injection of transient faults using electromagnetic pulses. Practical results on a cryptographic system","PublicationYear":"2012","URL":"https://eprint.iacr.org/2012/123.pdf"},{"ExternalReferenceID":"REF-1143","Authors":["A. Menu, S. Bhasin, J. M. Dutertre, J. B. Rigaud, J. Danger"],"Title":"Precise Spatio-Temporal Electromagnetic Fault Injections on Data Transfers","PublicationYear":"2019","URL":"https://hal.telecom-paris.fr/hal-02338456/document"},{"ExternalReferenceID":"REF-1144","Authors":["Colin O'Flynn"],"Title":"BAM BAM!! On Reliability of EMFI for in-situ Automotive ECU Attacks","URL":"https://eprint.iacr.org/2020/937.pdf"},{"ExternalReferenceID":"REF-1145","Authors":["J. Balasch, D. Arum√≠, S. Manich"],"Title":"Design and Validation of a Platform for Electromagnetic Fault Injection","URL":"https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=\u0026arnumber=8311630"},{"ExternalReferenceID":"REF-1146","Authors":["M. Gay, B. Karp, O. Keren, I. Polian"],"Title":"Error control scheme for malicious and natural faults in cryptographic modules","PublicationYear":"2019","URL":"https://link.springer.com/content/pdf/10.1007/s13389-020-00234-7.pdf","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1147","Authors":["M. L. Akkar, L. Goubin, O. Ly"],"Title":"Automatic Integration of Counter-Measures Against Fault Injection Attacks","URL":"https://www.labri.fr/perso/ly/publications/cfed.pdf"},{"ExternalReferenceID":"REF-1285","Authors":["Texas Instruments"],"Title":"Physical Security Attacks Against Silicon Devices","PublicationYear":"2022","PublicationMonth":"01","PublicationDay":"31","URL":"https://www.ti.com/lit/an/swra739/swra739.pdf?ts=1644234570420"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Maintenance","Note":"This entry is attack-oriented and may require significant modification in future versions, or even deprecation. It is not clear whether there is really a design \"mistake\" that enables such attacks, so this is not necessarily a weakness and may be more appropriate for CAPEC."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"Sebastien Leger, Rohini Narasipur","SubmissionOrganization":"Bosch","SubmissionDate":"2020-08-27","SubmissionVersion":"4.3","SubmissionReleaseDate":"2020-12-10"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-04-28","ModificationComment":"updated Applicable_Platforms"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-06-28","ModificationComment":"updated Applicable_Platforms, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Potential_Mitigations, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-10-26","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-12-11","ModificationComment":"updated Demonstrative_Examples, Observed_Examples, Weakness_Ordinalities","ModificationVersion":"4.19","ModificationReleaseDate":"2025-12-11"}]}