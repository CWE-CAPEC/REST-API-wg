{"ID":"1247","Name":"Improper Protection Against Voltage and Clock Glitches","Abstraction":"Base","Structure":"Simple","Status":"Stable","Description":"The device does not contain or contains incorrectly implemented circuitry or sensors to detect and mitigate voltage and clock glitches and protect sensitive information or software contained on the device.","ExtendedDescription":"\n\nA device might support features such as secure boot which are supplemented with hardware and firmware support. This involves establishing a chain of trust, starting with an immutable root of trust by checking the signature of the next stage (culminating with the OS and runtime software) against a golden value before transferring control. The intermediate stages typically set up the system in a secure state by configuring several access control settings. Similarly, security logic for exercising a debug or testing interface may be implemented in hardware, firmware, or both. A device needs to guard against fault attacks such as voltage glitches and clock glitches that an attacker may employ in an attempt to compromise the system.\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"1384","ViewID":"1000","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Operating_System","Class":"Not OS-Specific","Prevalence":"Undetermined"},{"Type":"Architecture","Class":"Not Architecture-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Class":"ICS/OT","Prevalence":"Undetermined"},{"Type":"Technology","Class":"System on Chip","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Power Management Hardware","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Clock/Counter Hardware","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Sensor Hardware","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Operation"}],"CommonConsequences":[{"Scope":["Confidentiality","Integrity","Availability","Access Control"],"Impact":["Gain Privileges or Assume Identity","Bypass Protection Mechanism","Read Memory","Modify Memory","Execute Unauthorized Code or Commands"]}],"DetectionMethods":[{"Method":"Manual Analysis","Description":"\n\nPut the processor in an infinite loop, which is then followed by instructions that should not ever be executed, since the loop is not expected to exit. After the loop, toggle an I/O bit (for oscilloscope monitoring purposes), print a console message, and reenter the loop. Note that to ensure that the loop exit is actually captured, many NOP instructions should be coded after the loop branch instruction and before the I/O bit toggle and the print statement.\n\n\nMargining the clock consists of varying the clock frequency until an anomaly occurs. This could be a continuous frequency change or it could be a single cycle. The single cycle method is described here. For every 1000th clock pulse, the clock cycle is shortened by 10 percent. If no effect is observed, the width is shortened by 20%. This process is continued in 10% increments up to and including 50%. Note that the cycle time may be increased as well, down to seconds per cycle.\n\n\nSeparately, the voltage is margined. Note that the voltage could be increased or decreased. Increasing the voltage has limits, as the circuitry may not be able to withstand a drastically increased voltage. This process starts with a 5% reduction of the DC supply to the CPU chip for 5 millisecond repeated at 1KHz. If this has no effect, the process is repeated, but a 10% reduction is used. This process is repeated at 10% increments down to a 50% reduction. If no effects are observed at 5 millisecond, the whole process is repeated using a 10 millisecond pulse. If no effects are observed, the process is repeated in 10 millisecond increments out to 100 millisecond pulses.\n\n\nWhile these are suggested starting points for testing circuitry for weaknesses, the limits may need to be pushed further at the risk of device damage. See [REF-1217] for descriptions of Smart Card attacks against a clock (section 14.6.2) and using a voltage glitch (section 15.5.3).\n","Effectiveness":"Moderate"},{"Method":"Dynamic Analysis with Manual Results Interpretation","Description":"During the implementation phase where actual hardware is available, specialized hardware tools and apparatus such as ChipWhisperer may be used to check if the platform is indeed susceptible to voltage and clock glitching attacks."},{"Method":"Architecture or Design Review","Description":"Review if the protections against glitching merely transfer the attack target. For example, suppose a critical authentication routine that an attacker would want to bypass is given the protection of modifying certain artifacts from within that specific routine (so that if the routine is bypassed, one can examine the artifacts and figure out that an attack must have happened). However, if the attacker has the ability to bypass the critical authentication routine, they might also have the ability to bypass the other protection routine that checks the artifacts. Basically, depending on these kind of protections is akin to resorting to \"Security by Obscurity\"."},{"Method":"Architecture or Design Review","Description":"Many SoCs come equipped with a built-in Dynamic Voltage and Frequency Scaling (DVFS) that can control the voltage and clocks via software alone. However, there have been demonstrated attacks (like Plundervolt and CLKSCREW) that target this DVFS [REF-1081] [REF-1082]. During the design and implementation phases, one needs to check if the interface to this power management feature is available from unprivileged SW (CWE-1256), which would make the attack very easy."}],"PotentialMitigations":[{"Phase":["Architecture and Design","Implementation"],"Description":"\n\nAt the circuit-level, using Tunable Replica Circuits (TRCs) or special flip-flops such as Razor flip-flops helps mitigate glitch attacks. Working at the SoC or platform base, level sensors may be implemented to detect glitches. Implementing redundancy in security-sensitive code (e.g., where checks are performed)also can help with mitigation of glitch attacks.\n"}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"Below is a representative snippet of C code that is part of the secure-boot flow. A signature of the runtime-firmware image is calculated and compared against a golden value. If the signatures match, the bootloader loads runtime firmware. If there is no match, an error halt occurs. If the underlying hardware executing this code does not contain any circuitry or sensors to detect voltage or clock glitches, an attacker might launch a fault-injection attack right when the signature check is happening (at the location marked with the comment), causing a bypass of the signature-checking process."},{"Nature":"Bad","Language":"C","ExampleCode":"...\n if (signature_matches) // \u003c-Glitch Here\n {\n\n```\n\t load_runtime_firmware();\n }\n else\n {\n\t do_not_load_runtime_firmware();\n }\n ...\n```"},{"BodyText":"After bypassing secure boot, an attacker can gain access to system assets to which the attacker should not have access."},{"Nature":"Good","ExampleCode":"```\n\tIf the underlying hardware detects a voltage or clock glitch, the information can be used to prevent the glitch from being successful.\n```"}]}],"ObservedExamples":[{"Reference":"CVE-2019-17391","Description":"Lack of anti-glitch protections allows an attacker to launch a physical attack to bypass the secure boot and read protected eFuses.","Link":"https://www.cve.org/CVERecord?id=CVE-2019-17391"},{"Reference":"CVE-2021-33478","Description":"IP communication firmware allows access to a boot shell via certain impulses","Link":"https://www.cve.org/CVERecord?id=CVE-2021-33478"}],"FunctionalAreas":["Power","Clock"],"RelatedAttackPatterns":["624","625"],"References":[{"ExternalReferenceID":"REF-1061","Authors":["Keith Bowman","James Tschanz","Chris Wilkerson","Shih-Lien Lu","Tanay Karnik","Vivek De","Shekhar Borkar"],"Title":"Circuit Techniques for Dynamic Variation Tolerance","URL":"https://dl.acm.org/doi/10.1145/1629911.1629915","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1062","Authors":["Dan Ernst","Nam Sung Kim","Shidhartha Das","Sanjay Pant","Rajeev Rao","Toan Pham","Conrad Ziesler","David Blaauw","Todd Austin","Krisztian Flautner","Trevor Mudge"],"Title":"Razor: A Low-Power Pipeline Based on Circuit-Level Timing Speculation","URL":"https://web.eecs.umich.edu/~taustin/papers/MICRO36-Razor.pdf"},{"ExternalReferenceID":"REF-1063","Authors":["James Tschanz","Keith Bowman","Steve Walstra","Marty Agostinelli","Tanay Karnik","Vivek De"],"Title":"Tunable Replica Circuits and Adaptive Voltage-Frequency Techniques for Dynamic Voltage, Temperature, and Aging Variation Tolerance","URL":"https://ieeexplore.ieee.org/document/5205410"},{"ExternalReferenceID":"REF-1064","Authors":["Bilgiday Yuce","Nahid F. Ghalaty","Chinmay Deshpande","Conor Patrick","Leyla Nazhandali","Patrick Schaumont"],"Title":"FAME: Fault-attack Aware Microprocessor Extensions for Hardware Fault Detection and Software Fault Response","URL":"https://dl.acm.org/doi/10.1145/2948618.2948626","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1065","Authors":["Keith A. Bowman","James W. Tschanz","Shih-Lien L. Lu","Paolo A. Aseron","Muhammad M. Khellah","Arijit Raychowdhury","Bibiche M. Geuskens","Carlos Tokunaga","Chris B. Wilkerson","Tanay Karnik","Vivek De"],"Title":"A 45 nm Resilient Microprocessor Core for Dynamic Variation Tolerance","URL":"https://ieeexplore.ieee.org/document/5654663"},{"ExternalReferenceID":"REF-1066","Authors":["Niek Timmers","Albert Spruyt"],"Title":"Bypassing Secure Boot Using Fault Injection","URL":"https://www.blackhat.com/docs/eu-16/materials/eu-16-Timmers-Bypassing-Secure-Boot-Using-Fault-Injection.pdf"},{"ExternalReferenceID":"REF-1217","Section":"14.6.2 Security Evolution, page 291","Authors":["Ross Anderson"],"Title":"Security Engineering","PublicationYear":"2001","URL":"https://www.cl.cam.ac.uk/~rja14/musicfiles/manuscripts/SEv1.pdf"},{"ExternalReferenceID":"REF-1217","Section":"15.5.3 Glitching, page 317","Authors":["Ross Anderson"],"Title":"Security Engineering","PublicationYear":"2001","URL":"https://www.cl.cam.ac.uk/~rja14/musicfiles/manuscripts/SEv1.pdf"},{"ExternalReferenceID":"REF-1081","Authors":["Kit Murdock","David Oswald","Flavio D Garcia","Jo Van Bulck","Frank Piessens","Daniel Gruss"],"Title":"Plundervolt","URL":"https://plundervolt.com/"},{"ExternalReferenceID":"REF-1082","Authors":["Adrian Tang","Simha Sethumadhavan","Salvatore Stolfo"],"Title":"CLKSCREW: Exposing the Perils of Security-Oblivious Energy Management","URL":"https://www.usenix.org/system/files/conference/usenixsecurity17/sec17-tang.pdf"},{"ExternalReferenceID":"REF-1285","Authors":["Texas Instruments"],"Title":"Physical Security Attacks Against Silicon Devices","PublicationYear":"2022","PublicationMonth":"01","PublicationDay":"31","URL":"https://www.ti.com/lit/an/swra739/swra739.pdf?ts=1644234570420"},{"ExternalReferenceID":"REF-1286","Section":"1.2 / 4","Authors":["Lennert Wouters","Benedikt Gierlichs","Bart Preneel"],"Title":"On The Susceptibility of Texas Instruments SimpleLink Platform Microcontrollers to Non-Invasive Physical Attacks","PublicationYear":"2022","PublicationMonth":"03","PublicationDay":"14","URL":"https://eprint.iacr.org/2022/328.pdf"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"Arun Kanuparthi, Hareesh Khattri, Parbati Kumar Manna, Narasimha Kumar V Mangipudi","SubmissionOrganization":"Intel Corporation","SubmissionDate":"2020-02-12","SubmissionVersion":"4.0","SubmissionReleaseDate":"2020-02-24"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-08-20","ModificationComment":"updated Demonstrative_Examples, Description, Name, Observed_Examples, Potential_Mitigations, Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-12-10","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Functional_Areas"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Description, Detection_Factors, Name, References, Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-04-28","ModificationComment":"updated Applicable_Platforms, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-06-28","ModificationComment":"updated Applicable_Platforms, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Demonstrative_Examples, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Applicable_Platforms, Related_Attack_Patterns, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-10-26","ModificationComment":"updated Observed_Examples"},{"Type":"Contribution","ContributionName":"Parbati K. Manna","ContributionOrganization":"Intel Corporation","ContributionDate":"2021-10-18","ContributionComment":"provided detection methods","ContributionType":"Content"},{"Type":"Rename","PreviousEntryName":"Missing Protection Against Voltage and Clock Glitches","Date":"2020-08-20"},{"Type":"Rename","PreviousEntryName":"Missing or Improperly Implemented Protection Against Voltage and Clock Glitches","Date":"2021-10-28"}]}