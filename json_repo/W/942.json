{"ID":"942","Name":"Permissive Cross-domain Security Policy with Untrusted Domains","Abstraction":"Variant","Structure":"Simple","Status":"Incomplete","Description":"The product uses a web-client protection\n         mechanism such as a Content Security Policy (CSP) or\n         cross-domain policy file, but the policy includes untrusted\n         domains with which the web client is allowed to\n         communicate.","ExtendedDescription":"\n\nIf a cross-domain policy file includes domains that should not be trusted, such as when using wildcards under a high-level domain, then the application could be attacked by these untrusted domains. In many cases, the attack can be launched without the victim even being aware of it.\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"863","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"923","ViewID":"1000"},{"Nature":"ChildOf","CweID":"183","ViewID":"1000"},{"Nature":"CanPrecede","CweID":"668","ViewID":"1000"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Class":"Web Based","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Web Server","Prevalence":"Undetermined"}],"BackgroundDetails":["\n\nIn HTTP/HTTPS, policies such as the Same Origin Policy prevent web clients from loading resources from (or making requests to) domains that did not match the web site's own domain, e.g., Javascript or other code hosted on third-party servers. These policies are strictly enforced by browsers and other products. However, these restrictions can be reduced using mechanisms that specify other domains that are allowed to be contacted from the original site, such as Content Security Policy (CSP) or cross-domain policy files (e.g., \"crossdomain.xml\" in Adobe Flash or Reader, \"clientaccesspolicy.xml\" in Silverlight, etc.). These mechanisms define a list of domains from which a client is allowed to make cross-domain requests. When making a cross-domain request, the client will first look for the policy file on the target server. If it is found, and the domain hosting the application is explicitly allowed to make requests, the request is made.\n"],"ModesOfIntroduction":[{"Phase":"Implementation"},{"Phase":"Architecture and Design","Note":"COMMISSION: This weakness refers to an incorrect design related to an architectural security tactic."}],"CommonConsequences":[{"Scope":["Confidentiality","Integrity","Availability","Access Control"],"Impact":["Execute Unauthorized Code or Commands","Bypass Protection Mechanism","Read Application Data","Varies by Context"],"Note":"With an overly permissive policy file, an attacker may be able to bypass the web browser's same-origin policy and conduct many of the same attacks seen in Cross-Site Scripting (CWE-79). An attacker can exploit the weakness to transfer private information from the victim's machine to the attacker, manipulate or steal cookies that may include session information, create malicious requests to a web site on behalf of the victim, or execute malicious code on the end user systems. Other damaging attacks include the disclosure of end user files, installation of Trojan horse programs, redirecting the user to some other page or site, running ActiveX controls (under Microsoft Internet Explorer) from sites that a user perceives as trustworthy, and modifying presentation of content."}],"DetectionMethods":[{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)","Effectiveness":"High"}],"PotentialMitigations":[{"Phase":["Architecture and Design","Operation"],"Strategy":"Attack Surface Reduction","Description":"Define a restrictive Content Security Policy [REF-1486] or cross-domain policy file."},{"Phase":["Architecture and Design","Operation"],"Strategy":"Attack Surface Reduction","Description":"Avoid using wildcards in the CSP / cross-domain policy file. Any domain matching the wildcard expression will be implicitly trusted, and can perform two-way interaction with the target server."},{"Phase":["Architecture and Design","Operation"],"Strategy":"Environment Hardening","Description":"For Flash, modify crossdomain.xml to use meta-policy options such as 'master-only' or 'none' to reduce the possibility of an attacker planting extraneous cross-domain policy files on a server."}],"DemonstrativeExamples":[{"ID":"DX-208","Entries":[{"IntroText":"These cross-domain policy files mean to allow Flash and Silverlight applications hosted on other domains to access its data:"},{"BodyText":"Flash crossdomain.xml :"},{"Nature":"Bad","Language":"XML","ExampleCode":"```\n\t\u003ccross-domain-policy xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\txsi:noNamespaceSchemaLocation=\"http://www.adobe.com/xml/schemas/PolicyFile.xsd\"\u003e\n\t\u003callow-access-from domain=\"*.example.com\"/\u003e\n\t\u003callow-access-from domain=\"*\"/\u003e\n\t\u003c/cross-domain-policy\u003e\n```"},{"BodyText":"Silverlight clientaccesspolicy.xml :"},{"Nature":"Bad","Language":"XML","ExampleCode":"```\n\t\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\n\t\u003caccess-policy\u003e\n\t\u003ccross-domain-access\u003e\n\t\u003cpolicy\u003e\n\t\u003callow-from http-request-headers=\"SOAPAction\"\u003e\n\t\u003cdomain uri=\"*\"/\u003e\n\t\u003c/allow-from\u003e\n\t\u003cgrant-to\u003e\n\t\u003cresource path=\"/\" include-subpaths=\"true\"/\u003e\n\t\u003c/grant-to\u003e\n\t\u003c/policy\u003e\n\t\u003c/cross-domain-access\u003e\n\t\u003c/access-policy\u003e\n```"},{"BodyText":"These entries are far too permissive, allowing any Flash or Silverlight application to send requests. A malicious application hosted on any other web site will be able to send requests on behalf of any user tricked into executing it."}]}],"ObservedExamples":[{"Reference":"CVE-2012-2292","Description":"Product has a Silverlight cross-domain policy that does not restrict access to another application, which allows remote attackers to bypass the Same Origin Policy.","Link":"https://www.cve.org/CVERecord?id=CVE-2012-2292"},{"Reference":"CVE-2014-2049","Description":"The default Flash Cross Domain policies in a product allows remote attackers to access user files.","Link":"https://www.cve.org/CVERecord?id=CVE-2014-2049"},{"Reference":"CVE-2007-6243","Description":"Chain: Adobe Flash Player does not sufficiently restrict the interpretation and usage of cross-domain policy files, which makes it easier for remote attackers to conduct cross-domain and cross-site scripting (XSS) attacks.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-6243"},{"Reference":"CVE-2008-4822","Description":"Chain: Adobe Flash Player and earlier does not properly interpret policy files, which allows remote attackers to bypass a non-root domain policy.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-4822"},{"Reference":"CVE-2010-3636","Description":"Chain: Adobe Flash Player does not properly handle unspecified encodings during the parsing of a cross-domain policy file, which allows remote web servers to bypass intended access restrictions via unknown vectors.","Link":"https://www.cve.org/CVERecord?id=CVE-2010-3636"}],"References":[{"ExternalReferenceID":"REF-1486","Authors":["OWASP"],"Title":"Content Security Policy Cheat Sheet","URL":"https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html","URLDate":"2025-09-08"},{"ExternalReferenceID":"REF-943","Authors":["Apurva Udaykumar"],"Title":"Setting a crossdomain.xml file for HTTP streaming","PublicationYear":"2012","PublicationMonth":"11","PublicationDay":"19","Publisher":"Adobe","URL":"https://web.archive.org/web/20121124184922/http://www.adobe.com/devnet/adobe-media-server/articles/cross-domain-xml-for-streaming.html","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-944","Authors":["Adobe"],"Title":"Cross-domain policy for Flash movies","Publisher":"Adobe","URL":"http://kb2.adobe.com/cps/142/tn_14213.html"},{"ExternalReferenceID":"REF-945","Authors":["Microsoft Corporation"],"Title":"HTTP Communication and Security with Silverlight","URL":"https://learn.microsoft.com/en-us/previous-versions/windows/silverlight/dotnet-windows-silverlight/cc838250(v=vs.95)?redirectedfrom=MSDN","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-946","Authors":["Microsoft Corporation"],"Title":"Network Security Access Restrictions in Silverlight","URL":"https://learn.microsoft.com/en-us/previous-versions/windows/silverlight/dotnet-windows-silverlight/cc645032(v=vs.95)","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-947","Authors":["Dongseok Jang","Aishwarya Venkataraman","G. Michael Sawka","Hovav Shacham"],"Title":"Analyzing the Crossdomain Policies of Flash Applications","PublicationYear":"2011","PublicationMonth":"05","URL":"http://cseweb.ucsd.edu/~hovav/dist/crossdomain.pdf"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2014-06-05","SubmissionComment":"Created by MITRE with input from members of the CWE-Research mailing list.","SubmissionVersion":"2.7","SubmissionReleaseDate":"2014-06-23"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Modes_of_Introduction, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-06-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Applicable_Platforms, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-06-25","ModificationComment":"updated Description, Name"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Detection_Factors, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2024-02-29","ModificationComment":"updated Demonstrative_Examples","ModificationVersion":"4.14","ModificationReleaseDate":"2024-02-29"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-09-09","ModificationComment":"updated Background_Details, Common_Consequences, Description, Name, Potential_Mitigations, References","ModificationVersion":"4.18","ModificationReleaseDate":"2025-09-09"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-12-11","ModificationComment":"updated Applicable_Platforms, Relationships, Weakness_Ordinalities","ModificationVersion":"4.19","ModificationReleaseDate":"2025-12-11"},{"Type":"Contribution","ContributionName":"Jagjeet Singh","ContributionOrganization":"Rakuten Kobo Inc.","ContributionDate":"2022-08-23","ContributionComment":"Suggested new entry for misconfigured CSP allowing JavaScript, leading to changes in CWE-942 to make it more general","ContributionType":"Content","ContributionVersion":"4.18","ContributionReleaseDate":"2025-09-09"},{"Type":"Rename","PreviousEntryName":"Overly Permissive Cross-domain Whitelist","Date":"2020-02-26"},{"Type":"Rename","PreviousEntryName":"Permissive Cross-domain Policy with Untrusted Domains","Date":"2025-09-09"}]}