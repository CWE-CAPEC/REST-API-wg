{"ID":"597","Name":"Use of Wrong Operator in String Comparison","Abstraction":"Variant","Structure":"Simple","Status":"Draft","Description":"The product uses the wrong operator when comparing a string, such as using \"==\" when the .equals() method should be used instead.","ExtendedDescription":"In Java, using == or != to compare two strings for equality actually compares two objects for equality rather than their string values for equality. Chances are good that the two references will never be equal. While this weakness often only affects program correctness, if the equality is used for a security decision, the unintended comparison result could be leveraged to affect program security.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"595","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"595","ViewID":"1305","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"480","ViewID":"1000"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Other"],"Impact":["Other"]}],"DetectionMethods":[{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)","Effectiveness":"High"}],"PotentialMitigations":[{"Phase":["Implementation"],"Description":"Within Java, use .equals() to compare string values.\n Within JavaScript, use == to compare string values.\n Within PHP, use == to compare a numeric value to a string value. (PHP converts the string to a number.)","Effectiveness":"High"}],"DemonstrativeExamples":[{"ID":"DX-60","Entries":[{"IntroText":"In the example below, two Java String objects are declared and initialized with the same string values. An if statement is used to determine if the strings are equivalent."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tString str1 = new String(\"Hello\");\n\tString str2 = new String(\"Hello\");\n\tif (str1 == str2) {\n\t\tSystem.out.println(\"str1 == str2\");\n\t}\n```"},{"BodyText":"However, the if statement will not be executed as the strings are compared using the \"==\" operator. For Java objects, such as String objects, the \"==\" operator compares object references, not object values. While the two String objects above contain the same string values, they refer to different object references, so the System.out.println statement will not be executed. To compare object values, the previous code could be modified to use the equals method:"},{"Nature":"Good","Language":"Java","ExampleCode":"```\n\tif (str1.equals(str2)) {\n\t\tSystem.out.println(\"str1 equals str2\");\n\t}\n```"}]},{"Entries":[{"IntroText":"In the example below, three JavaScript variables are declared and initialized with the same values. Note that JavaScript will change a value between numeric and string as needed, which is the reason an integer is included with the strings. An if statement is used to determine whether the values are the same."},{"Nature":"Bad","Language":"JavaScript","ExampleCode":"\u003cp id=\"ieq3s1\" type=\"text\"\u003e(i === s1) is FALSE\u003c/p\u003e\n \u003cp id=\"s4eq3i\" type=\"text\"\u003e(s4 === i) is FALSE\u003c/p\u003e\n \u003cp id=\"s4eq3s1\" type=\"text\"\u003e(s4 === s1) is FALSE\u003c/p\u003e\n\n var i = 65;\n var s1 = '65';\n var s4 = new String('65');\n\n if (i === s1)\n {\n\n```\n\tdocument.getElementById(\"ieq3s1\").innerHTML = \"(i === s1) is TRUE\";\n }\n if (s4 === i)\n {\n\tdocument.getElementById(\"s4eq3i\").innerHTML = \"(s4 === i) is TRUE\";\n }\n if (s4 === s1)\n {\n\tdocument.getElementById(\"s4eq3s1\").innerHTML = \"(s4 === s1) is TRUE\";\n }\n```"},{"BodyText":"However, the body of the if statement will not be executed, as the \"===\" compares both the type of the variable AND the value. As the types of the first comparison are number and string, it fails. The types in the second are int and reference, so this one fails as well. The types in the third are reference and string, so it also fails.\n\n\nWhile the variables above contain the same values, they are contained in different types, so the document.getElementById... statement will not be executed in any of the cases.\n\n\nTo compare object values, the previous code is modified and shown below to use the \"==\" for value comparison so the comparison in this example executes the HTML statement:"},{"Nature":"Good","Language":"JavaScript","ExampleCode":"\u003cp id=\"ieq2s1\" type=\"text\"\u003e(i == s1) is FALSE\u003c/p\u003e\n \u003cp id=\"s4eq2i\" type=\"text\"\u003e(s4 == i) is FALSE\u003c/p\u003e\n \u003cp id=\"s4eq2s1\" type=\"text\"\u003e(s4 == s1) is FALSE\u003c/p\u003e\n\n var i = 65;\n var s1 = '65';\n var s4 = new String('65');\n\n if (i == s1)\n {\n\n```\n\tdocument.getElementById(\"ieq2s1\").innerHTML = \"(i == s1) is TRUE\";\n }\n if (s4 == i)\n {\n\tdocument.getElementById(\"s4eq2i\").innerHTML = \"(s4 == i) is TRUE\";\n }\n if (s4 == s1)\n {\n\tdocument.getElementById(\"s4eq2s1\").innerHTML = \"(s4 == s1) is TRUE\";\n }\n```"}]},{"Entries":[{"IntroText":"In the example below, two PHP variables are declared and initialized with the same numbers - one as a string, the other as an integer. Note that PHP will change the string value to a number for a comparison. An if statement is used to determine whether the values are the same."},{"Nature":"Bad","Language":"PHP","ExampleCode":"var $i = 65;\n var $s1 = \"65\";\n\n if ($i === $s1)\n {\n\n```\n\techo '($i === $s1) is TRUE'. \"\\n\";\n }\n else\n {\n\techo '($i === $s1) is FALSE'. \"\\n\";\n }\n```"},{"BodyText":"However, the body of the if statement will not be executed, as the \"===\" compares both the type of the variable AND the value. As the types of the first comparison are number and string, it fails.\n\n\nWhile the variables above contain the same values, they are contained in different types, so the TRUE portion of the if statement will not be executed.\n\n\nTo compare object values, the previous code is modified and shown below to use the \"==\" for value comparison (string converted to number) so the comparison in this example executes the TRUE statement:"},{"Nature":"Good","Language":"PHP","ExampleCode":"var $i = 65;\n var $s1 = \"65\";\n\n if ($i == $s1)\n {\n\n```\n\techo '($i == $s1) is TRUE'. \"\\n\";\n }\n else\n {\n\techo '($i == $s1) is FALSE'. \"\\n\";\n }\n```"}]}],"TaxonomyMappings":[{"TaxonomyName":"The CERT Oracle Secure Coding Standard for Java (2011)","EntryID":"EXP03-J","EntryName":"Do not use the equality operators when comparing values of boxed primitives"},{"TaxonomyName":"The CERT Oracle Secure Coding Standard for Java (2011)","EntryID":"EXP03-J","EntryName":"Do not use the equality operators when comparing values of boxed primitives"},{"TaxonomyName":"SEI CERT Perl Coding Standard","EntryID":"EXP35-PL","EntryName":"Use the correct operator type for comparing values","MappingFit":"CWE More Specific"},{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP1","EntryName":"Glitch in computation"}],"References":[{"ExternalReferenceID":"REF-62","Section":"Chapter 6, \"Typos\", Page 289","Authors":["Mark Dowd","John McDonald","Justin Schuh"],"Title":"The Art of Software Security Assessment","Edition":"1st Edition","PublicationYear":"2006","Publisher":"Addison Wesley"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2006-12-15","SubmissionVersion":"Draft 5","SubmissionReleaseDate":"2006-12-15"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Potential_Mitigations, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Description, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-05-27","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Demonstrative_Examples, Description, Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Demonstrative_Examples, References, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-08-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Demonstrative_Examples, Description, Potential_Mitigations, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Detection_Factors, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-04-03","ModificationComment":"updated Demonstrative_Examples","ModificationVersion":"4.17","ModificationReleaseDate":"2025-04-03"},{"Type":"Rename","PreviousEntryName":"Erroneous String Compare","Date":"2008-04-11"}]}