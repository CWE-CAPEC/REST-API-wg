{"ID":"940","Name":"Improper Verification of Source of a Communication Channel","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The product establishes a communication channel to handle an incoming request that has been initiated by an actor, but it does not properly verify that the request is coming from the expected origin.","ExtendedDescription":"When an attacker can successfully establish a communication channel from an untrusted origin, the attacker may be able to gain privileges and access unexpected functionality.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"923","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"346","ViewID":"1000"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Class":"Mobile","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design"},{"Phase":"Implementation","Note":"REALIZATION: This weakness is caused during implementation of an architectural security tactic."}],"CommonConsequences":[{"Scope":["Access Control","Other"],"Impact":["Gain Privileges or Assume Identity","Varies by Context"],"Note":"An attacker can access any functionality that is inadvertently accessible to the source."}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"\n\nUse a mechanism that can validate the identity of the source, such as a certificate, and validate the integrity of data to ensure that it cannot be modified in transit using an Adversary-in-the-Middle (AITM) attack.\n\n\nWhen designing functionality of actions in the URL scheme, consider whether the action should be accessible to all mobile applications, or if an allowlist of applications to interface with is appropriate.\n"}],"DemonstrativeExamples":[{"ID":"DX-112","Entries":[{"IntroText":"This Android application will remove a user account when it receives an intent to do so:"},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tIntentFilter filter = new IntentFilter(\"com.example.RemoveUser\");\n\tMyReceiver receiver = new MyReceiver();\n\tregisterReceiver(receiver, filter);\n\tpublic class DeleteReceiver extends BroadcastReceiver {\n\t\t@Override\n\t\tpublic void onReceive(Context context, Intent intent) {\n\t\t\tint userID = intent.getIntExtra(\"userID\");\n\t\t\tdestroyUserData(userID);\n\t\t}\n\t}\n```"},{"BodyText":"This application does not check the origin of the intent, thus allowing any malicious application to remove a user. Always check the origin of an intent, or create an allowlist of trusted applications using the manifest.xml file."}]},{"ID":"DX-109","Entries":[{"IntroText":"These Android and iOS applications intercept URL loading within a WebView and perform special actions if a particular URL scheme is used, thus allowing the Javascript within the WebView to communicate with the application:"},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n```\n// Android* \n\t@Override\n\tpublic boolean shouldOverrideUrlLoading(WebView view, String url){\n\t```\n\t\t\tif (url.substring(0,14).equalsIgnoreCase(\"examplescheme:\")){\n\t\t\t\tif(url.substring(14,25).equalsIgnoreCase(\"getUserInfo\")){\n\t\t\t\t\twriteDataToView(view, UserData);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t}\n```"},{"Nature":"Bad","Language":"Objective-C","ExampleCode":"```\n```\n// iOS* \n\t-(BOOL) webView:(UIWebView *)exWebView shouldStartLoadWithRequest:(NSURLRequest *)exRequest navigationType:(UIWebViewNavigationType)exNavigationType\n\t{\n\t```\n\t\t\tNSURL *URL = [exRequest URL];\n\t\t\tif ([[URL scheme] isEqualToString:@\"exampleScheme\"])\n\t\t\t{\n\t\t\t\t\tNSString *functionString = [URL resourceSpecifier];\n\t\t\t\t\tif ([functionString hasPrefix:@\"specialFunction\"])\n\t\t\t\t\t{\n```\n// Make data available back in webview.* \n\t\t\t\t\t\t\tUIWebView *webView = [self writeDataToView:[URL query]];}\n\t\t\t\t\treturn NO;}\n\t\t\treturn YES;}"},{"BodyText":"A call into native code can then be initiated by passing parameters within the URL:"},{"Nature":"Attack","Language":"JavaScript","ExampleCode":"```\n\twindow.location = examplescheme://method?parameter=value\n```"},{"BodyText":"Because the application does not check the source, a malicious website loaded within this WebView has the same access to the API as a trusted site."}]}],"ObservedExamples":[{"Reference":"CVE-2000-1218","Description":"DNS server can accept DNS updates from hosts that it did not query, leading to cache poisoning","Link":"https://www.cve.org/CVERecord?id=CVE-2000-1218"},{"Reference":"CVE-2005-0877","Description":"DNS server can accept DNS updates from hosts that it did not query, leading to cache poisoning","Link":"https://www.cve.org/CVERecord?id=CVE-2005-0877"},{"Reference":"CVE-2001-1452","Description":"DNS server caches glue records received from non-delegated name servers","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1452"}],"RelatedAttackPatterns":["500","594","595","596"],"References":[{"ExternalReferenceID":"REF-324","Authors":["Taimur Aslam"],"Title":"A Taxonomy of Security Faults in the UNIX Operating System","PublicationYear":"1995","PublicationMonth":"08","PublicationDay":"01","URL":"https://cwe.mitre.org/documents/sources/ATaxonomyofSecurityFaultsintheUNIXOperatingSystem%5BAslam95%5D.pdf","URLDate":"2024-11-17"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Relationship","Note":"While many access control issues involve authenticating the user, this weakness is more about authenticating the actual source of the communication channel itself; there might not be any \"user\" in such cases."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2014-02-13","SubmissionVersion":"2.6","SubmissionReleaseDate":"2014-02-19"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Modes_of_Introduction, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-06-20","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Applicable_Platforms, Potential_Mitigations, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-06-25","ModificationComment":"updated Demonstrative_Examples, Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-07-20","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description, Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2024-11-19","ModificationComment":"updated References","ModificationVersion":"4.16","ModificationReleaseDate":"2024-11-19"}]}