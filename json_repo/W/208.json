{"ID":"208","Name":"Observable Timing Discrepancy","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"Two separate operations in a product require different amounts of time to complete, in a way that is observable to an actor and reveals security-relevant information about the state of the product, such as whether a particular operation was successful or not.","ExtendedDescription":"In security-relevant contexts, even small variations in timing can be exploited by attackers to indirectly infer certain details about the product's internal operations. For example, in some cryptographic algorithms, attackers can use timing differences to infer certain properties about a private key, making the key easier to guess. Timing discrepancies effectively form a timing side channel.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"203","ViewID":"1000","Ordinal":"Primary"},{"Nature":"CanPrecede","CweID":"385","ViewID":"1000"},{"Nature":"CanPrecede","CweID":"327","ViewID":"1000"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design","Note":"COMMISSION: This weakness refers to an incorrect design related to an architectural security tactic."},{"Phase":"Implementation"},{"Phase":"Operation"}],"CommonConsequences":[{"Scope":["Confidentiality","Access Control"],"Impact":["Read Application Data","Bypass Protection Mechanism"]}],"DemonstrativeExamples":[{"ID":"DX-173","Entries":[{"IntroText":"Consider an example hardware module that checks a user-provided password to grant access to a user. The user-provided password is compared against a golden value in a byte-by-byte manner."},{"Nature":"Bad","Language":"Verilog","ExampleCode":"always_comb @ (posedge clk)\n\n begin\n\n```\n\t assign check_pass[3:0] = 4'b0;\n\t for (i = 0; i \u003c 4; i++) begin\n\t\t if (entered_pass[(i*8 - 1) : i] eq golden_pass([i*8 - 1) : i])\n\t\t\t assign check_pass[i] = 1;\n\t\t\t continue;\n\t\t else\n\t\t\t assign check_pass[i] = 0;\n\t\t\t break;\n\t\t end\n\t assign grant_access = (check_pass == 4'b1111) ? 1'b1: 1'b0;\n end\n```"},{"BodyText":"Since the code breaks on an incorrect entry of password, an attacker can guess the correct password for that byte-check iteration with few repeat attempts."},{"BodyText":"To fix this weakness, either the comparison of the entire string should be done all at once, or the attacker is not given an indication whether pass or fail happened by allowing the comparison to run through all bits before the grant_access signal is set."},{"Nature":"Good","ExampleCode":"always_comb @ (posedge clk)\n begin\n\n```\n\t assign check_pass[3:0] = 4'b0;\n\t for (i = 0; i \u003c 4; i++) begin\n\t\t if (entered_pass[(i*8 - 1) : i] eq golden_pass([i*8 -1) : i])\n\t\t\t assign check_pass[i] = 1;\n\t\t\t continue;\n\t\t else\n\t\t\t assign check_pass[i] = 0;\n\t\t\t continue;\n\t\t end\n\t assign grant_access = (check_pass == 4'b1111) ? 1'b1: 1'b0;\n end\n```"}]},{"ID":"DX-193","Entries":[{"IntroText":"In this example, the attacker observes how long an authentication takes when the user types in the correct password."},{"BodyText":"When the attacker tries their own values, they can first try strings of various length. When they find a string of the right length, the computation will take a bit longer, because the for loop will run at least once. Additionally, with this code, the attacker can possibly learn one character of the password at a time, because when they guess the first character right, the computation will take longer than a wrong guesses. Such an attack can break even the most sophisticated password with a few hundred guesses."},{"Nature":"Bad","Language":"Python","ExampleCode":"```\n\tdef validate_password(actual_pw, typed_pw): \n\t\t\tif len(actual_pw) \u003c\u003e len(typed_pw): \n\t\t\t\treturn 0\n\t\t\tfor i in len(actual_pw): \n\t\t\t\tif actual_pw[i] \u003c\u003e typed_pw[i]: \n\t\t\t\t\treturn 0\n\t\t\treturn 1\n```"},{"BodyText":"Note that in this example, the actual password must be handled in constant time as far as the attacker is concerned, even if the actual password is of an unusual length. This is one reason why it is good to use an algorithm that, among other things, stores a seeded cryptographic one-way hash of the password, then compare the hashes, which will always be of the same length."}]}],"ObservedExamples":[{"Reference":"CVE-2019-10071","Description":"Java-oriented framework compares HMAC signatures using String.equals() instead of a constant-time algorithm, causing timing discrepancies","Link":"https://www.cve.org/CVERecord?id=CVE-2019-10071"},{"Reference":"CVE-2019-10482","Description":"Smartphone OS uses comparison functions that are not in constant time, allowing side channels","Link":"https://www.cve.org/CVERecord?id=CVE-2019-10482"},{"Reference":"CVE-2014-0984","Description":"Password-checking function in router terminates validation of a password entry when it encounters the first incorrect character, which allows remote attackers to obtain passwords via a brute-force attack that relies on timing differences in responses to incorrect password guesses, aka a timing side-channel attack.","Link":"https://www.cve.org/CVERecord?id=CVE-2014-0984"},{"Reference":"CVE-2003-0078","Description":"SSL implementation does not perform a MAC computation if an incorrect block cipher padding is used, which causes an information leak (timing discrepancy) that may make it easier to launch cryptographic attacks that rely on distinguishing between padding and MAC verification errors, possibly leading to extraction of the original plaintext, aka the \"Vaudenay timing attack.\"","Link":"https://www.cve.org/CVERecord?id=CVE-2003-0078"},{"Reference":"CVE-2000-1117","Description":"Virtual machine allows malicious web site operators to determine the existence of files on the client by measuring delays in the execution of the getSystemResource method.","Link":"https://www.cve.org/CVERecord?id=CVE-2000-1117"},{"Reference":"CVE-2003-0637","Description":"Product uses a shorter timeout for a non-existent user than a valid user, which makes it easier for remote attackers to guess usernames and conduct brute force password guessing.","Link":"https://www.cve.org/CVERecord?id=CVE-2003-0637"},{"Reference":"CVE-2003-0190","Description":"Product immediately sends an error message when a user does not exist, which allows remote attackers to determine valid usernames via a timing attack.","Link":"https://www.cve.org/CVERecord?id=CVE-2003-0190"},{"Reference":"CVE-2004-1602","Description":"FTP server responds in a different amount of time when a given username exists, which allows remote attackers to identify valid usernames by timing the server response.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-1602"},{"Reference":"CVE-2005-0918","Description":"Browser allows remote attackers to determine the existence of arbitrary files by setting the src property to the target filename and using Javascript to determine if the web page immediately stops loading, which indicates whether the file exists or not.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-0918"}],"FunctionalAreas":["Cryptography","Authentication"],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Timing discrepancy infoleak"}],"RelatedAttackPatterns":["462","541","580"],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Relationship","Note":"Often primary in cryptographic applications and algorithms."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Relationships, Other_Notes, Relationship_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-09-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Name"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Observed_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-06-23","ModificationComment":"updated Other_Notes, Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-05-03","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Modes_of_Introduction, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Description, Name, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-06-25","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Observed_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-10-26","ModificationComment":"updated Demonstrative_Examples, Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2024-02-29","ModificationComment":"updated Demonstrative_Examples","ModificationVersion":"4.14","ModificationReleaseDate":"2024-02-29"},{"Type":"Rename","PreviousEntryName":"Timing Discrepancy Information Leak","Date":"2011-03-29"},{"Type":"Rename","PreviousEntryName":"Information Exposure Through Timing Discrepancy","Date":"2020-02-24"}]}