{"ID":"61","Name":"UNIX Symbolic Link (Symlink) Following","Abstraction":"Compound","Structure":"Composite","Status":"Incomplete","Description":"The product, when opening a file or directory, does not sufficiently account for when the file is a symbolic link that resolves to a target outside of the intended control sphere. This could allow an attacker to cause the product to operate on unauthorized files.","ExtendedDescription":"A product that allows UNIX symbolic links (symlink) as part of paths whether in internal code or through user input can allow an attacker to spoof the symbolic link and traverse the file system to unintended locations or access arbitrary files. The symbolic link can permit an attacker to read/write/corrupt a file that they originally did not have permissions to access.","LikelihoodOfExploit":"High","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"59","ViewID":"1000","Ordinal":"Primary"},{"Nature":"Requires","CweID":"362","ViewID":"1000"},{"Nature":"Requires","CweID":"340","ViewID":"1000"},{"Nature":"Requires","CweID":"386","ViewID":"1000"},{"Nature":"Requires","CweID":"732","ViewID":"1000"}],"WeaknessOrdinalities":[{"Ordinality":"Resultant"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"AlternateTerms":[{"Term":"Symlink following"},{"Term":"symlink vulnerability"}],"ModesOfIntroduction":[{"Phase":"Implementation","Note":"These are typically reported for temporary files or privileged programs."}],"CommonConsequences":[{"Scope":["Confidentiality","Integrity"],"Impact":["Read Files or Directories","Modify Files or Directories"]}],"DetectionMethods":[{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)"}],"PotentialMitigations":[{"Phase":["Implementation"],"Description":"Symbolic link attacks often occur when a program creates a tmp directory that stores files/links. Access to the directory should be restricted to the program as to prevent attackers from manipulating the files."},{"MitigationID":"MIT-48.1","Phase":["Architecture and Design"],"Strategy":"Separation of Privilege","Description":"\n\nFollow the principle of least privilege when assigning access rights to entities in a software system.\n\n\nDenying access to a file can prevent an attacker from replacing that file with a link to a sensitive file. Ensure good compartmentalization in the system to provide protected areas that can be trusted.\n"}],"ObservedExamples":[{"Reference":"CVE-1999-1386","Description":"Some versions of Perl follow symbolic links when running with the -e option, which allows local users to overwrite arbitrary files via a symlink attack.","Link":"https://www.cve.org/CVERecord?id=CVE-1999-1386"},{"Reference":"CVE-2000-1178","Description":"Text editor follows symbolic links when creating a rescue copy during an abnormal exit, which allows local users to overwrite the files of other users.","Link":"https://www.cve.org/CVERecord?id=CVE-2000-1178"},{"Reference":"CVE-2004-0217","Description":"Antivirus update allows local users to create or append to arbitrary files via a symlink attack on a logfile.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0217"},{"Reference":"CVE-2003-0517","Description":"Symlink attack allows local users to overwrite files.","Link":"https://www.cve.org/CVERecord?id=CVE-2003-0517"},{"Reference":"CVE-2004-0689","Description":"Possible interesting example","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0689"},{"Reference":"CVE-2005-1879","Description":"Second-order symlink vulnerabilities","Link":"https://www.cve.org/CVERecord?id=CVE-2005-1879"},{"Reference":"CVE-2005-1880","Description":"Second-order symlink vulnerabilities","Link":"https://www.cve.org/CVERecord?id=CVE-2005-1880"},{"Reference":"CVE-2005-1916","Description":"Symlink in Python program","Link":"https://www.cve.org/CVERecord?id=CVE-2005-1916"},{"Reference":"CVE-2000-0972","Description":"Setuid product allows file reading by replacing a file being edited with a symlink to the targeted file, leaking the result in error messages when parsing fails.","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0972"},{"Reference":"CVE-2005-0824","Description":"Signal causes a dump that follows symlinks.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-0824"},{"Reference":"CVE-2015-3629","Description":"A Libcontainer used in Docker Engine allows local users to escape containerization and write to an arbitrary file on the host system via a symlink attack in an image when respawning a container.","Link":"https://www.cve.org/CVERecord?id=CVE-2015-3629"},{"Reference":"CVE-2020-26277","Description":"In a MySQL database deployment tool, users may craft a maliciously packaged tarball that contains symlinks to files external to the target and once unpacked, will execute.","Link":"https://www.cve.org/CVERecord?id=CVE-2020-26277"},{"Reference":"CVE-2021-21272","Description":"\"Zip Slip\" vulnerability in Go-based Open Container Initiative (OCI) registries product allows writing arbitrary files outside intended directory via symbolic links or hard links in a gzipped tarball.","Link":"https://www.cve.org/CVERecord?id=CVE-2021-21272"}],"FunctionalAreas":["File Processing"],"AffectedResources":["File or Directory"],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"UNIX symbolic link following"}],"RelatedAttackPatterns":["27"],"References":[{"ExternalReferenceID":"REF-493","Authors":["Steve Christey"],"Title":"Second-Order Symlink Vulnerabilities","Publication":"Bugtraq","PublicationYear":"2005","PublicationMonth":"06","PublicationDay":"07","URL":"https://seclists.org/bugtraq/2005/Jun/44","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-494","Authors":["Shaun Colley"],"Title":"Crafting Symlinks for Fun and Profit","Publication":"Infosec Writers Text Library","PublicationYear":"2004","PublicationMonth":"04","PublicationDay":"12","URL":"https://web.archive.org/web/20040502153535/http://www.infosecwriters.com/texts.php?op=display\u0026id=159","URLDate":"2025-07-29"},{"ExternalReferenceID":"REF-62","Section":"Chapter 9, \"Symbolic Link Attacks\", Page 518","Authors":["Mark Dowd","John McDonald","Justin Schuh"],"Title":"The Art of Software Security Assessment","Edition":"1st Edition","PublicationYear":"2006","Publisher":"Addison Wesley"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This is a well-known Composite of multiple weaknesses that must all occur simultaneously, although it is attack-oriented in nature.","Comments":"While attack-oriented composites are supported in CWE, they have not been a focus of research. There is a chance that future research or CWE scope clarifications will change or deprecate them. Perform root-cause analysis to determine which weaknesses allow symlink following to occur, and map to those weaknesses. For example, predictable file names might be intended functionality, but creation in a directory with insecure permissions might not.","Reasons":["Other"]},"Notes":[{"Type":"Research Gap","Note":"\n\nSymlink vulnerabilities are regularly found in C and shell programs, but all programming languages can have this problem. Even shell programs are probably under-reported.\n\n\n\"Second-order symlink vulnerabilities\" may exist in programs that invoke other programs that follow symlinks. They are rarely reported but are likely to be fairly common when process invocation is used [REF-493].\n"}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Relationships, Observed_Example, Other_Notes, Research_Gaps, Taxonomy_Mappings, Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-07-27","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Observed_Examples, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-06-23","ModificationComment":"updated Modes_of_Introduction, Other_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Causal_Nature, Likelihood_of_Exploit, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-04-28","ModificationComment":"updated Research_Gaps"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-09-09","ModificationComment":"updated Affected_Resources, Functional_Areas, References","ModificationVersion":"4.18","ModificationReleaseDate":"2025-09-09"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-12-11","ModificationComment":"updated Detection_Factors, Relationships","ModificationVersion":"4.19","ModificationReleaseDate":"2025-12-11"}]}