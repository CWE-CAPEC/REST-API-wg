{"ID":"184","Name":"Incomplete List of Disallowed Inputs","Abstraction":"Base","Structure":"Simple","Status":"Draft","Description":"The product implements a protection mechanism that relies on a list of inputs (or properties of inputs) that are not allowed by policy or otherwise require other action to neutralize before additional processing takes place, but the list is incomplete, leading to resultant weaknesses.","ExtendedDescription":"Developers often try to protect their products against malicious input by performing tests against inputs that are known to be bad, such as special characters that can invoke new commands. However, such lists often only account for the most well-known bad inputs. Attackers may be able to find other malicious inputs that were not expected by the developer, allowing them to bypass the intended protection mechanism.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"693","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"1023","ViewID":"1000"},{"Nature":"CanPrecede","CweID":"79","ViewID":"1000"},{"Nature":"CanPrecede","CweID":"78","ViewID":"1000"},{"Nature":"CanPrecede","CweID":"434","ViewID":"1000"},{"Nature":"CanPrecede","CweID":"98","ViewID":"1000"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"AlternateTerms":[{"Term":"Denylist / Deny List","Description":"This is used by CWE and CAPEC instead of other commonly-used terms. Its counterpart is allowlist."},{"Term":"Blocklist / Block List","Description":"This is often used by security tools such as firewalls, email or web gateways, proxies, etc."},{"Term":"Blacklist / Black List","Description":"This term is frequently used, but usage has been declining as organizations have started to adopt other terms."}],"ModesOfIntroduction":[{"Phase":"Implementation","Note":"Developers might begin to develop a list of bad inputs as a fast way to fix a particular weakness, instead of fixing the root cause. See [REF-141]."},{"Phase":"Architecture and Design","Note":"The design might rely solely on detection of malicious inputs as a protection mechanism."}],"CommonConsequences":[{"Scope":["Access Control"],"Impact":["Bypass Protection Mechanism"]}],"DetectionMethods":[{"Method":"Black Box","Description":"Exploitation of a vulnerability with commonly-used manipulations might fail, but minor variations might succeed."}],"PotentialMitigations":[{"Phase":["Implementation"],"Strategy":"Input Validation","Description":"Do not rely exclusively on detecting disallowed inputs. There are too many variants to encode a character, especially when different environments are used, so there is a high likelihood of missing some variants. Only use detection of disallowed inputs as a mechanism for detecting suspicious activity. Ensure that you are using other protection mechanisms that only identify \"good\" input - such as lists of allowed inputs - and ensure that you are properly encoding your outputs."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"The following code attempts to stop XSS attacks by removing all occurences of \"script\" in an input string."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tpublic String removeScriptTags(String input, String mask) {\n\t\treturn input.replaceAll(\"script\", mask);\n\t}\n```"},{"BodyText":"Because the code only checks for the lower-case \"script\" string, it can be easily defeated with upper-case script tags."}]}],"ObservedExamples":[{"Reference":"CVE-2024-4315","Description":"Chain: API for text generation using Large Language Models (LLMs) does not include the \"\\\" Windows folder separator in its denylist (CWE-184) when attempting to prevent Local File Inclusion via path traversal (CWE-22), allowing deletion of arbitrary files on Windows systems.","Link":"https://www.cve.org/CVERecord?id=CVE-2024-4315"},{"Reference":"CVE-2008-2309","Description":"product uses a denylist to identify potentially dangerous content, allowing attacker to bypass a warning","Link":"https://www.cve.org/CVERecord?id=CVE-2008-2309"},{"Reference":"CVE-2005-2782","Description":"PHP remote file inclusion in web application that filters \"http\" and \"https\" URLs, but not \"ftp\".","Link":"https://www.cve.org/CVERecord?id=CVE-2005-2782"},{"Reference":"CVE-2004-0542","Description":"Programming language does not filter certain shell metacharacters in Windows environment.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0542"},{"Reference":"CVE-2004-0595","Description":"XSS filter doesn't filter null characters before looking for dangerous tags, which are ignored by web browsers. MIE and validate-before-cleanse.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0595"},{"Reference":"CVE-2005-3287","Description":"Web-based mail product doesn't restrict dangerous extensions such as ASPX on a web server, even though others are prohibited.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-3287"},{"Reference":"CVE-2004-2351","Description":"Resultant XSS when only \u003cscript\u003e and \u003cstyle\u003e are checked.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-2351"},{"Reference":"CVE-2005-2959","Description":"Privileged program does not clear sensitive environment variables that are used by bash. Overlaps multiple interpretation error.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-2959"},{"Reference":"CVE-2005-1824","Description":"SQL injection protection scheme does not quote the \"\\\" special character.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-1824"},{"Reference":"CVE-2005-2184","Description":"Detection of risky filename extensions prevents users from automatically executing .EXE files, but .LNK is accepted, allowing resultant Windows symbolic link.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-2184"},{"Reference":"CVE-2007-1343","Description":"Product uses list of protected variables, but accidentally omits one dangerous variable, allowing external modification","Link":"https://www.cve.org/CVERecord?id=CVE-2007-1343"},{"Reference":"CVE-2007-5727","Description":"Chain: product only removes SCRIPT tags (CWE-184), enabling XSS (CWE-79)","Link":"https://www.cve.org/CVERecord?id=CVE-2007-5727"},{"Reference":"CVE-2006-4308","Description":"Chain: product only checks for use of \"javascript:\" tag (CWE-184), allowing XSS (CWE-79) using other tags","Link":"https://www.cve.org/CVERecord?id=CVE-2006-4308"},{"Reference":"CVE-2007-3572","Description":"Chain: OS command injection (CWE-78) enabled by using an unexpected character that is not explicitly disallowed (CWE-184)","Link":"https://www.cve.org/CVERecord?id=CVE-2007-3572"},{"Reference":"CVE-2002-0661","Description":"\"\\\" not in list of disallowed values for web server, allowing path traversal attacks when the server is run on Windows and other OSes.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0661"}],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Incomplete Blacklist"}],"RelatedAttackPatterns":["120","15","182","3","43","6","71","73","85"],"References":[{"ExternalReferenceID":"REF-140","Authors":["Greg Hoglund","Gary McGraw"],"Title":"Exploiting Software: How to Break Code","PublicationYear":"2004","PublicationMonth":"02","PublicationDay":"27","Publisher":"Addison-Wesley","URL":"https://www.amazon.com/Exploiting-Software-How-Break-Code/dp/0201786958","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-141","Authors":["Steve Christey"],"Title":"Blacklist defenses as a breeding ground for vulnerability variants","PublicationYear":"2006","PublicationMonth":"02","PublicationDay":"03","URL":"https://seclists.org/fulldisclosure/2006/Feb/40","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-62","Section":"Chapter 8, \"Eliminating Metacharacters\", Page 435","Authors":["Mark Dowd","John McDonald","Justin Schuh"],"Title":"The Art of Software Security Assessment","Edition":"1st Edition","PublicationYear":"2006","Publisher":"Addison Wesley"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Relationship","Note":"\n\nMultiple interpretation errors can indirectly introduce inputs that should be disallowed. For example, a list of dangerous shell metacharacters might not include a metacharacter that only has meaning in one particular shell, not all of them; or a check for XSS manipulations might ignore an unusual construct that is supported by one web browser, but not others.\n"}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Sean Eidemiller","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"added/updated demonstrative examples"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Potential_Mitigations, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Detection_Factors, Relationships, Other_Notes, Relationship_Notes, Taxonomy_Mappings, Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-11-24","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-05-27","ModificationComment":"updated Description, Other_Notes, Relationship_Notes, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-02-16","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-04-05","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-06-21","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated References, Related_Attack_Patterns, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2013-02-21","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Demonstrative_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2015-12-07","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-05-03","ModificationComment":"updated Potential_Mitigations, Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2018-03-27","ModificationComment":"updated Observed_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-06-20","ModificationComment":"updated Related_Attack_Patterns, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Alternate_Terms, Description, Detection_Factors, Modes_of_Introduction, Name, Observed_Examples, Potential_Mitigations, Relationship_Notes, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-06-25","ModificationComment":"updated Alternate_Terms, Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2024-07-16","ModificationComment":"updated Observed_Examples","ModificationVersion":"4.15","ModificationReleaseDate":"2024-07-16"},{"Type":"Rename","PreviousEntryName":"Incomplete Blacklist","Date":"2020-02-24"}]}