{"ID":"454","Name":"External Initialization of Trusted Variables or Data Stores","Abstraction":"Base","Structure":"Simple","Status":"Draft","Description":"The product initializes critical internal variables or data stores using inputs that can be modified by untrusted actors.","ExtendedDescription":"A product system should be reluctant to trust variables that have been initialized outside of its trust boundary, especially if they are initialized by users. The variables may have been initialized incorrectly. If an attacker can initialize the variable, then they can influence what the vulnerable system will do.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"1419","ViewID":"1000","Ordinal":"Primary"},{"Nature":"CanAlsoBe","CweID":"456","ViewID":"1000"}],"ApplicablePlatforms":[{"Type":"Language","Name":"PHP","Prevalence":"Sometimes"},{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design"},{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Integrity"],"Impact":["Modify Application Data"],"Note":"An attacker could gain access to and modify sensitive data or system information."}],"PotentialMitigations":[{"Phase":["Implementation"],"Strategy":"Input Validation","Description":"A product system should be reluctant to trust variables that have been initialized outside of its trust boundary. Ensure adequate checking (e.g. input validation) is performed when relying on input from outside a trust boundary."},{"Phase":["Architecture and Design"],"Description":"Avoid any external control of variables. If necessary, restrict the variables that can be modified using an allowlist, and use a different namespace or naming convention if possible."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"In the Java example below, a system property controls the debug level of the application."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tint debugLevel = Integer.getInteger(\"com.domain.application.debugLevel\").intValue();\n```"},{"BodyText":"If an attacker is able to modify the system property, then it may be possible to coax the application into divulging sensitive information by virtue of the fact that additional debug information is printed/exposed as the debug level increases."}]},{"Entries":[{"IntroText":"This code checks the HTTP POST request for a debug switch, and enables a debug mode if the switch is set."},{"Nature":"Bad","Language":"PHP","ExampleCode":"```\n\t$debugEnabled = false;\n\tif ($_POST[\"debug\"] == \"true\"){\n\t\t$debugEnabled = true;\n\t}\n```\n/.../* \n\t\n\tfunction login($username, $password){\n\t```\n\t\tif($debugEnabled){\n\t\t\techo 'Debug Activated';\n\t\t\tphpinfo();\n\t\t\t$isAdmin = True;\n\t\t\treturn True;\n\t\t}\n\t}\n```"},{"BodyText":"Any user can activate the debug mode, gaining administrator privileges. An attacker may also use the information printed by the phpinfo() function to further exploit the system. ."},{"BodyText":"This example also exhibits Information Exposure Through Debug Information (CWE-215)"}]}],"ObservedExamples":[{"Reference":"CVE-2022-43468","Description":"WordPress module sets internal variables based on external inputs, allowing false reporting of the number of views","Link":"https://www.cve.org/CVERecord?id=CVE-2022-43468"},{"Reference":"CVE-2000-0959","Description":"Does not clear dangerous environment variables, enabling symlink attack.","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0959"},{"Reference":"CVE-2001-0033","Description":"Specify alternate configuration directory in environment variable, enabling untrusted path.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0033"},{"Reference":"CVE-2001-0872","Description":"Dangerous environment variable not cleansed.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0872"},{"Reference":"CVE-2001-0084","Description":"Specify arbitrary modules using environment variable.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0084"}],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"External initialization of trusted variables or values"},{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP25","EntryName":"Tainted input to variable"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Relationship","Note":"Overlaps Missing variable initialization, especially in PHP."},{"Type":"Applicable Platform","Note":"\n\nThis is often found in PHP due to register_globals and the common practice of storing library/include files under the web document root so that they are available using a direct request.\n"}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Sean Eidemiller","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"added/updated demonstrative examples"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Potential_Mitigations, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Applicable_Platforms, Description, Relationships, Other_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-10-29","ModificationComment":"updated Other_Notes, Relationship_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-02-16","ModificationComment":"updated Description, Name, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-04-05","ModificationComment":"updated Applicable_Platforms, Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Common_Consequences, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-06-25","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description, Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-10-26","ModificationComment":"updated Observed_Examples, Relationships"},{"Type":"Rename","PreviousEntryName":"External Initialization of Trusted Variables or Values","Date":"2008-04-11"},{"Type":"Rename","PreviousEntryName":"External Initialization of Trusted Variables","Date":"2010-02-16"}]}