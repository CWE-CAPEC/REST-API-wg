{"ID":"178","Name":"Improper Handling of Case Sensitivity","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The product does not properly account for differences in case sensitivity when accessing or determining the properties of a resource, leading to inconsistent results.","ExtendedDescription":"\n\nImproperly handled case sensitive data can lead to several possible consequences, including:\n\n\n  - case-insensitive passwords reducing the size of the key space, making brute force attacks easier\n\n  - bypassing filters or access controls using alternate names\n\n  - multiple interpretation errors using alternate names.\n\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"706","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"706","ViewID":"1003","Ordinal":"Primary"},{"Nature":"CanPrecede","CweID":"433","ViewID":"1000"},{"Nature":"CanPrecede","CweID":"289","ViewID":"1000"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Access Control"],"Impact":["Bypass Protection Mechanism"]}],"PotentialMitigations":[{"MitigationID":"MIT-44","Phase":["Architecture and Design"],"Strategy":"Input Validation","Description":"Avoid making decisions based on names of resources (e.g. files) if those resources can have alternate names."},{"MitigationID":"MIT-5","Phase":["Implementation"],"Strategy":"Input Validation","Description":"\n\nAssume all input is malicious. Use an \"accept known good\" input validation strategy, i.e., use a list of acceptable inputs that strictly conform to specifications. Reject any input that does not strictly conform to specifications, or transform it into something that does.\n\n\nWhen performing input validation, consider all potentially relevant properties, including length, type of input, the full range of acceptable values, missing or extra inputs, syntax, consistency across related fields, and conformance to business rules. As an example of business rule logic, \"boat\" may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as \"red\" or \"blue.\"\n\n\nDo not rely exclusively on looking for malicious or malformed inputs. This is likely to miss at least one undesirable input, especially if the code's environment changes. This can give attackers enough room to bypass the intended validation. However, denylists can be useful for detecting potential attacks or determining which inputs are so malformed that they should be rejected outright.\n"},{"MitigationID":"MIT-20","Phase":["Implementation"],"Strategy":"Input Validation","Description":"Inputs should be decoded and canonicalized to the application's current internal representation before being validated (CWE-180). Make sure that the application does not decode the same input twice (CWE-174). Such errors could be used to bypass allowlist validation schemes by introducing dangerous inputs after they have been checked."}],"DemonstrativeExamples":[{"ID":"DX-141","Entries":[{"IntroText":"In the following example, an XSS neutralization method intends to replace script tags in user-supplied input with a safe equivalent:"},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tpublic String preventXSS(String input, String mask) {\n\t\treturn input.replaceAll(\"script\", mask);\n\t}\n```"},{"BodyText":"The code only works when the \"script\" tag is in all lower-case, forming an incomplete denylist (CWE-184). Equivalent tags such as \"SCRIPT\" or \"ScRiPt\" will not be neutralized by this method, allowing an XSS attack."}]}],"ObservedExamples":[{"Reference":"CVE-2000-0499","Description":"Application server allows attackers to bypass execution of a jsp page and read the source code using an upper case JSP extension in the request.","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0499"},{"Reference":"CVE-2000-0497","Description":"The server is case sensitive, so filetype handlers treat .jsp and .JSP as different extensions. JSP source code may be read because .JSP defaults to the filetype \"text\".","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0497"},{"Reference":"CVE-2000-0498","Description":"The server is case sensitive, so filetype handlers treat .jsp and .JSP as different extensions. JSP source code may be read because .JSP defaults to the filetype \"text\".","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0498"},{"Reference":"CVE-2001-0766","Description":"A URL that contains some characters whose case is not matched by the server's filters may bypass access restrictions because the case-insensitive file system will then handle the request after it bypasses the case sensitive filter.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0766"},{"Reference":"CVE-2001-0795","Description":"Server allows remote attackers to obtain source code of CGI scripts via URLs that contain MS-DOS conventions such as (1) upper case letters or (2) 8.3 file names.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0795"},{"Reference":"CVE-2001-1238","Description":"Task Manager does not allow local users to end processes with uppercase letters named (1) winlogon.exe, (2) csrss.exe, (3) smss.exe and (4) services.exe via the Process tab which could allow local users to install Trojan horses that cannot be stopped.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1238"},{"Reference":"CVE-2003-0411","Description":"chain: Code was ported from a case-sensitive Unix platform to a case-insensitive Windows platform where filetype handlers treat .jsp and .JSP as different extensions. JSP source code may be read because .JSP defaults to the filetype \"text\".","Link":"https://www.cve.org/CVERecord?id=CVE-2003-0411"},{"Reference":"CVE-2002-0485","Description":"Leads to interpretation error","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0485"},{"Reference":"CVE-1999-0239","Description":"Directories may be listed because lower case web requests are not properly handled by the server.","Link":"https://www.cve.org/CVERecord?id=CVE-1999-0239"},{"Reference":"CVE-2005-0269","Description":"File extension check in forum software only verifies extensions that contain all lowercase letters, which allows remote attackers to upload arbitrary files via file extensions that include uppercase letters.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-0269"},{"Reference":"CVE-2004-1083","Description":"Web server restricts access to files in a case sensitive manner, but the filesystem accesses files in a case insensitive manner, which allows remote attackers to read privileged files using alternate capitalization.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-1083"},{"Reference":"CVE-2002-2119","Description":"Case insensitive passwords lead to search space reduction.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-2119"},{"Reference":"CVE-2004-2214","Description":"HTTP server allows bypass of access restrictions using URIs with mixed case.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-2214"},{"Reference":"CVE-2004-2154","Description":"Mixed upper/lowercase allows bypass of ACLs.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-2154"},{"Reference":"CVE-2005-4509","Description":"Bypass malicious script detection by using tokens that aren't case sensitive.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-4509"},{"Reference":"CVE-2002-1820","Description":"Mixed case problem allows \"admin\" to have \"Admin\" rights (alternate name property).","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1820"},{"Reference":"CVE-2007-3365","Description":"Chain: uppercase file extensions causes web server to return script source code instead of executing the script.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-3365"},{"Reference":"CVE-2021-39155","Description":"Chain: A microservice integration and management platform compares the hostname in the HTTP Host header in a case-sensitive way (CWE-178, CWE-1289), allowing bypass of the authorization policy (CWE-863) using a hostname with mixed case or other variations.","Link":"https://www.cve.org/CVERecord?id=CVE-2021-39155"}],"FunctionalAreas":["File Processing"],"AffectedResources":["File or Directory"],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Case Sensitivity (lowercase, uppercase, mixed case)"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Research Gap","Note":"These are probably under-studied in Windows and Mac environments, where file names are case-insensitive and thus are subject to equivalence manipulations involving case."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Sean Eidemiller","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"added/updated demonstrative examples"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Potential_Mitigations, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Description, Relationships, Observed_Example, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-11-24","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-03-10","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-07-27","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-06-21","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-12-13","ModificationComment":"updated Name"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Observed_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Demonstrative_Examples, Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Affected_Resources, Applicable_Platforms, Functional_Areas, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-06-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Potential_Mitigations, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-06-25","ModificationComment":"updated Demonstrative_Examples, Potential_Mitigations, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Rename","PreviousEntryName":"Case Sensitivity (Lowercase, Uppercase, Mixed Case)","Date":"2008-04-11"},{"Type":"Rename","PreviousEntryName":"Failure to Resolve Case Sensitivity","Date":"2010-12-13"}]}