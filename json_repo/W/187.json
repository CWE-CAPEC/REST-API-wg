{"ID":"187","Name":"Partial String Comparison","Abstraction":"Variant","Structure":"Simple","Status":"Incomplete","Description":"The product performs a comparison that only examines a portion of a factor before determining whether there is a match, such as a substring, leading to resultant weaknesses.","ExtendedDescription":"For example, an attacker might succeed in authentication by providing a small password that matches the associated portion of the larger, correct password.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"1023","ViewID":"1000","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Integrity","Access Control"],"Impact":["Alter Execution Logic","Bypass Protection Mechanism"]}],"PotentialMitigations":[{"Phase":["Testing"],"Description":"Thoroughly test the comparison scheme before deploying code into production. Perform positive testing as well as negative testing."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"This example defines a fixed username and password. The AuthenticateUser() function is intended to accept a username and a password from an untrusted user, and check to ensure that it matches the username and password. If the username and password match, AuthenticateUser() is intended to indicate that authentication succeeded."},{"Nature":"Bad","Language":"C","ExampleCode":"```\n```\n/* Ignore CWE-259 (hard-coded password) and CWE-309 (use of password system for authentication) for this example. */* \n\t\n\tchar *username = \"admin\";\n\tchar *pass = \"password\";\n\t\n\tint AuthenticateUser(char *inUser, char *inPass) {\n\t```\n\t\tif (strncmp(username, inUser, strlen(inUser))) {\n\t\t\tlogEvent(\"Auth failure of username using strlen of inUser\");\n\t\t\treturn(AUTH_FAIL);\n\t\t}\n\t\tif (! strncmp(pass, inPass, strlen(inPass))) {\n\t\t\tlogEvent(\"Auth success of password using strlen of inUser\");\n\t\t\treturn(AUTH_SUCCESS);\n\t\t}\n\t\telse {\n\t\t\tlogEvent(\"Auth fail of password using sizeof\");\n\t\t\treturn(AUTH_FAIL);\n\t\t}\n\t}\n\tint main (int argc, char **argv) {\n\t\t\tint authResult;\n\t\t\tif (argc \u003c 3) {\n\t\t\t\tExitError(\"Usage: Provide a username and password\");\n\t\t\t}\n\t\t\tauthResult = AuthenticateUser(argv[1], argv[2]);\n\t\t\tif (authResult == AUTH_SUCCESS) {\n\t\t\t\tDoAuthenticatedTask(argv[1]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tExitError(\"Authentication failed\");\n\t\t\t}\n\t}\n```"},{"BodyText":"In AuthenticateUser(), the strncmp() call uses the string length of an attacker-provided inPass parameter in order to determine how many characters to check in the password. So, if the attacker only provides a password of length 1, the check will only examine the first byte of the application's password before determining success."},{"BodyText":"As a result, this partial comparison leads to improper authentication (CWE-287)."},{"BodyText":"Any of these passwords would still cause authentication to succeed for the \"admin\" user:"},{"Nature":"Attack","ExampleCode":"```\n\tp\n\tpa\n\tpas\n\tpass\n```"},{"BodyText":"This significantly reduces the search space for an attacker, making brute force attacks more feasible."},{"BodyText":"The same problem also applies to the username, so values such as \"a\" and \"adm\" will succeed for the username."},{"BodyText":"While this demonstrative example may not seem realistic, see the Observed Examples for CVE entries that effectively reflect this same weakness."}]}],"ObservedExamples":[{"Reference":"CVE-2014-6394","Description":"Product does not prevent access to restricted directories due to partial string comparison with a public directory","Link":"https://www.cve.org/CVERecord?id=CVE-2014-6394"},{"Reference":"CVE-2004-1012","Description":"Argument parser of an IMAP server treats a partial command \"body[p\" as if it is \"body.peek\", leading to index error and out-of-bounds corruption.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-1012"},{"Reference":"CVE-2004-0765","Description":"Web browser only checks the hostname portion of a certificate when the hostname portion of the URI is not a fully qualified domain name (FQDN), which allows remote attackers to spoof trusted certificates.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0765"},{"Reference":"CVE-2002-1374","Description":"One-character password by attacker checks only against first character of real password.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1374"},{"Reference":"CVE-2000-0979","Description":"One-character password by attacker checks only against first character of real password.","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0979"}],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Partial Comparison"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Relationship","Note":"This is conceptually similar to other weaknesses, such as insufficient verification and regular expression errors. It is primary to some weaknesses."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Potential_Mitigations, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Description, Relationships, Other_Notes, Taxonomy_Mappings, Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-12-28","ModificationComment":"updated Demonstrative_Examples, Observed_Examples, Other_Notes, Relationship_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences, Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-27","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2018-03-27","ModificationComment":"updated Name, Observed_Examples, Relationships, Type"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Rename","PreviousEntryName":"Partial Comparison","Date":"2018-03-27"}]}