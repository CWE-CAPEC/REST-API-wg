{"ID":"321","Name":"Use of Hard-coded Cryptographic Key","Abstraction":"Variant","Structure":"Simple","Status":"Draft","Diagram":"/data/images/CWE-321-Diagram.png","Description":"The product uses a hard-coded, unchangeable cryptographic key.","LikelihoodOfExploit":"High","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"798","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"798","ViewID":"1305","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"798","ViewID":"1340","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Class":"ICS/OT","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design","Note":"REALIZATION: This weakness is caused during implementation of an architectural security tactic."}],"CommonConsequences":[{"Scope":["Access Control"],"Impact":["Bypass Protection Mechanism","Gain Privileges or Assume Identity","Read Application Data"],"Note":"If hard-coded cryptographic keys are used, it is almost certain that malicious users will gain access through the account in question. The use of a hard-coded cryptographic key significantly increases the possibility that encrypted data may be recovered."}],"DetectionMethods":[{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)","Effectiveness":"High"}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Prevention schemes mirror that of hard-coded password storage."}],"DemonstrativeExamples":[{"ID":"DX-92","Entries":[{"IntroText":"The following code examples attempt to verify a password using a hard-coded cryptographic key."},{"Nature":"Bad","Language":"C","ExampleCode":"```\n\tint VerifyAdmin(char *password) {\n\t\t\tif (strcmp(password,\"68af404b513073584c4b6f22b6c63e6b\")) {\n\t\t\t\t\tprintf(\"Incorrect Password!\\n\");\n\t\t\t\t\treturn(0);\n\t\t\t}\n\t\t\tprintf(\"Entering Diagnostic Mode...\\n\");\n\t\t\treturn(1);\n\t}\n```"},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tpublic boolean VerifyAdmin(String password) {\n\t\tif (password.equals(\"68af404b513073584c4b6f22b6c63e6b\")) {\n\t\t\tSystem.out.println(\"Entering Diagnostic Mode...\");\n\t\t\treturn true;\n\t\t}\n\t\tSystem.out.println(\"Incorrect Password!\");\n\t\treturn false;\n```"},{"Nature":"Bad","Language":"C#","ExampleCode":"```\n\tint VerifyAdmin(String password) {\n\t\tif (password.Equals(\"68af404b513073584c4b6f22b6c63e6b\")) {\n\t\t\tConsole.WriteLine(\"Entering Diagnostic Mode...\");\n\t\t\treturn(1);\n\t\t}\n\t\tConsole.WriteLine(\"Incorrect Password!\");\n\t\treturn(0);\n\t}\n```"},{"BodyText":"The cryptographic key is within a hard-coded string value that is compared to the password. It is likely that an attacker will be able to read the key and compromise the system."}]},{"ID":"DX-153","Entries":[{"IntroText":"In 2022, the OT:ICEFALL study examined products by 10 different Operational Technology (OT) vendors. The researchers reported 56 vulnerabilities and said that the products were \"insecure by design\" [REF-1283]. If exploited, these vulnerabilities often allowed adversaries to change how the products operated, ranging from denial of service to changing the code that the products executed. Since these products were often used in industries such as power, electrical, water, and others, there could even be safety implications."},{"BodyText":"Multiple vendors used hard-coded keys for critical functionality in their OT products."}]}],"ObservedExamples":[{"Reference":"CVE-2022-29960","Description":"Engineering Workstation uses hard-coded cryptographic keys that could allow for unathorized filesystem access and privilege escalation","Link":"https://www.cve.org/CVERecord?id=CVE-2022-29960"},{"Reference":"CVE-2022-30271","Description":"Remote Terminal Unit (RTU) uses a hard-coded SSH private key that is likely to be used by default.","Link":"https://www.cve.org/CVERecord?id=CVE-2022-30271"},{"Reference":"CVE-2020-10884","Description":"WiFi router service has a hard-coded encryption key, allowing root access","Link":"https://www.cve.org/CVERecord?id=CVE-2020-10884"},{"Reference":"CVE-2014-2198","Description":"Communications / collaboration product has a hardcoded SSH private key, allowing access to root account","Link":"https://www.cve.org/CVERecord?id=CVE-2014-2198"}],"TaxonomyMappings":[{"TaxonomyName":"CLASP","EntryName":"Use of hard-coded cryptographic key"},{"TaxonomyName":"OWASP Top Ten 2007","EntryID":"A8","EntryName":"Insecure Cryptographic Storage","MappingFit":"CWE More Specific"},{"TaxonomyName":"OWASP Top Ten 2007","EntryID":"A9","EntryName":"Insecure Communications","MappingFit":"CWE More Specific"},{"TaxonomyName":"OWASP Top Ten 2004","EntryID":"A8","EntryName":"Insecure Storage","MappingFit":"CWE More Specific"},{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP33","EntryName":"Hardcoded sensitive data"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 2-4","EntryName":"Req SP.03.10 RE(1)"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 2-4","EntryName":"Req SP.03.10 RE(3)"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 3-3","EntryName":"Req SR 1.5"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 3-3","EntryName":"Req SR 4.3"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-1","EntryName":"Req SD-1"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-2","EntryName":"Req SR 4.3"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-2","EntryName":"Req CR 7.3"}],"References":[{"ExternalReferenceID":"REF-18","Authors":["Secure Software, Inc."],"Title":"The CLASP Application Security Process","PublicationYear":"2005","URL":"https://cwe.mitre.org/documents/sources/TheCLASPApplicationSecurityProcess.pdf","URLDate":"2024-11-17"},{"ExternalReferenceID":"REF-1283","Authors":["Forescout Vedere Labs"],"Title":"OT:ICEFALL: The legacy of \"insecure by design\" and its implications for certifications and risk management","PublicationYear":"2022","PublicationMonth":"06","PublicationDay":"20","URL":"https://www.forescout.com/resources/ot-icefall-report/"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Other","Note":"The main difference between the use of hard-coded passwords and the use of hard-coded cryptographic keys is the false sense of security that the former conveys. Many people believe that simply hashing a hard-coded password before storage will protect the information from malicious users. However, many hashes are reversible (or at least vulnerable to brute force attacks) -- and further, many authentication protocols simply request the hash itself, making it no better than a password."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"CLASP","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationOrganization":"Veracode","ModificationDate":"2008-08-15","ModificationComment":"Suggested OWASP Top Ten 2004 mapping"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Common_Consequences, Relationships, Other_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-05-27","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-02-16","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-09-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-12-13","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Demonstrative_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Demonstrative_Examples, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Demonstrative_Examples, Modes_of_Introduction, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated References, Relationships, Type"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-08-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-12-10","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Demonstrative_Examples, Observed_Examples, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Applicable_Platforms, Maintenance_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Detection_Factors, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-04-03","ModificationComment":"updated Common_Consequences, Description, Diagram","ModificationVersion":"4.17","ModificationReleaseDate":"2025-04-03"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-12-11","ModificationComment":"updated Maintenance_Notes, Relationships, Weakness_Ordinalities","ModificationVersion":"4.19","ModificationReleaseDate":"2025-12-11"},{"Type":"Contribution","ContributionName":"\"Mapping CWE to 62443\" Sub-Working Group","ContributionOrganization":"CWE-CAPEC ICS/OT SIG","ContributionDate":"2023-01-24","ContributionComment":"Suggested mappings to ISA/IEC 62443.","ContributionType":"Content","ContributionVersion":"4.10","ContributionReleaseDate":"2023-01-31"},{"Type":"Contribution","ContributionName":"\"Mapping CWE to 62443\" Sub-Working Group","ContributionOrganization":"CWE-CAPEC ICS/OT SIG","ContributionDate":"2023-04-25","ContributionComment":"Suggested mappings to ISA/IEC 62443.","ContributionType":"Content"}]}