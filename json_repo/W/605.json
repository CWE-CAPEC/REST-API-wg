{"ID":"605","Name":"Multiple Binds to the Same Port","Abstraction":"Variant","Structure":"Simple","Status":"Draft","Description":"When multiple sockets are allowed to bind to the same port, other services on that port may be stolen or spoofed.","ExtendedDescription":"On most systems, a combination of setting the SO_REUSEADDR socket option, and a call to bind() allows any process to bind to a port to which a previous process has bound with INADDR_ANY. This allows a user to bind to the specific address of a server bound to INADDR_ANY on an unprivileged port, and steal its UDP packets/TCP connection.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"675","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"666","ViewID":"1000"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"},{"Phase":"Operation"}],"CommonConsequences":[{"Scope":["Confidentiality","Integrity"],"Impact":["Read Application Data"],"Note":"Packets from a variety of network services may be stolen or the services spoofed."}],"PotentialMitigations":[{"Phase":["Policy"],"Description":"Restrict server socket address to known local addresses."}],"DemonstrativeExamples":[{"ID":"DX-184","Entries":[{"IntroText":"This code binds a server socket to port 21, allowing the server to listen for traffic on that port."},{"Nature":"Bad","Language":"C","ExampleCode":"```\n\tvoid bind_socket(void) {\n\t\t\tint server_sockfd;\n\t\t\tint server_len;\n\t\t\tstruct sockaddr_in server_address;\n```\n/*unlink the socket if already bound to avoid an error when bind() is called*/* \n\t\t\t\n\t\t\tunlink(\"server_socket\");\n\t\t\tserver_sockfd = socket(AF_INET, SOCK_STREAM, 0);\n\t\t\t\n\t\t\tserver_address.sin_family = AF_INET;\n\t\t\tserver_address.sin_port = 21;\n\t\t\tserver_address.sin_addr.s_addr = htonl(INADDR_ANY);\n\t\t\tserver_len = sizeof(struct sockaddr_in);\n\t\t\t\n\t\t\tbind(server_sockfd, (struct sockaddr *) \u0026s1, server_len);}"},{"BodyText":"This code may result in two servers binding a socket to same port, thus receiving each other's traffic. This could be used by an attacker to steal packets meant for another process, such as a secure FTP server."}]}],"TaxonomyMappings":[{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP32","EntryName":"Multiple binds to the same port"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"Anonymous Tool Vendor (under NDA)","SubmissionDate":"2007-05-07","SubmissionVersion":"Draft 6","SubmissionReleaseDate":"2007-05-07"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Common_Consequences, Relationships, Other_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-05-27","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-10-29","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences, Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-27","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-06-23","ModificationComment":"updated Enabling_Factors_for_Exploitation, Other_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Description, Enabling_Factors_for_Exploitation, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-10-26","ModificationComment":"updated Demonstrative_Examples, Type"},{"Type":"Rename","PreviousEntryName":"Multiple Binds to Same Port","Date":"2008-04-11"}]}