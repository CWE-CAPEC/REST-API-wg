{"ID":"637","Name":"Unnecessary Complexity in Protection Mechanism (Not Using 'Economy of Mechanism')","Abstraction":"Class","Structure":"Simple","Status":"Draft","Description":"The product uses a more complex mechanism than necessary, which could lead to resultant weaknesses when the mechanism is not correctly understood, modeled, configured, implemented, or used.","ExtendedDescription":"Security mechanisms should be as simple as possible. Complex security mechanisms may engender partial implementations and compatibility problems, with resulting mismatches in assumptions and implemented security. A corollary of this principle is that data specifications should be as simple as possible, because complex data specifications result in complex validation code. Complex tasks and systems may also need to be guarded by complex security checks, so simple systems should be preferred.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"657","ViewID":"1000","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"AlternateTerms":[{"Term":"Unnecessary Complexity"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design"},{"Phase":"Implementation"},{"Phase":"Operation"}],"CommonConsequences":[{"Scope":["Other"],"Impact":["Other"]}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Avoid complex security mechanisms when simpler ones would meet requirements. Avoid complex data models, and unnecessarily complex operations. Adopt architectures that provide guarantees, simplify understanding through elegance and abstraction, and that can be implemented similarly. Modularize, isolate and do not trust complex code, and apply other secure programming principles on these modules (e.g., least privilege) to mitigate vulnerabilities."}],"DemonstrativeExamples":[{"ID":"DX-165","Entries":[{"IntroText":"The IPSEC specification is complex, which resulted in bugs, partial implementations, and incompatibilities between vendors."}]},{"Entries":[{"IntroText":"HTTP Request Smuggling (CWE-444) attacks are feasible because there are not stringent requirements for how illegal or inconsistent HTTP headers should be handled. This can lead to inconsistent implementations in which a proxy or firewall interprets the same data stream as a different set of requests than the end points in that stream."}]}],"ObservedExamples":[{"Reference":"CVE-2007-6067","Description":"Support for complex regular expressions leads to a resultant algorithmic complexity weakness (CWE-407).","Link":"https://www.cve.org/CVERecord?id=CVE-2007-6067"},{"Reference":"CVE-2007-1552","Description":"Either a filename extension and a Content-Type header could be used to infer the file type, but the developer only checks the Content-Type, enabling unrestricted file upload (CWE-434).","Link":"https://www.cve.org/CVERecord?id=CVE-2007-1552"},{"Reference":"CVE-2007-6479","Description":"In Apache environments, a \"filename.php.gif\" can be redirected to the PHP interpreter instead of being sent as an image/gif directly to the user. Not knowing this, the developer only checks the last extension of a submitted filename, enabling arbitrary code execution.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-6479"},{"Reference":"CVE-2005-2148","Description":"The developer cleanses the $_REQUEST superglobal array, but PHP also populates $_GET, allowing attackers to bypass the protection mechanism and conduct SQL injection attacks against code that uses $_GET.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-2148"}],"References":[{"ExternalReferenceID":"REF-196","Authors":["Jerome H. Saltzer","Michael D. Schroeder"],"Title":"The Protection of Information in Computer Systems","Publication":"Proceedings of the IEEE 63","PublicationYear":"1975","PublicationMonth":"09","URL":"http://web.mit.edu/Saltzer/www/publications/protection/"},{"ExternalReferenceID":"REF-524","Authors":["Sean Barnum","Michael Gegick"],"Title":"Economy of Mechanism","PublicationYear":"2005","PublicationMonth":"09","PublicationDay":"13","URL":"https://web.archive.org/web/20220126060058/https://www.cisa.gov/uscert/bsi/articles/knowledge/principles/economy-of-mechanism","URLDate":"2023-04-07"}],"MappingNotes":{"Usage":"Allowed-with-Review","Rationale":"This CWE entry is a Class, but it does not have Base-level children.","Comments":"This entry is classified in a part of CWE's hierarchy that does not have sufficiently low-level coverage, which might reflect a lack of classification-oriented weakness research in the software security community. Conduct careful root cause analysis to determine the original mistake that led to this weakness. If closer analysis reveals that this weakness is appropriate, then this might be the best available CWE to use for mapping. If no other option is available, then it is acceptable to map to this CWE.","Reasons":["Abstraction","Other"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"Pascal Meunier","SubmissionOrganization":"Purdue University","SubmissionDate":"2008-01-18","SubmissionVersion":"Draft 8","SubmissionReleaseDate":"2008-01-30"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Description, Relationships, Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-01-12","ModificationComment":"updated Description, Name"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-12-13","ModificationComment":"updated Name, Research_Gaps"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Causal_Nature"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-10-26","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-04-03","ModificationComment":"updated Mapping_Notes","ModificationVersion":"4.17","ModificationReleaseDate":"2025-04-03"},{"Type":"Contribution","ContributionName":"David Rothenberg","ContributionDate":"2024-09-13","ContributionComment":"Suggested changes to the mapping notes.","ContributionType":"Feedback","ContributionVersion":"4.17","ContributionReleaseDate":"2025-04-03"},{"Type":"Rename","PreviousEntryName":"Design Principle Violation: Not Using Economy of Mechanism","Date":"2009-01-12"},{"Type":"Rename","PreviousEntryName":"Failure to Use Economy of Mechanism","Date":"2010-12-13"}]}