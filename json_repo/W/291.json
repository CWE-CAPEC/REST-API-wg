{"ID":"291","Name":"Reliance on IP Address for Authentication","Abstraction":"Variant","Structure":"Simple","Status":"Incomplete","Description":"The product uses an IP address for authentication.","ExtendedDescription":"IP addresses can be easily spoofed. Attackers can forge the source IP address of the packets they send, but response packets will return to the forged IP address. To see the response packets, the attacker has to sniff the traffic between the victim machine and the forged IP address. In order to accomplish the required sniffing, attackers typically attempt to locate themselves on the same subnet as the victim machine. Attackers may be able to circumvent this requirement by using source routing, but source routing is disabled across much of the Internet today. In summary, IP address verification can be a useful part of an authentication scheme, but it should not be the single factor required for authentication.","LikelihoodOfExploit":"High","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"290","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"923","ViewID":"1000"}],"WeaknessOrdinalities":[{"Ordinality":"Resultant"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design","Note":"COMMISSION: This weakness refers to an incorrect design related to an architectural security tactic."}],"CommonConsequences":[{"Scope":["Access Control","Non-Repudiation"],"Impact":["Hide Activities","Gain Privileges or Assume Identity"],"Note":"Malicious users can fake authentication information, impersonating any IP address."}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Use other means of identity verification that cannot be simply spoofed. Possibilities include a username/password or certificate."}],"DemonstrativeExamples":[{"ID":"DX-99","Entries":[{"IntroText":"Both of these examples check if a request is from a trusted address before responding to the request."},{"Nature":"Bad","Language":"C","ExampleCode":"```\n\tsd = socket(AF_INET, SOCK_DGRAM, 0);\n\tserv.sin_family = AF_INET;\n\tserv.sin_addr.s_addr = htonl(INADDR_ANY);\n\tservr.sin_port = htons(1008);\n\tbind(sd, (struct sockaddr *) \u0026 serv, sizeof(serv));\n\twhile (1) {\n\t\tmemset(msg, 0x0, MAX_MSG);\n\t\tclilen = sizeof(cli);\n\t\tif (inet_ntoa(cli.sin_addr)==getTrustedAddress()) {\n\t\t\tn = recvfrom(sd, msg, MAX_MSG, 0, (struct sockaddr *) \u0026 cli, \u0026clilen);\n\t\t}\n\t}\n```"},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\twhile(true) {\n\t\t\tDatagramPacket rp=new DatagramPacket(rData,rData.length);\n\t\t\toutSock.receive(rp);\n\t\t\tString in = new String(p.getData(),0, rp.getLength());\n\t\t\tInetAddress clientIPAddress = rp.getAddress();\n\t\t\tint port = rp.getPort();\n\t\t\tif (isTrustedAddress(clientIPAddress) \u0026 secretKey.equals(in)) {\n\t\t\t\tout = secret.getBytes();\n\t\t\t\tDatagramPacket sp =new DatagramPacket(out,out.length, IPAddress, port); outSock.send(sp);\n\t\t\t}\n\t}\n```"},{"BodyText":"The code only verifies the address as stored in the request packet. An attacker can spoof this address, thus impersonating a trusted client."}]}],"ObservedExamples":[{"Reference":"CVE-2022-30319","Description":"S-bus functionality in a home automation product performs access control using an IP allowlist, which can be bypassed by a forged IP address.","Link":"https://www.cve.org/CVERecord?id=CVE-2022-30319"}],"TaxonomyMappings":[{"TaxonomyName":"CLASP","EntryName":"Trusting self-reported IP address"}],"RelatedAttackPatterns":["4"],"References":[{"ExternalReferenceID":"REF-18","Authors":["Secure Software, Inc."],"Title":"The CLASP Application Security Process","PublicationYear":"2005","URL":"https://cwe.mitre.org/documents/sources/TheCLASPApplicationSecurityProcess.pdf","URLDate":"2024-11-17"},{"ExternalReferenceID":"REF-1371","Title":"IP address spoofing","PublicationYear":"2006","PublicationMonth":"04","PublicationDay":"07","Publisher":"Wikipedia","URL":"https://en.wikipedia.org/wiki/IP_address_spoofing","URLDate":"2023-10-21"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CLASP","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Common_Consequences, Relationships, Other_Notes, Taxonomy_Mappings, Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-02-16","ModificationComment":"updated Description, Other_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences, Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Demonstrative_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2013-06-23","ModificationComment":"Changed type from composite to weakness."},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2013-07-17","ModificationComment":"updated Applicable_Platforms, Description, Name, Relationships, Type"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-02-18","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Causal_Nature, Demonstrative_Examples, Modes_of_Introduction, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-10-26","ModificationComment":"updated Observed_Examples, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-04-03","ModificationComment":"updated Relationships","ModificationVersion":"4.17","ModificationReleaseDate":"2025-04-03"},{"Type":"Rename","PreviousEntryName":"Trusting Self-reported IP Address","Date":"2013-07-17"}]}