{"ID":"1300","Name":"Improper Protection of Physical Side Channels","Abstraction":"Base","Structure":"Simple","Status":"Stable","Description":"The device does not contain sufficient protection\n\tmechanisms to prevent physical side channels from exposing\n\tsensitive information due to patterns in physically observable\n\tphenomena such as variations in power consumption,\n\telectromagnetic emissions (EME), or acoustic emissions.","ExtendedDescription":"\n\nAn adversary could monitor and measure physical phenomena to detect patterns and make inferences, even if it is not possible to extract the information in the digital domain.\n\n\nPhysical side channels have been well-studied for decades in the context of breaking implementations of cryptographic algorithms or other attacks against security features. These side channels may be easily observed by an adversary with physical access to the device, or using a tool that is in close proximity. If the adversary can monitor hardware operation and correlate its data processing with power, EME, and acoustic measurements, the adversary might be able to recover of secret keys and data.\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"203","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"203","ViewID":"1194","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"},{"Ordinality":"Resultant"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Operating_System","Class":"Not OS-Specific","Prevalence":"Undetermined"},{"Type":"Architecture","Class":"Not Architecture-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Class":"Not Technology-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Confidentiality"],"Impact":["Read Memory","Read Application Data"]}],"DetectionMethods":[{"Method":"Manual Analysis","Description":"Perform a set of leakage detection tests such as the procedure outlined in the Test Vector Leakage Assessment (TVLA) test requirements for AES [REF-1230]. TVLA is the basis for the ISO standard 17825 [REF-1229]. A separate methodology is provided by [REF-1228]. Note that sole reliance on this method might not yield expected results [REF-1239] [REF-1240].","Effectiveness":"Moderate"},{"Method":"Manual Analysis","Description":"\n\nPost-silicon, perform full side-channel attacks (penetration testing) covering as many known leakage models as possible against test code.\n","Effectiveness":"Moderate"},{"Method":"Manual Analysis","Description":"\n\nPre-silicon - while the aforementioned TVLA methods can be performed post-silicon, models of device power consumption or other physical emanations can be built from information present at various stages of the hardware design process before fabrication. TVLA or known side-channel attacks can be applied to these simulated traces and countermeasures applied before tape-out. Academic research in this field includes [REF-1231] [REF-1232] [REF-1233].\n","Effectiveness":"Moderate"}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Apply blinding or masking techniques to implementations of cryptographic algorithms."},{"Phase":["Implementation"],"Description":"Add shielding or tamper-resistant protections to the device to increase the difficulty of obtaining measurements of the side-channel."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"Consider a device that checks a passcode to unlock the screen."},{"Nature":"Bad","ExampleCode":"As each character of the PIN number is entered, a correct character exhibits one current pulse shape while an incorrect character exhibits a different current pulse shape."},{"BodyText":"PIN numbers used to unlock a cell phone should not exhibit any characteristics about themselves. This creates a side channel. An attacker could monitor the pulses using an oscilloscope or other method. Once the first character is correctly guessed (based on the oscilloscope readings), they can then move to the next character, which is much more efficient than the brute force method of guessing every possible sequence of characters."},{"Nature":"Good","ExampleCode":"Rather than comparing each character to the correct PIN value as it is entered, the device could accumulate the PIN in a register, and do the comparison all at once at the end. Alternatively, the components for the comparison could be modified so that the current pulse shape is the same regardless of the correctness of the entered character."}]},{"Entries":[{"IntroText":"Consider the device vulnerability CVE-2021-3011, which affects certain microcontrollers [REF-1221]. The Google Titan Security Key is used for two-factor authentication using cryptographic algorithms. The device uses an internal secret key for this purpose and exchanges information based on this key for the authentication. If this internal secret key and the encryption algorithm were known to an adversary, the key function could be duplicated, allowing the adversary to masquerade as the legitimate user."},{"Nature":"Bad","ExampleCode":"The local method of extracting the secret key consists of plugging the key into a USB port and using electromagnetic (EM) sniffing tools and computers."},{"Nature":"Good","ExampleCode":"Several solutions could have been considered by the manufacturer. For example, the manufacturer could shield the circuitry in the key or add randomized delays, indirect calculations with random values involved, or randomly ordered calculations to make extraction much more difficult or a combination of these techniques."}]},{"Entries":[{"IntroText":"The code snippet provided here is part of the modular exponentiation module found in the HACK@DAC'21 Openpiton System-on-Chip (SoC), specifically within the RSA peripheral [REF-1368]. Modular exponentiation, denoted as \"a^b mod n,\" is a crucial operation in the RSA public/private key encryption. In RSA encryption, where 'c' represents ciphertext, 'm' stands for a message, and 'd' corresponds to the private key, the decryption process is carried out using this modular exponentiation as follows: m = c^d mod n, where 'n' is the result of multiplying two large prime numbers."},{"Nature":"Bad","Language":"Verilog","ExampleCode":"...\n module mod_exp\n\n```\n\t ...\n\t `UPDATE: begin\n\t\t if (exponent_reg != 'd0) begin\n```\nif (exponent_reg[0])** \n\t\t\t\n\t\t\t```\n```\nresult_reg \u003c= result_next;** \n\t\t\t\t base_reg \u003c= base_next;\n\t\t\t exponent_reg \u003c= exponent_next;\n\t\t\t state \u003c= `UPDATE;\n\t\t\t ...\n\t endmodule"},{"BodyText":"The vulnerable code shows a buggy implementation of binary exponentiation where it updates the result register (result_reg) only when the corresponding exponent bit (exponent_reg[0]) is set to 1. However, when this exponent bit is 0, the output register is not updated. It's important to note that this implementation introduces a physical power side-channel vulnerability within the RSA core. This vulnerability could expose the private exponent to a determined physical attacker. Such exposure of the private exponent could lead to a complete compromise of the private key."},{"BodyText":"To address mitigation requirements, the developer can develop the module by minimizing dependency on conditions, particularly those reliant on secret keys. In situations where branching is unavoidable, developers can implement masking mechanisms to obfuscate the power consumption patterns exhibited by the module (see good code example). Additionally, certain algorithms, such as the Karatsuba algorithm, can be implemented as illustrative examples of side-channel resistant algorithms, as they necessitate only a limited number of branch conditions [REF-1369]."},{"Nature":"Good","Language":"Verilog","ExampleCode":"...\n module mod_exp\n\n```\n\t ...\n\t `UPDATE: begin\n\t\t if (exponent_reg != 'd0) begin\n```\nif (exponent_reg[0]) begin** \n\t\t\t\n\t\t\t```\n```\nresult_reg \u003c= result_next;** \n\t\t\t\t\n\t\t\t **end else begin** \n\t\t\t\n\t\t\t```\n```\nmask_reg \u003c= result_next;** \n\t\t\t\t\n\t\t\t **end** \n\t\t\t base_reg \u003c= base_next;\n\t\t\t exponent_reg \u003c= exponent_next;\n\t\t\t state \u003c= `UPDATE;\n\t\t\t ...\n\t endmodule"}]}],"ObservedExamples":[{"Reference":"CVE-2022-35888","Description":"Power side-channels leak secret information from processor","Link":"https://www.cve.org/CVERecord?id=CVE-2022-35888"},{"Reference":"CVE-2021-3011","Description":"electromagnetic-wave side-channel in security-related microcontrollers allows extraction of private key","Link":"https://www.cve.org/CVERecord?id=CVE-2021-3011"},{"Reference":"CVE-2019-14353","Description":"Crypto hardware wallet's power consumption relates to total number of pixels illuminated, creating a side channel in the USB connection that allows attackers to determine secrets displayed such as PIN numbers and passwords","Link":"https://www.cve.org/CVERecord?id=CVE-2019-14353"},{"Reference":"CVE-2020-27211","Description":"Chain: microcontroller system-on-chip contains uses a register value stored in flash to set product protection state on the memory bus but does not contain protection against fault injection (CWE-1319), which leads to an incorrect initialization of the memory bus (CWE-1419) leading the product to be in an unprotected state.","Link":"https://www.cve.org/CVERecord?id=CVE-2020-27211"},{"Reference":"CVE-2013-4576","Description":"message encryption software uses certain instruction sequences that allows RSA key extraction using a chosen-ciphertext attack and acoustic cryptanalysis","Link":"https://www.cve.org/CVERecord?id=CVE-2013-4576"},{"Reference":"CVE-2020-28368","Description":"virtualization product allows recovery of AES keys from the guest OS using a side channel attack against a power/energy monitoring interface.","Link":"https://www.cve.org/CVERecord?id=CVE-2020-28368"},{"Reference":"CVE-2019-18673","Description":"power consumption varies based on number of pixels being illuminated in a display, allowing reading of secrets such as the PIN by using the USB interface to measure power consumption","Link":"https://www.cve.org/CVERecord?id=CVE-2019-18673"}],"FunctionalAreas":["Power"],"RelatedAttackPatterns":["189","699"],"References":[{"ExternalReferenceID":"REF-1117","Authors":["Paul Kocher","Joshua Jaffe","Benjamin Jun"],"Title":"Introduction to differential power analysis and related attacks","PublicationYear":"1998","URL":"https://www.rambus.com/wp-content/uploads/2015/08/DPATechInfo.pdf"},{"ExternalReferenceID":"REF-1118","Authors":["Dakshi Agrawal","Bruce Archambeault","Josyula R. Rao","Pankaj Rohatgi"],"Title":"The EM Side-Channel(s)","PublicationYear":"2007","PublicationMonth":"08","PublicationDay":"24","URL":"https://link.springer.com/content/pdf/10.1007/3-540-36400-5_4.pdf","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1119","Authors":["Daniel Genkin","Adi Shamir","Eran Tromer"],"Title":"RSA key extraction via low-bandwidth acoustic cryptanalysis","PublicationYear":"2014","PublicationMonth":"06","PublicationDay":"13","URL":"https://www.iacr.org/archive/crypto2014/86160149/86160149.pdf"},{"ExternalReferenceID":"REF-1120","Authors":["Colin O'Flynn"],"Title":"Power Analysis for Cheapskates","PublicationYear":"2013","PublicationMonth":"01","PublicationDay":"24","URL":"https://media.blackhat.com/eu-13/briefings/OFlynn/bh-eu-13-for-cheapstakes-oflynn-wp.pdf"},{"ExternalReferenceID":"REF-1055","Authors":["Peter Gutmann"],"Title":"Data Remanence in Semiconductor Devices","Publication":"10th USENIX Security Symposium","PublicationYear":"2001","PublicationMonth":"08","URL":"https://www.usenix.org/legacy/events/sec01/full_papers/gutmann/gutmann.pdf"},{"ExternalReferenceID":"REF-1218","Authors":["Graham Cluley"],"Title":"This Black Box Can Brute Force Crack iPhone PIN Passcodes","Publication":"The Mac Security Blog","PublicationYear":"2015","PublicationMonth":"03","PublicationDay":"16","URL":"https://www.intego.com/mac-security-blog/iphone-pin-pass-code/"},{"ExternalReferenceID":"REF-1221","Authors":["Victor Lomne","Thomas Roche"],"Title":"A Side Journey to Titan","PublicationYear":"2021","PublicationMonth":"01","PublicationDay":"07","URL":"https://web.archive.org/web/20210107182441/https://ninjalab.io/wp-content/uploads/2021/01/a_side_journey_to_titan.pdf","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1228","Authors":["Gilbert Goodwill","Benjamin Jun","Josh Jaffe","Pankaj Rohatgi"],"Title":"A testing methodology for side-channel resistance validation","PublicationYear":"2011","URL":"https://csrc.nist.gov/csrc/media/events/non-invasive-attack-testing-workshop/documents/08_goodwill.pdf"},{"ExternalReferenceID":"REF-1229","Authors":["ISO/IEC"],"Title":"ISO/IEC 17825:2016: Testing methods for the mitigation of non-invasive attack classes against cryptographic modules","PublicationYear":"2016","URL":"https://www.iso.org/standard/60612.html"},{"ExternalReferenceID":"REF-1230","Authors":["Cryptography Research Inc."],"Title":"Test Vector Leakage Assessment (TVLA) Derived Test Requirements (DTR) with AES","PublicationYear":"2015","PublicationMonth":"08","URL":"https://www.rambus.com/wp-content/uploads/2015/08/TVLA-DTR-with-AES.pdf"},{"ExternalReferenceID":"REF-1231","Section":"pp. 305-319","Authors":["Danilo Šijaˇci´","Josep Balasch","Bohan Yang","Santosh Ghosh","Ingrid Verbauwhede"],"Title":"Towards efficient and automated side-channel evaluations at design time","Publication":"Journal of Cryptographic Engineering, 10(4)","PublicationYear":"2020","URL":"https://www.esat.kuleuven.be/cosic/publications/article-3204.pdf"},{"ExternalReferenceID":"REF-1232","Section":"pp. 123-130","Authors":["Amit Kumar","Cody Scarborough","Ali Yilmaz","Michael Orshansky"],"Title":"Efficient simulation of EM side-channel attack resilience","Publication":"IEEE/ACM International Conference on Computer-Aided Design (ICCAD)","PublicationYear":"2017","URL":"https://dl.acm.org/doi/pdf/10.5555/3199700.3199717","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1233","Authors":["Yuan Yao","Tuna Tufan","Tarun Kathuria","Baris Ege","Ulkuhan Guler","Patrick Schaumont"],"Title":"Pre-silicon Architecture Correlation Analysis (PACA): Identifying and Mitigating the Source of Side-channel Leakage at Gate-level","PublicationYear":"2021","PublicationMonth":"04","PublicationDay":"21","Publisher":"IACR Cryptology ePrint Archive","URL":"https://eprint.iacr.org/2021/530.pdf"},{"ExternalReferenceID":"REF-1234","Authors":["Elisabeth Oswald","Thomas Popp","Stefan Mangard"],"Title":"Power Analysis Attacks - Revealing the Secrets of Smart Cards","PublicationYear":"2007","URL":"https://link.springer.com/book/10.1007/978-0-387-38162-6","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1235","Authors":["David Oswald","Bastian Richter","Christof Paar"],"Title":"Side-Channel Attacks on the Yubikey 2 One-Time Password Generator","PublicationYear":"2013","PublicationMonth":"06","PublicationDay":"14","URL":"https://www.emsec.ruhr-uni-bochum.de/media/crypto/veroeffentlichungen/2014/02/04/paper_yubikey_sca.pdf"},{"ExternalReferenceID":"REF-1239","Authors":["François-Xavier Standaert"],"Title":"How (not) to Use Welch's T-test in Side-Channel Security Evaluations","PublicationYear":"2017","PublicationMonth":"02","PublicationDay":"15","Publisher":"IACR Cryptology ePrint Archive","URL":"https://eprint.iacr.org/2017/138.pdf"},{"ExternalReferenceID":"REF-1240","Authors":["Carolyn Whitnall","Elisabeth Oswald"],"Title":"A Critical Analysis of ISO 17825 ('Testing methods for the mitigation of non-invasive attack classes against cryptographic modules')","PublicationYear":"2019","PublicationMonth":"09","PublicationDay":"10","Publisher":"IACR Cryptology ePrint Archive","URL":"https://eprint.iacr.org/2019/1013.pdf"},{"ExternalReferenceID":"REF-1285","Authors":["Texas Instruments"],"Title":"Physical Security Attacks Against Silicon Devices","PublicationYear":"2022","PublicationMonth":"01","PublicationDay":"31","URL":"https://www.ti.com/lit/an/swra739/swra739.pdf?ts=1644234570420"},{"ExternalReferenceID":"REF-1286","Section":"1.2 / 5","Authors":["Lennert Wouters","Benedikt Gierlichs","Bart Preneel"],"Title":"On The Susceptibility of Texas Instruments SimpleLink Platform Microcontrollers to Non-Invasive Physical Attacks","PublicationYear":"2022","PublicationMonth":"03","PublicationDay":"14","URL":"https://eprint.iacr.org/2022/328.pdf"},{"ExternalReferenceID":"REF-1368","Title":"mod_exp.v","PublicationYear":"2021","URL":"https://github.com/HACK-EVENT/hackatdac21/blob/b9ecdf6068445d76d6bee692d163fededf7a9d9b/piton/design/chip/tile/ariane/src/rsa/mod_exp.v#L46:L47","URLDate":"2023-07-15"},{"ExternalReferenceID":"REF-1369","Title":"Fix CWE-1300","PublicationYear":"2021","URL":"https://github.com/HACK-EVENT/hackatdac21/blob/37e42f724c14b8e4cc8f6e13462c12a492778219/piton/design/chip/tile/ariane/src/rsa/mod_exp.v#L47:L51","URLDate":"2023-09-29"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"Nicole Fern","SubmissionOrganization":"Tortuga Logic","SubmissionDate":"2020-05-29","SubmissionVersion":"4.2","SubmissionReleaseDate":"2020-08-20"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Functional_Areas, Maintenance_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-07-20","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Demonstrative_Examples, Description, Detection_Factors, Maintenance_Notes, Name, Observed_Examples, References, Relationships, Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-06-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-10-26","ModificationComment":"updated Demonstrative_Examples, Observed_Examples, References"},{"Type":"Contribution","ContributionName":"Anders Nordstrom, Alric Althoff","ContributionOrganization":"Tortuga Logic","ContributionDate":"2021-10-11","ContributionComment":"Provided detection methods, observed examples, and references","ContributionType":"Content"},{"Type":"Contribution","ContributionName":"Nicole Fern","ContributionOrganization":"Riscure","ContributionDate":"2021-10-13","ContributionComment":"Provided detection methods, observed examples, and references","ContributionType":"Content"},{"Type":"Contribution","ContributionName":"Chen Chen, Rahul Kande, Jeyavijayan Rajendran","ContributionOrganization":"Texas A\u0026M University","ContributionDate":"2023-06-21","ContributionComment":"suggested demonstrative example","ContributionType":"Content"},{"Type":"Contribution","ContributionName":"Shaza Zeitouni, Mohamadreza Rostami, Ahmad-Reza Sadeghi","ContributionOrganization":"Technical University of Darmstadt","ContributionDate":"2023-06-21","ContributionComment":"suggested demonstrative example","ContributionType":"Content"},{"Type":"Rename","PreviousEntryName":"Improper Protection Against Physical Side Channels","Date":"2021-10-28"}]}