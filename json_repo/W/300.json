{"ID":"300","Name":"Channel Accessible by Non-Endpoint","Abstraction":"Class","Structure":"Simple","Status":"Draft","Description":"The product does not adequately verify the identity of actors at both ends of a communication channel, or does not adequately ensure the integrity of the channel, in a way that allows the channel to be accessed or influenced by an actor that is not an endpoint.","ExtendedDescription":"In order to establish secure communication between two parties, it is often important to adequately verify the identity of entities at each end of the communication channel. Inadequate or inconsistent verification may result in insufficient or incorrect identification of either communicating entity. This can have negative consequences such as misplaced trust in the entity at the other end of the channel. An attacker can leverage this by interposing between the communicating entities and masquerading as the original entity. In the absence of sufficient verification of identity, such an attacker can eavesdrop and potentially modify the communication between the original entities.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"923","ViewID":"1000","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"},{"Ordinality":"Resultant"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"AlternateTerms":[{"Term":"Adversary-in-the-Middle / AITM"},{"Term":"Attacker-in-the-Middle / AITM"},{"Term":"Man-in-the-Middle / MITM"},{"Term":"Person-in-the-Middle / PITM"},{"Term":"Monkey-in-the-Middle"},{"Term":"Monster-in-the-Middle"},{"Term":"Manipulator-in-the-Middle"},{"Term":"On-path attack"},{"Term":"Interception attack"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design","Note":"REALIZATION: This weakness is caused during implementation of an architectural security tactic."}],"CommonConsequences":[{"Scope":["Confidentiality","Integrity","Access Control"],"Impact":["Read Application Data","Modify Application Data","Gain Privileges or Assume Identity"],"Note":"An attacker could pose as one of the entities and read or possibly modify the communication."}],"DetectionMethods":[{"Method":"Automated Dynamic Analysis","Description":"Some tools can act as proxy servers that allow the tester to intercept packets or messages, inspect them, and modify them before sending them to the destination in order to see if the modified packets are still accepted by the receiving component."},{"Method":"Automated Dynamic Analysis","Description":"Dynamic Application Security Testing (DAST) tools can be used to detect network traffic without encryption and/or verification. The affected protocol may be subject to Adversary-in-the-Middle attacks. Some tools act as proxy servers that allow the tester to inspect and modify packets/messages to see if they are still accepted by the receiving component."},{"Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.) The analysis could identify use of protocols that are subject to Adversary-in-the-Middle attacks.","Effectiveness":"Moderate","EffectivenessNotes":"Encryption and other protection mechanisms may be provided in the environment (e.g., by a load balancer or firewall that is positioned in front of a server), but this cannot be detected by SAST tools."}],"PotentialMitigations":[{"Phase":["Implementation"],"Description":"Always fully authenticate both ends of any communications channel."},{"Phase":["Architecture and Design"],"Description":"Adhere to the principle of complete mediation."},{"Phase":["Implementation"],"Description":"A certificate binds an identity to a cryptographic key to authenticate a communicating party. Often, the certificate takes the encrypted form of the hash of the identity of the subject, the public key, and information such as time of issue or expiration using the issuer's private key. The certificate can be validated by deciphering the certificate with the issuer's public key. See also X.509 certificate signature chains and the PGP certification structure."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"In the Java snippet below, data is sent over an unencrypted channel to a remote server."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tSocket sock;\n\tPrintWriter out;\n\ttry {\n\t\t\tsock = new Socket(REMOTE_HOST, REMOTE_PORT);\n\t\t\tout = new PrintWriter(echoSocket.getOutputStream(), true);\n```\n// Write data to remote host via socket output stream.* \n\t\t\t...}"},{"BodyText":"By eavesdropping on the communication channel or posing as the endpoint, an attacker would be able to read all of the transmitted data."}]}],"ObservedExamples":[{"Reference":"CVE-2014-1266","Description":"Chain: incorrect \"goto\" in Apple SSL product bypasses certificate validation, allowing Adversary-in-the-Middle (AITM) attack (Apple \"goto fail\" bug). CWE-705 (Incorrect Control Flow Scoping) -\u003e CWE-561 (Dead Code) -\u003e CWE-295 (Improper Certificate Validation) -\u003e CWE-393 (Return of Wrong Status Code) -\u003e CWE-300 (Channel Accessible by Non-Endpoint). The code's whitespace indentation did not reflect the actual control flow (CWE-1114) and did not explicitly delimit the block (CWE-483), which could have made it more difficult for human code auditors to detect the vulnerability.","Link":"https://www.cve.org/CVERecord?id=CVE-2014-1266"}],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Man-in-the-middle (MITM)"},{"TaxonomyName":"WASC","EntryID":"32","EntryName":"Routing Detour"},{"TaxonomyName":"The CERT Oracle Secure Coding Standard for Java (2011)","EntryID":"SEC06-J","EntryName":"Do not rely on the default automatic signature verification provided by URLClassLoader and java.util.jar"}],"RelatedAttackPatterns":["466","57","589","590","612","613","615","662","94"],"References":[{"ExternalReferenceID":"REF-244","Authors":["M. Bishop"],"Title":"Computer Security: Art and Science","PublicationYear":"2003","Publisher":"Addison-Wesley"}],"MappingNotes":{"Usage":"Discouraged","Rationale":"CWE-300 is commonly misused for vulnerabilities in which the prerequisites for exploitation require the adversary to be in a privileged \"in-the-middle\" position.","Comments":"Consider root-cause weaknesses that allow adversary-in-the-middle attacks to happen, such as CWEs involving poor integrity protection.","Reasons":["Frequent Misuse"]},"Notes":[{"Type":"Maintenance","Note":"The summary identifies multiple distinct possibilities, suggesting that this is a category that must be broken into more specific weaknesses."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19","SubmissionVersion":"Draft 3","SubmissionReleaseDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Sean Eidemiller","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"added/updated demonstrative examples"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Description, Maintenance_Notes, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-05-27","ModificationComment":"updated Name"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-02-16","ModificationComment":"updated Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-12-13","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Common_Consequences, Related_Attack_Patterns, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-02-18","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-06-23","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Demonstrative_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Modes_of_Introduction, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-06-20","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Alternate_Terms, Name, Observed_Examples, Related_Attack_Patterns, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-12-10","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Alternate_Terms, Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-07-20","ModificationComment":"updated Alternate_Terms, Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Detection_Factors, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2024-07-16","ModificationComment":"updated Alternate_Terms","ModificationVersion":"4.15","ModificationReleaseDate":"2024-07-16"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-09-09","ModificationComment":"updated Alternate_Terms, Detection_Factors","ModificationVersion":"4.18","ModificationReleaseDate":"2025-09-09"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2025-12-11","ModificationComment":"updated Observed_Examples, Relationships, Weakness_Ordinalities","ModificationVersion":"4.19","ModificationReleaseDate":"2025-12-11"},{"Type":"Contribution","ContributionName":"Renaud Sauvain","ContributionOrganization":"West Pharmaceutical Services","ContributionDate":"2024-09-02","ContributionType":"Feedback","ContributionVersion":"4.18","ContributionReleaseDate":"2025-09-09"},{"Type":"Rename","PreviousEntryName":"Man-in-the-middle (MITM)","Date":"2008-04-11"},{"Type":"Rename","PreviousEntryName":"Channel Accessible by Non-Endpoint (aka 'Man-in-the-Middle')","Date":"2009-05-27"},{"Type":"Rename","PreviousEntryName":"Channel Accessible by Non-Endpoint ('Man-in-the-Middle')","Date":"2020-02-24"}]}