{"ID":"914","Name":"Improper Control of Dynamically-Identified Variables","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The product does not properly restrict reading from or writing to dynamically-identified variables.","ExtendedDescription":"Many languages offer powerful features that allow the programmer to access arbitrary variables that are specified by an input string. While these features can offer significant flexibility and reduce development time, they can be extremely dangerous if attackers can modify unintended variables that have security implications.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"99","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"913","ViewID":"1000"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Integrity"],"Impact":["Modify Application Data"],"Note":"An attacker could modify sensitive data or program variables."},{"Scope":["Integrity"],"Impact":["Execute Unauthorized Code or Commands"]},{"Scope":["Other","Integrity"],"Impact":["Varies by Context","Alter Execution Logic"]}],"PotentialMitigations":[{"Phase":["Implementation"],"Strategy":"Input Validation","Description":"For any externally-influenced input, check the input against an allowlist of internal program variables that are allowed to be modified."},{"Phase":["Implementation","Architecture and Design"],"Strategy":"Refactoring","Description":"Refactor the code so that internal program variables do not need to be dynamically identified."}],"DemonstrativeExamples":[{"ID":"DX-107","Entries":[{"IntroText":"This code uses the credentials sent in a POST request to login a user."},{"Nature":"Bad","Language":"PHP","ExampleCode":"```\n```\n//Log user in, and set $isAdmin to true if user is an administrator* \n\t\n\tfunction login($user,$pass){\n\t```\n\t\t$query = buildQuery($user,$pass);\n\t\tmysql_query($query);\n\t\tif(getUserRole($user) == \"Admin\"){\n\t\t\t$isAdmin = true;\n\t\t}\n\t}\n\t$isAdmin = false;\n\textract($_POST);\n\tlogin(mysql_real_escape_string($user),mysql_real_escape_string($pass));\n```"},{"BodyText":"The call to extract() will overwrite the existing values of any variables defined previously, in this case $isAdmin. An attacker can send a POST request with an unexpected third value \"isAdmin\" equal to \"true\", thus gaining Admin privileges."}]}],"ObservedExamples":[{"Reference":"CVE-2006-7135","Description":"extract issue enables file inclusion","Link":"https://www.cve.org/CVERecord?id=CVE-2006-7135"},{"Reference":"CVE-2006-7079","Description":"extract used for register_globals compatibility layer, enables path traversal","Link":"https://www.cve.org/CVERecord?id=CVE-2006-7079"},{"Reference":"CVE-2007-0649","Description":"extract() buried in include files makes post-disclosure analysis confusing; original report had seemed incorrect.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-0649"},{"Reference":"CVE-2006-6661","Description":"extract() enables static code injection","Link":"https://www.cve.org/CVERecord?id=CVE-2006-6661"},{"Reference":"CVE-2006-2828","Description":"import_request_variables() buried in include files makes post-disclosure analysis confusing","Link":"https://www.cve.org/CVERecord?id=CVE-2006-2828"},{"Reference":"CVE-2009-0422","Description":"Chain: Dynamic variable evaluation allows resultant remote file inclusion and path traversal.","Link":"https://www.cve.org/CVERecord?id=CVE-2009-0422"},{"Reference":"CVE-2007-2431","Description":"Chain: dynamic variable evaluation in PHP program used to modify critical, unexpected $_SERVER variable for resultant XSS.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-2431"},{"Reference":"CVE-2006-4904","Description":"Chain: dynamic variable evaluation in PHP program used to conduct remote file inclusion.","Link":"https://www.cve.org/CVERecord?id=CVE-2006-4904"},{"Reference":"CVE-2006-4019","Description":"Dynamic variable evaluation in mail program allows reading and modifying attachments and preferences of other users.","Link":"https://www.cve.org/CVERecord?id=CVE-2006-4019"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2013-01-26"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-01-19","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-06-25","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}