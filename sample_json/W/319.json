{"ID":"319","Name":"Cleartext Transmission of Sensitive Information","Abstraction":"Base","Structure":"Simple","Status":"Draft","Description":"The product transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.","ExtendedDescription":"\n\nMany communication channels can be \"sniffed\" (monitored) by adversaries during data transmission. For example, in networking, packets can traverse many intermediary nodes from the source to the destination, whether across the internet, an internal network, the cloud, etc. Some actors might have privileged access to a network interface or any link along the channel, such as a router, but they might not be authorized to collect the underlying data. As a result, network traffic could be sniffed by adversaries, spilling security-critical data.\n\n\nApplicable communication channels are not limited to software products. Applicable channels include hardware-specific technologies such as internal hardware networks and external debug channels, supporting remote JTAG debugging. When mitigations are not applied to combat adversaries within the product's threat model, this weakness significantly lowers the difficulty of exploitation by such adversaries.\n\n\nWhen full communications are recorded or logged, such as with a packet dump, an adversary could attempt to obtain the dump long after the transmission has occurred and try to \"sniff\" the cleartext from the recorded communications in the dump itself. Even if the information is encoded in a way that is not human-readable, certain techniques could determine which encoding is being used, then decode the information. \n","LikelihoodOfExploit":"High","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"311","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"311","ViewID":"1003","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Class":"Cloud Computing","Prevalence":"Undetermined"},{"Type":"Technology","Class":"Mobile","Prevalence":"Undetermined"},{"Type":"Technology","Class":"ICS/OT","Prevalence":"Often"},{"Type":"Technology","Class":"System on Chip","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Test/Debug Hardware","Prevalence":"Often"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design","Note":"OMISSION: This weakness is caused by missing a security tactic during the architecture and design phase."},{"Phase":"Architecture and Design","Note":"For hardware, this may be introduced when design does not plan for an attacker having physical access while a legitimate user is remotely operating the device."},{"Phase":"Operation"},{"Phase":"System Configuration"}],"CommonConsequences":[{"Scope":["Integrity","Confidentiality"],"Impact":["Read Application Data","Modify Files or Directories"],"Note":"Anyone can read the information by gaining access to the channel being used for communication."}],"DetectionMethods":[{"DetectionMethodID":"DM-11","Method":"Black Box","Description":"\n\nUse monitoring tools that examine the software's process as it interacts with the operating system and the network. This technique is useful in cases when source code is unavailable, if the software was not developed by you, or if you want to verify that the build phase did not introduce any new weaknesses. Examples include debuggers that directly attach to the running process; system-call tracing utilities such as truss (Solaris) and strace (Linux); system activity monitors such as FileMon, RegMon, Process Monitor, and other Sysinternals utilities (Windows); and sniffers and protocol analyzers that monitor network traffic.\n\n\nAttach the monitor to the process, trigger the feature that sends the data, and look for the presence or absence of common cryptographic functions in the call tree. Monitor the network and determine if the data packets contain readable commands. Tools exist for detecting if certain encodings are in use. If the traffic contains high entropy, this might indicate the usage of encryption.\n"},{"DetectionMethodID":"DM-14","Method":"Automated Static Analysis","Description":"Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)","Effectiveness":"High"}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Before transmitting, encrypt the data using reliable, confidentiality-protecting cryptographic protocols."},{"Phase":["Implementation"],"Description":"When using web applications with SSL, use SSL for the entire session from login to logout, not just for the initial login page."},{"Phase":["Implementation"],"Description":"When designing hardware platforms, ensure that approved encryption algorithms (such as those recommended by NIST) protect paths from security critical data to trusted user applications."},{"Phase":["Testing"],"Description":"Use tools and techniques that require manual (human) analysis, such as penetration testing, threat modeling, and interactive tools that allow the tester to record and modify an active session. These may be more effective than strictly automated techniques. This is especially the case with weaknesses that are related to design and business rules."},{"Phase":["Operation"],"Description":"Configure servers to use encrypted channels for communication, which may include SSL or other secure protocols."}],"DemonstrativeExamples":[{"ID":"DX-42","Entries":[{"IntroText":"The following code attempts to establish a connection to a site to communicate sensitive information."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\ttry {\n\t\tURL u = new URL(\"http://www.secret.example.org/\");\n\t\tHttpURLConnection hu = (HttpURLConnection) u.openConnection();\n\t\thu.setRequestMethod(\"PUT\");\n\t\thu.connect();\n\t\tOutputStream os = hu.getOutputStream();\n\t\thu.disconnect();\n\t}\n\tcatch (IOException e) {\n```\n//...* \n\t\t}"},{"BodyText":"Though a connection is successfully made, the connection is unencrypted and it is possible that all sensitive data sent to or received from the server will be read by unintended actors."}]},{"ID":"DX-153","Entries":[{"IntroText":"In 2022, the OT:ICEFALL study examined products by 10 different Operational Technology (OT) vendors. The researchers reported 56 vulnerabilities and said that the products were \"insecure by design\" [REF-1283]. If exploited, these vulnerabilities often allowed adversaries to change how the products operated, ranging from denial of service to changing the code that the products executed. Since these products were often used in industries such as power, electrical, water, and others, there could even be safety implications."},{"BodyText":"Multiple vendors used cleartext transmission of sensitive information in their OT products."}]},{"Entries":[{"IntroText":"A TAP accessible register is read/written by a JTAG based tool, for internal use by authorized users. However, an adversary can connect a probing device and collect the values from the unencrypted channel connecting the JTAG interface to the authorized user, if no additional protections are employed."}]},{"Entries":[{"IntroText":"The following Azure CLI command lists the properties of a particular storage account:"},{"Nature":"Informative","Language":"Shell","ExampleCode":"```\n\taz storage account show -g {ResourceGroupName} -n {StorageAccountName}\n```"},{"BodyText":"The JSON result might be:"},{"Nature":"Bad","Language":"JSON","ExampleCode":"```\n\t {\n\t\t \"name\": \"{StorageAccountName}\",\n\t\t \"enableHttpsTrafficOnly\": false,\n\t\t \"type\": \"Microsoft.Storage/storageAccounts\"\n\t } \n```"},{"BodyText":"The enableHttpsTrafficOnly value is set to false, because the default setting for Secure transfer is set to Disabled. This allows cloud storage resources to successfully connect and transfer data without the use of encryption (e.g., HTTP, SMB 2.1, SMB 3.0, etc.)."},{"BodyText":"Azure's storage accounts can be configured to only accept requests from secure connections made over HTTPS. The secure transfer setting can be enabled using Azure's Portal (GUI) or programmatically by setting the enableHttpsTrafficOnly property to True on the storage account, such as:"},{"Nature":"Good","Language":"Shell","ExampleCode":"```\n\taz storage account update -g {ResourceGroupName} -n {StorageAccountName} --https-only true\n```"},{"BodyText":"The change can be confirmed from the result by verifying that the enableHttpsTrafficOnly value is true:"},{"Nature":"Good","Language":"JSON","ExampleCode":"```\n\t {\n\t\t \"name\": \"{StorageAccountName}\",\n\t\t \"enableHttpsTrafficOnly\": true,\n\t\t \"type\": \"Microsoft.Storage/storageAccounts\"\n\t } \n```"},{"BodyText":"Note: to enable secure transfer using Azure's Portal instead of the command line:\n\n\n  - 1. Open the Create storage account pane in the Azure portal.\n\n  - 2. In the Advanced page, select the Enable secure transfer checkbox."}]}],"ObservedExamples":[{"Reference":"CVE-2022-29519","Description":"Programmable Logic Controller (PLC) sends sensitive information in plaintext, including passwords and session tokens.","Link":"https://www.cve.org/CVERecord?id=CVE-2022-29519"},{"Reference":"CVE-2022-30312","Description":"Building Controller uses a protocol that transmits authentication credentials in plaintext.","Link":"https://www.cve.org/CVERecord?id=CVE-2022-30312"},{"Reference":"CVE-2022-31204","Description":"Programmable Logic Controller (PLC) sends password in plaintext.","Link":"https://www.cve.org/CVERecord?id=CVE-2022-31204"},{"Reference":"CVE-2002-1949","Description":"Passwords transmitted in cleartext.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1949"},{"Reference":"CVE-2008-4122","Description":"Chain: Use of HTTPS cookie without \"secure\" flag causes it to be transmitted across unencrypted HTTP.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-4122"},{"Reference":"CVE-2008-3289","Description":"Product sends password hash in cleartext in violation of intended policy.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-3289"},{"Reference":"CVE-2008-4390","Description":"Remote management feature sends sensitive information including passwords in cleartext.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-4390"},{"Reference":"CVE-2007-5626","Description":"Backup routine sends password in cleartext in email.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-5626"},{"Reference":"CVE-2004-1852","Description":"Product transmits Blowfish encryption key in cleartext.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-1852"},{"Reference":"CVE-2008-0374","Description":"Printer sends configuration information, including administrative password, in cleartext.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-0374"},{"Reference":"CVE-2007-4961","Description":"Chain: cleartext transmission of the MD5 hash of password enables attacks against a server that is susceptible to replay (CWE-294).","Link":"https://www.cve.org/CVERecord?id=CVE-2007-4961"},{"Reference":"CVE-2007-4786","Description":"Product sends passwords in cleartext to a log server.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-4786"},{"Reference":"CVE-2005-3140","Description":"Product sends file with cleartext passwords in e-mail message intended for diagnostic purposes.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-3140"}],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Plaintext Transmission of Sensitive Information"},{"TaxonomyName":"The CERT Oracle Secure Coding Standard for Java (2011)","EntryID":"SEC06-J","EntryName":"Do not rely on the default automatic signature verification provided by URLClassLoader and java.util.jar"},{"TaxonomyName":"The CERT Oracle Secure Coding Standard for Java (2011)","EntryID":"SER02-J","EntryName":"Sign then seal sensitive objects before sending them outside a trust boundary"},{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP23","EntryName":"Exposed Data"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 3-3","EntryName":"Req SR 4.1"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-2","EntryName":"Req CR 4.1B"}],"RelatedAttackPatterns":["102","117","383","477","65"],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"References":[{"ExternalReferenceID":"REF-271","Authors":["OWASP"],"Title":"Top 10 2007-Insecure Communications","PublicationYear":"2007","URL":"http://www.owasp.org/index.php/Top_10_2007-A9"},{"ExternalReferenceID":"REF-7","Section":"Chapter 9, \"Protecting Secret Data\" Page 299","Authors":["Michael Howard","David LeBlanc"],"Title":"Writing Secure Code","Edition":"2nd Edition","PublicationYear":"2002","PublicationMonth":"12","PublicationDay":"04","Publisher":"Microsoft Press","URL":"https://www.microsoftpressstore.com/store/writing-secure-code-9780735617223"},{"ExternalReferenceID":"REF-44","Section":"\"Sin 22: Failing to Protect Network Traffic.\" Page 337","Authors":["Michael Howard","David LeBlanc","John Viega"],"Title":"24 Deadly Sins of Software Security","Publication":"McGraw-Hill","PublicationYear":"2010"},{"ExternalReferenceID":"REF-172","Authors":["Chris Wysopal"],"Title":"Mobile App Top 10 List","PublicationYear":"2010","PublicationMonth":"12","PublicationDay":"13","URL":"https://www.veracode.com/blog/2010/12/mobile-app-top-10-list","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1283","Authors":["Forescout Vedere Labs"],"Title":"OT:ICEFALL: The legacy of \"insecure by design\" and its implications for certifications and risk management","PublicationYear":"2022","PublicationMonth":"06","PublicationDay":"20","URL":"https://www.forescout.com/resources/ot-icefall-report/"},{"ExternalReferenceID":"REF-1307","Section":"Sections 3.1 and 3.10","Authors":["Center for Internet Security"],"Title":"CIS Microsoft Azure Foundations Benchmark version 1.5.0","PublicationYear":"2022","PublicationMonth":"08","PublicationDay":"16","URL":"https://www.cisecurity.org/benchmark/azure","URLDate":"2023-01-19"},{"ExternalReferenceID":"REF-1309","Authors":["Microsoft"],"Title":"Require secure transfer to ensure secure connections","PublicationYear":"2022","PublicationMonth":"07","PublicationDay":"24","URL":"https://learn.microsoft.com/en-us/azure/storage/common/storage-require-secure-transfer","URLDate":"2023-01-24"}],"Notes":[{"Type":"Maintenance","Note":"The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the \"Mapping CWE to 62443\" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-01-12","ModificationComment":"updated Common_Consequences, Description, Likelihood_of_Exploit, Name, Observed_Examples, Potential_Mitigations, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-03-10","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-05-27","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-02-16","ModificationComment":"updated References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-04-05","ModificationComment":"updated Applicable_Platforms, Common_Consequences, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-06-21","ModificationComment":"updated Detection_Factors, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-12-13","ModificationComment":"updated Observed_Examples, Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Demonstrative_Examples, References, Related_Attack_Patterns, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2013-02-21","ModificationComment":"updated Applicable_Platforms, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2013-07-17","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-02-18","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-06-23","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-05-03","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Likelihood_of_Exploit, Modes_of_Introduction, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2018-01-23","ModificationComment":"updated Abstraction "},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2018-03-27","ModificationComment":"updated References, Relationships, Type"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-06-20","ModificationComment":"updated Relationships, Type"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Applicable_Platforms, Related_Attack_Patterns, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-06-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Applicable_Platforms, Demonstrative_Examples, Observed_Examples, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Applicable_Platforms, Demonstrative_Examples, Description, Maintenance_Notes, Modes_of_Introduction, Potential_Mitigations, References, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Detection_Factors, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Description, Mapping_Notes, Relationships"},{"Type":"Contribution","ContributionName":"Accellera IP Security Assurance (IPSA) Working Group","ContributionOrganization":"Accellera Systems Initiative","ContributionDate":"2023-01-24","ContributionComment":"Submitted original contents of CWE-1324 and reviewed its integration into this entry.","ContributionType":"Content"},{"Type":"Rename","PreviousEntryName":"Plaintext Transmission of Sensitive Information","Date":"2009-01-12"}]}