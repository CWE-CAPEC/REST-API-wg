{"ID":"62","Name":"UNIX Hard Link","Abstraction":"Variant","Structure":"Simple","Status":"Incomplete","Description":"The product, when opening a file or directory, does not sufficiently account for when the name is associated with a hard link to a target that is outside of the intended control sphere. This could allow an attacker to cause the product to operate on unauthorized files.","ExtendedDescription":"Failure for a system to check for hard links can result in vulnerability to different types of attacks. For example, an attacker can escalate their privileges if a file used by a privileged program is replaced with a hard link to a sensitive file (e.g. /etc/passwd). When the process opens the file, the attacker can assume the privileges of that process.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"59","ViewID":"1000","Ordinal":"Primary"}],"WeaknessOrdinalities":[{"Ordinality":"Resultant"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Operating_System","Class":"Unix","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Confidentiality","Integrity"],"Impact":["Read Files or Directories","Modify Files or Directories"]}],"PotentialMitigations":[{"MitigationID":"MIT-48.1","Phase":["Architecture and Design"],"Strategy":"Separation of Privilege","Description":"\n\nFollow the principle of least privilege when assigning access rights to entities in a software system.\n\n\nDenying access to a file can prevent an attacker from replacing that file with a link to a sensitive file. Ensure good compartmentalization in the system to provide protected areas that can be trusted.\n"}],"ObservedExamples":[{"Reference":"CVE-2001-1494","Description":"Hard link attack, file overwrite; interesting because program checks against soft links","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1494"},{"Reference":"CVE-2002-0793","Description":"Hard link and possibly symbolic link following vulnerabilities in embedded operating system allow local users to overwrite arbitrary files.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0793"},{"Reference":"CVE-2003-0578","Description":"Server creates hard links and unlinks files as root, which allows local users to gain privileges by deleting and overwriting arbitrary files.","Link":"https://www.cve.org/CVERecord?id=CVE-2003-0578"},{"Reference":"CVE-1999-0783","Description":"Operating system allows local users to conduct a denial of service by creating a hard link from a device special file to a file on an NFS file system.","Link":"https://www.cve.org/CVERecord?id=CVE-1999-0783"},{"Reference":"CVE-2004-1603","Description":"Web hosting manager follows hard links, which allows local users to read or modify arbitrary files.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-1603"},{"Reference":"CVE-2004-1901","Description":"Package listing system allows local users to overwrite arbitrary files via a hard link attack on the lockfiles.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-1901"},{"Reference":"CVE-2005-0342","Description":"The Finder in Mac OS X and earlier allows local users to overwrite arbitrary files and gain privileges by creating a hard link from the .DS_Store file to an arbitrary file.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-0342"},{"Reference":"CVE-2005-1111","Description":"Hard link race condition","Link":"https://www.cve.org/CVERecord?id=CVE-2005-1111"},{"Reference":"CVE-2021-21272","Description":"\"Zip Slip\" vulnerability in Go-based Open Container Initiative (OCI) registries product allows writing arbitrary files outside intended directory via symbolic links or hard links in a gzipped tarball.","Link":"https://www.cve.org/CVERecord?id=CVE-2021-21272"},{"Reference":"BUGTRAQ:20030203 ASA-0001","Description":"OpenBSD chpass/chfn/chsh file content leak","Link":"http://www.securityfocus.com/archive/1/309962"}],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"UNIX hard link"},{"TaxonomyName":"CERT C Secure Coding","EntryID":"FIO05-C","EntryName":"Identify files using multiple file attributes"},{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP18","EntryName":"Link in resource name resolution"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"References":[{"ExternalReferenceID":"REF-62","Section":"Chapter 9, \"Hard Links\", Page 518","Authors":["Mark Dowd","John McDonald","Justin Schuh"],"Title":"The Art of Software Security Assessment","Edition":"1st Edition","PublicationYear":"2006","Publisher":"Addison Wesley"}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Applicable_Platforms, Relationships, Taxonomy_Mappings, Weakness_Ordinalities"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-11-24","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-09-13","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Observed_Examples, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Causal_Nature, Observed_Examples, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-04-28","ModificationComment":"updated Research_Gaps"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}