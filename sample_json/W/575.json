{"ID":"575","Name":"EJB Bad Practices: Use of AWT Swing","Abstraction":"Variant","Structure":"Simple","Status":"Draft","Description":"The product violates the Enterprise JavaBeans (EJB) specification by using AWT/Swing.","ExtendedDescription":"The Enterprise JavaBeans specification requires that every bean provider follow a set of programming guidelines designed to ensure that the bean will be portable and behave consistently in any EJB container. In this case, the product violates the following EJB guideline: \"An enterprise bean must not use the AWT functionality to attempt to output information to a display, or to input information from a keyboard.\" The specification justifies this requirement in the following way: \"Most servers do not allow direct interaction between an application program and a keyboard/display attached to the server system.\"","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"695","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Name":"Java","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Other"],"Impact":["Quality Degradation"]}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Do not use AWT/Swing when writing EJBs."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"The following Java example is a simple converter class for converting US dollars to Yen. This converter class demonstrates the improper practice of using a stateless session Enterprise JavaBean that implements an AWT Component and AWT keyboard event listener to retrieve keyboard input from the user for the amount of the US dollars to convert to Yen."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\t@Stateless\n\tpublic class ConverterSessionBean extends Component implements KeyListener, ConverterSessionRemote {\n```\n/* member variables for receiving keyboard input using AWT API */* \n\t\t\t\n\t\t\t...\n\t\t\tprivate StringBuffer enteredText = new StringBuffer();\n\t\t\t\n\t\t\t\n\t\t\t */* conversion rate on US dollars to Yen */* \n\t\t\t\n\t\t\tprivate BigDecimal yenRate = new BigDecimal(\"115.3100\");\n\t\t\t\n\t\t\tpublic ConverterSessionBean() {\n\t\t\t```\n\t\t\t\t\tsuper();\n```\n/* method calls for setting up AWT Component for receiving keyboard input */* \n\t\t\t\t\t\n\t\t\t\t\t...\n\t\t\t\t\taddKeyListener(this);}\n\t\t\t\n\t\t\tpublic BigDecimal dollarToYen(BigDecimal dollars) {\n\t\t\t```\n\t\t\t\tBigDecimal result = dollars.multiply(yenRate);\n\t\t\t\treturn result.setScale(2, BigDecimal.ROUND_DOWN);\n\t\t\t}\n```\n/* member functions for implementing AWT KeyListener interface */* \n\t\t\t\n\t\t\tpublic void keyTyped(KeyEvent event) {\n\t\t\t```\n\t\t\t\t...\n\t\t\t}\n\t\t\tpublic void keyPressed(KeyEvent e) {\n\t\t\t}\n\t\t\tpublic void keyReleased(KeyEvent e) {\n\t\t\t}\n```\n/* member functions for receiving keyboard input and displaying output */* \n\t\t\t\n\t\t\tpublic void paint(Graphics g) {...}\n\t\t\t\n\t\t\t...}"},{"BodyText":"This use of the AWT and Swing APIs within any kind of Enterprise JavaBean not only violates the restriction of the EJB specification against using AWT or Swing within an EJB but also violates the intended use of Enterprise JavaBeans to separate business logic from presentation logic."},{"BodyText":"The Stateless Session Enterprise JavaBean should contain only business logic. Presentation logic should be provided by some other mechanism such as Servlets or Java Server Pages (JSP) as in the following Java/JSP example."},{"Nature":"Good","Language":"Java","ExampleCode":"```\n\t@Stateless\n\tpublic class ConverterSessionBean implements ConverterSessionRemoteInterface {\n```\n/* conversion rate on US dollars to Yen */* \n\t\t\tprivate BigDecimal yenRate = new BigDecimal(\"115.3100\");\n\t\t\t\n\t\t\tpublic ConverterSessionBean() {\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t */* remote method to convert US dollars to Yen */* \n\t\t\t\n\t\t\tpublic BigDecimal dollarToYen(BigDecimal dollars) {\n\t\t\t```\n\t\t\t\tBigDecimal result = dollars.multiply(yenRate);\n\t\t\t\treturn result.setScale(2, BigDecimal.ROUND_DOWN);\n\t\t\t}\n\t}\n```"},{"Nature":"Good","Language":"JSP","ExampleCode":"```\n\t\u003c%@ page import=\"converter.ejb.Converter, java.math.*, javax.naming.*\"%\u003e\n\t\u003c%!\n\t\t\tprivate Converter converter = null;\n\t\t\tpublic void jspInit() {\n\t\t\t\ttry {\n\t\t\t\t\tInitialContext ic = new InitialContext();\n\t\t\t\t\tconverter = (Converter) ic.lookup(Converter.class.getName());\n\t\t\t\t} catch (Exception ex) {\n\t\t\t\t\tSystem.out.println(\"Couldn't create converter bean.\"+ ex.getMessage());\n\t\t\t\t}\n\t\t\t}\n\t\t\tpublic void jspDestroy() {\n\t\t\t\tconverter = null;\n\t\t\t}\n\t%\u003e\n\t\u003chtml\u003e\n\t\t\t\u003chead\u003e\u003ctitle\u003eConverter\u003c/title\u003e\u003c/head\u003e\n\t\t\t\u003cbody bgcolor=\"white\"\u003e\n\t\t\t\t\t\u003ch1\u003eConverter\u003c/h1\u003e\n\t\t\t\t\t\u003chr\u003e\n\t\t\t\t\t\u003cp\u003eEnter an amount to convert:\u003c/p\u003e\n\t\t\t\t\t\u003cform method=\"get\"\u003e\n\t\t\t\t\t\t\u003cinput type=\"text\" name=\"amount\" size=\"25\"\u003e\u003cbr\u003e\n\t\t\t\t\t\t\u003cp\u003e\n\t\t\t\t\t\t\u003cinput type=\"submit\" value=\"Submit\"\u003e\n\t\t\t\t\t\t\u003cinput type=\"reset\" value=\"Reset\"\u003e\n\t\t\t\t\t\u003c/form\u003e\n\t\t\t\t\t\u003c%\n\t\t\t\t\t\tString amount = request.getParameter(\"amount\");\n\t\t\t\t\t\tif ( amount != null \u0026\u0026 amount.length() \u003e 0 ) {\n\t\t\t\t\t\t\tBigDecimal d = new BigDecimal(amount);\n\t\t\t\t\t\t\tBigDecimal yenAmount = converter.dollarToYen(d);\n\t\t\t\t\t%\u003e\n\t\t\t\t\t\u003cp\u003e\n\t\t\t\t\t\u003c%= amount %\u003e dollars are \u003c%= yenAmount %\u003e Yen.\n\t\t\t\t\t\u003cp\u003e\n\t\t\t\t\t\u003c%\n\t\t\t\t\t\t}\n\t\t\t\t\t%\u003e\n\t\t\t\u003c/body\u003e\n\t\u003c/html\u003e\n```"}]}],"TaxonomyMappings":[{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP3","EntryName":"Use of an improper API"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Community","SubmissionDate":"2006-12-15"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Potential_Mitigations, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Relationships, Other_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-10-29","ModificationComment":"updated Description, Other_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-12-28","ModificationComment":"updated Demonstrative_Examples, Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-27","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}