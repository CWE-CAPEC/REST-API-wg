{"ID":"410","Name":"Insufficient Resource Pool","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The product's resource pool is not large enough to handle peak demand, which allows an attacker to prevent others from accessing the resource by using a (relatively) large number of requests for resources.","ExtendedDescription":"Frequently the consequence is a \"flood\" of connection or sessions.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"664","ViewID":"1000","Ordinal":"Primary"},{"Nature":"CanPrecede","CweID":"400","ViewID":"1000"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design"},{"Phase":"Implementation"},{"Phase":"Operation"}],"CommonConsequences":[{"Scope":["Availability","Integrity","Other"],"Impact":["DoS: Crash, Exit, or Restart","Other"],"Note":"Floods often cause a crash or other problem besides denial of the resource itself; these are likely examples of *other* vulnerabilities, not an insufficient resource pool."}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Do not perform resource-intensive transactions for unauthenticated users and/or invalid requests."},{"Phase":["Architecture and Design"],"Description":"Consider implementing a velocity check mechanism which would detect abusive behavior."},{"Phase":["Operation"],"Description":"Consider load balancing as an option to handle heavy loads."},{"Phase":["Implementation"],"Description":"Make sure that resource handles are properly closed when no longer needed."},{"Phase":["Architecture and Design"],"Description":"Identify the system's resource intensive operations and consider protecting them from abuse (e.g. malicious automated script which runs the resources out)."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"In the following snippet from a Tomcat configuration file, a JDBC connection pool is defined with a maximum of 5 simultaneous connections (with a 60 second timeout). In this case, it may be trivial for an attacker to instigate a denial of service (DoS) by using up all of the available connections in the pool."},{"Nature":"Bad","Language":"XML","ExampleCode":"```\n\t\u003cResource name=\"jdbc/exampledb\"\n\tauth=\"Container\"\n\ttype=\"javax.sql.DataSource\"\n\tremoveAbandoned=\"true\"\n\tremoveAbandonedTimeout=\"30\"\n\tmaxActive=\"5\"\n\tmaxIdle=\"5\"\n\tmaxWait=\"60000\"\n\tusername=\"testuser\"\n\tpassword=\"testpass\"\n\tdriverClassName=\"com.mysql.jdbc.Driver\"\n\turl=\"jdbc:mysql://localhost/exampledb\"/\u003e\n```"}]}],"ObservedExamples":[{"Reference":"CVE-1999-1363","Description":"Large number of locks on file exhausts the pool and causes crash.","Link":"https://www.cve.org/CVERecord?id=CVE-1999-1363"},{"Reference":"CVE-2001-1340","Description":"Product supports only one connection and does not disconnect a user who does not provide credentials.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1340"},{"Reference":"CVE-2002-0406","Description":"Large number of connections without providing credentials allows connection exhaustion.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0406"}],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Insufficient Resource Pool"},{"TaxonomyName":"OWASP Top Ten 2004","EntryID":"A9","EntryName":"Denial of Service","MappingFit":"CWE More Specific"},{"TaxonomyName":"The CERT Oracle Secure Coding Standard for Java (2011)","EntryID":"TPS00-J","EntryName":"Use thread pools to enable graceful degradation of service during traffic bursts"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"References":[{"ExternalReferenceID":"REF-7","Section":"Chapter 17, \"Protecting Against Denial of Service Attacks\" Page 517","Authors":["Michael Howard","David LeBlanc"],"Title":"Writing Secure Code","Edition":"2nd Edition","PublicationYear":"2002","PublicationMonth":"12","PublicationDay":"04","Publisher":"Microsoft Press","URL":"https://www.microsoftpressstore.com/store/writing-secure-code-9780735617223"}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Sean Eidemiller","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"added/updated demonstrative examples"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Potential_Mitigations, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Common_Consequences, Relationships, Other_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Description, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-07-27","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-10-29","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-02-16","ModificationComment":"updated References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-06-23","ModificationComment":"updated Other_Notes, Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Functional_Areas, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2018-03-27","ModificationComment":"updated References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}