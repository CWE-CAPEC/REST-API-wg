{"ID":"306","Name":"Missing Authentication for Critical Function","Abstraction":"Base","Structure":"Simple","Status":"Draft","Description":"The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.","ExtendedDescription":"\n\nAs data is migrated to the cloud, if access does not require authentication, it can be easier for attackers to access the data from anywhere on the Internet.\n","LikelihoodOfExploit":"High","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"287","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"287","ViewID":"1003","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Class":"Cloud Computing","Prevalence":"Undetermined"},{"Type":"Technology","Class":"ICS/OT","Prevalence":"Often"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design","Note":"OMISSION: This weakness is caused by missing a security tactic during the architecture and design phase."}],"CommonConsequences":[{"Scope":["Access Control","Other"],"Impact":["Gain Privileges or Assume Identity","Other"],"Note":"Exposing critical functionality essentially provides an attacker with the privilege level of that functionality. The consequences will depend on the associated functionality, but they can range from reading or modifying sensitive data, access to administrative or other privileged functionality, or possibly even execution of arbitrary code."}],"DetectionMethods":[{"DetectionMethodID":"DM-7.2","Method":"Manual Analysis","Description":"\n\nThis weakness can be detected using tools and techniques that require manual (human) analysis, such as penetration testing, threat modeling, and interactive tools that allow the tester to record and modify an active session.\n\n\nSpecifically, manual static analysis is useful for evaluating the correctness of custom authentication mechanisms.\n","EffectivenessNotes":"These may be more effective than strictly automated techniques. This is especially the case with weaknesses that are related to design and business rules."},{"DetectionMethodID":"DM-6.1","Method":"Automated Static Analysis","Description":"\n\nAutomated static analysis is useful for detecting commonly-used idioms for authentication. A tool may be able to analyze related configuration files, such as .htaccess in Apache web servers, or detect the usage of commonly-used authentication libraries.\n\n\nGenerally, automated static analysis tools have difficulty detecting custom authentication schemes. In addition, the software's design may include some functionality that is accessible to any user and does not require an established identity; an automated technique that detects the absence of authentication may report false positives.\n","Effectiveness":"Limited"},{"Method":"Manual Static Analysis - Binary or Bytecode","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tCost effective for partial coverage:\n```\n\n\t\tBinary / Bytecode disassembler - then use manual analysis for vulnerabilities \u0026 anomalies","Effectiveness":"SOAR Partial"},{"Method":"Dynamic Analysis with Automated Results Interpretation","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tCost effective for partial coverage:\n```\n\n\t\tWeb Application Scanner\n\t\tWeb Services Scanner\n\t\tDatabase Scanners","Effectiveness":"SOAR Partial"},{"Method":"Dynamic Analysis with Manual Results Interpretation","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tCost effective for partial coverage:\n```\n\n\t\tHost Application Interface Scanner\n\t\tFuzz Tester\n\t\tFramework-based Fuzzer","Effectiveness":"SOAR Partial"},{"Method":"Manual Static Analysis - Source Code","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tCost effective for partial coverage:\n```\n\n\t\tFocused Manual Spotcheck - Focused manual analysis of source\n\t\tManual Source Code Review (not inspections)","Effectiveness":"SOAR Partial"},{"Method":"Automated Static Analysis - Source Code","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tCost effective for partial coverage:\n```\n\n\t\tSource code Weakness Analyzer\n\t\tContext-configured Source Code Weakness Analyzer","Effectiveness":"SOAR Partial"},{"Method":"Architecture or Design Review","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tHighly cost effective:\n```\n\n\t\tInspection (IEEE 1028 standard) (can apply to requirements, design, source code, etc.)\n\t\tFormal Methods / Correct-By-Construction\n\t```\n\t\tCost effective for partial coverage:\n```\n\n\t\tAttack Modeling","Effectiveness":"High"}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"\n\nDivide the software into anonymous, normal, privileged, and administrative areas. Identify which of these areas require a proven user identity, and use a centralized authentication capability.\n\n\nIdentify all potential communication channels, or other means of interaction with the software, to ensure that all channels are appropriately protected. Developers sometimes perform authentication at the primary channel, but open up a secondary channel that is assumed to be private. For example, a login mechanism may be listening on one network port, but after successful authentication, it may open up a second port where it waits for the connection, but avoids authentication because it assumes that only the authenticated party will connect to the port.\n\n\nIn general, if the software or protocol allows a single session or user state to persist across multiple connections or channels, authentication and appropriate credential management need to be used throughout.\n"},{"MitigationID":"MIT-15","Phase":["Architecture and Design"],"Description":"For any security checks that are performed on the client side, ensure that these checks are duplicated on the server side, in order to avoid CWE-602. Attackers can bypass the client-side checks by modifying values after the checks have been performed, or by changing the client to remove the client-side checks entirely. Then, these modified values would be submitted to the server."},{"Phase":["Architecture and Design"],"Description":"\n\nWhere possible, avoid implementing custom authentication routines and consider using authentication capabilities as provided by the surrounding framework, operating system, or environment. These may make it easier to provide a clear separation between authentication tasks and authorization tasks.\n\n\nIn environments such as the World Wide Web, the line between authentication and authorization is sometimes blurred. If custom authentication routines are required instead of those provided by the server, then these routines must be applied to every single page, since these pages could be requested directly.\n"},{"MitigationID":"MIT-4.5","Phase":["Architecture and Design"],"Strategy":"Libraries or Frameworks","Description":"\n\nUse a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.\n\n\nFor example, consider using libraries with authentication capabilities such as OpenSSL or the ESAPI Authenticator [REF-45].\n"},{"Phase":["Implementation","System Configuration","Operation"],"Description":"When storing data in the cloud (e.g., S3 buckets, Azure blobs, Google Cloud Storage, etc.), use the provider's controls to require strong authentication for users who should be allowed to access the data [REF-1297] [REF-1298] [REF-1302]."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"In the following Java example the method createBankAccount is used to create a BankAccount object for a bank management application."},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tpublic BankAccount createBankAccount(String accountNumber, String accountType,\n\tString accountName, String accountSSN, double balance) {\n\t\t\tBankAccount account = new BankAccount();\n\t\t\taccount.setAccountNumber(accountNumber);\n\t\t\taccount.setAccountType(accountType);\n\t\t\taccount.setAccountOwnerName(accountName);\n\t\t\taccount.setAccountOwnerSSN(accountSSN);\n\t\t\taccount.setBalance(balance);\n\t\t\treturn account;\n\t}\n```"},{"BodyText":"However, there is no authentication mechanism to ensure that the user creating this bank account object has the authority to create new bank accounts. Some authentication mechanisms should be used to verify that the user has the authority to create bank account objects."},{"BodyText":"The following Java code includes a boolean variable and method for authenticating a user. If the user has not been authenticated then the createBankAccount will not create the bank account object."},{"Nature":"Good","Language":"Java","ExampleCode":"```\n\tprivate boolean isUserAuthentic = false;\n```\n// authenticate user,* \n\t\n\t\n\t *// if user is authenticated then set variable to true* \n\t\n\t\n\t *// otherwise set variable to false* \n\tpublic boolean authenticateUser(String username, String password) {\n\t```\n\t\t...\n\t}\n\tpublic BankAccount createNewBankAccount(String accountNumber, String accountType,\n\tString accountName, String accountSSN, double balance) {\n\t\t\tBankAccount account = null;\n\t\t\tif (isUserAuthentic) {\n\t\t\t\taccount = new BankAccount();\n\t\t\t\taccount.setAccountNumber(accountNumber);\n\t\t\t\taccount.setAccountType(accountType);\n\t\t\t\taccount.setAccountOwnerName(accountName);\n\t\t\t\taccount.setAccountOwnerSSN(accountSSN);\n\t\t\t\taccount.setBalance(balance);\n\t\t\t}\n\t\t\treturn account;\n\t}\n```"}]},{"ID":"DX-153","Entries":[{"IntroText":"In 2022, the OT:ICEFALL study examined products by 10 different Operational Technology (OT) vendors. The researchers reported 56 vulnerabilities and said that the products were \"insecure by design\" [REF-1283]. If exploited, these vulnerabilities often allowed adversaries to change how the products operated, ranging from denial of service to changing the code that the products executed. Since these products were often used in industries such as power, electrical, water, and others, there could even be safety implications."},{"BodyText":"Multiple vendors did not use any authentication for critical functionality in their OT products."}]},{"ID":"DX-155","Entries":[{"IntroText":"In 2021, a web site operated by PeopleGIS stored data of US municipalities in Amazon Web Service (AWS) Simple Storage Service (S3) buckets."},{"Nature":"Bad","Language":"Other","ExampleCode":"```\n\tA security researcher found 86 S3 buckets that could be accessed without authentication (CWE-306) and stored data unencrypted (CWE-312). These buckets exposed over 1000 GB of data and 1.6 million files including physical addresses, phone numbers, tax documents, pictures of driver's license IDs, etc. [REF-1296] [REF-1295]\n```"},{"BodyText":"While it was not publicly disclosed how the data was protected after discovery, multiple options could have been considered."},{"Nature":"Good","Language":"Other","ExampleCode":"```\n\tThe sensitive information could have been protected by ensuring that the buckets did not have public read access, e.g., by enabling the s3-account-level-public-access-blocks-periodic rule to Block Public Access. In addition, the data could have been encrypted at rest using the appropriate S3 settings, e.g., by enabling server-side encryption using the s3-bucket-server-side-encryption-enabled setting. Other settings are available to further prevent bucket data from being leaked. [REF-1297]\n```"}]}],"ObservedExamples":[{"Reference":"CVE-2022-29951","Description":"TCP-based protocol in Programmable Logic Controller (PLC) has no authentication.","Link":"https://www.cve.org/CVERecord?id=CVE-2022-29951"},{"Reference":"CVE-2022-29952","Description":"Condition Monitor firmware uses a protocol that does not require authentication.","Link":"https://www.cve.org/CVERecord?id=CVE-2022-29952"},{"Reference":"CVE-2022-30276","Description":"SCADA-based protocol for bridging WAN and LAN traffic has no authentication.","Link":"https://www.cve.org/CVERecord?id=CVE-2022-30276"},{"Reference":"CVE-2022-30313","Description":"Safety Instrumented System uses proprietary TCP protocols with no authentication.","Link":"https://www.cve.org/CVERecord?id=CVE-2022-30313"},{"Reference":"CVE-2022-30317","Description":"Distributed Control System (DCS) uses a protocol that has no authentication.","Link":"https://www.cve.org/CVERecord?id=CVE-2022-30317"},{"Reference":"CVE-2021-21972","Description":"Chain: Cloud computing virtualization platform does not require authentication for upload of a tar format file (CWE-306), then uses .. path traversal sequences (CWE-23) in the file to access unexpected files, as exploited in the wild per CISA KEV.","Link":"https://www.cve.org/CVERecord?id=CVE-2021-21972"},{"Reference":"CVE-2021-37415","Description":"IT management product does not perform authentication for some REST API requests, as exploited in the wild per CISA KEV.","Link":"https://www.cve.org/CVERecord?id=CVE-2021-37415"},{"Reference":"CVE-2020-13927","Description":"Default setting in workflow management product allows all API requests without authentication, as exploited in the wild per CISA KEV.","Link":"https://www.cve.org/CVERecord?id=CVE-2020-13927"},{"Reference":"CVE-2002-1810","Description":"MFV. Access TFTP server without authentication and obtain configuration file with sensitive plaintext information.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1810"},{"Reference":"CVE-2008-6827","Description":"Agent software running at privileges does not authenticate incoming requests over an unprotected channel, allowing a Shatter\" attack.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-6827"},{"Reference":"CVE-2004-0213","Description":"Product enforces restrictions through a GUI but not through privileged APIs.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0213"},{"Reference":"CVE-2020-15483","Description":"monitor device allows access to physical UART debug port without authentication","Link":"https://www.cve.org/CVERecord?id=CVE-2020-15483"},{"Reference":"CVE-2019-9201","Description":"Programmable Logic Controller (PLC) does not have an authentication feature on its communication protocols.","Link":"https://www.cve.org/CVERecord?id=CVE-2019-9201"}],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"No Authentication for Critical Function"},{"TaxonomyName":"Software Fault Patterns","EntryID":"SFP31","EntryName":"Missing authentication"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-2","EntryName":"Req CR 1.1"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-2","EntryName":"Req CR 1.2"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-2","EntryName":"Req CR 2.1"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-1","EntryName":"Req SR-2"},{"TaxonomyName":"ISA/IEC 62443","EntryID":"Part 4-1","EntryName":"Req SVV-3"}],"RelatedAttackPatterns":["12","166","216","36","62"],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"References":[{"ExternalReferenceID":"REF-62","Section":"Chapter 2, \"Common Vulnerabilities of Authentication,\" Page 36","Authors":["Mark Dowd","John McDonald","Justin Schuh"],"Title":"The Art of Software Security Assessment","Edition":"1st Edition","PublicationYear":"2006","Publisher":"Addison Wesley"},{"ExternalReferenceID":"REF-257","Authors":["Frank Kim"],"Title":"Top 25 Series - Rank 19 - Missing Authentication for Critical Function","PublicationYear":"2010","PublicationMonth":"02","PublicationDay":"23","Publisher":"SANS Software Security Institute","URL":"https://www.sans.org/blog/top-25-series-rank-19-missing-authentication-for-critical-function/","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-45","Authors":["OWASP"],"Title":"OWASP Enterprise Security API (ESAPI) Project","URL":"http://www.owasp.org/index.php/ESAPI"},{"ExternalReferenceID":"REF-1283","Authors":["Forescout Vedere Labs"],"Title":"OT:ICEFALL: The legacy of \"insecure by design\" and its implications for certifications and risk management","PublicationYear":"2022","PublicationMonth":"06","PublicationDay":"20","URL":"https://www.forescout.com/resources/ot-icefall-report/"},{"ExternalReferenceID":"REF-1295","Authors":["WizCase"],"Title":"Over 80 US Municipalities' Sensitive Information, Including Resident's Personal Data, Left Vulnerable in Massive Data Breach","PublicationYear":"2021","PublicationMonth":"07","PublicationDay":"20","URL":"https://www.wizcase.com/blog/us-municipality-breach-report/"},{"ExternalReferenceID":"REF-1296","Authors":["Jonathan Greig"],"Title":"1,000 GB of local government data exposed by Massachusetts software company","PublicationYear":"2021","PublicationMonth":"07","PublicationDay":"22","URL":"https://www.zdnet.com/article/1000-gb-of-local-government-data-exposed-by-massachusetts-software-company/"},{"ExternalReferenceID":"REF-1297","Authors":["Amazon"],"Title":"AWS Foundational Security Best Practices controls","PublicationYear":"2022","URL":"https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-controls-reference.html","URLDate":"2023-04-07"},{"ExternalReferenceID":"REF-1298","Authors":["Microsoft"],"Title":"Authentication and authorization in Azure App Service and Azure Functions","PublicationYear":"2021","PublicationMonth":"11","PublicationDay":"23","URL":"https://learn.microsoft.com/en-us/azure/app-service/overview-authentication-authorization","URLDate":"2022-10-11"},{"ExternalReferenceID":"REF-1302","Authors":["Google Cloud"],"Title":"Authentication and authorization use cases","PublicationYear":"2022","PublicationMonth":"10","PublicationDay":"11","URL":"https://cloud.google.com/docs/authentication/use-cases","URLDate":"2022-10-11"}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Relationships, Relationship_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-02-16","ModificationComment":"updated Applicable_Platforms, Common_Consequences, Demonstrative_Examples, Detection_Factors, Likelihood_of_Exploit, Name, Observed_Examples, Potential_Mitigations, References, Related_Attack_Patterns, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-06-21","ModificationComment":"updated Common_Consequences, Potential_Mitigations, References"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-09-13","ModificationComment":"updated Potential_Mitigations, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Potential_Mitigations, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Detection_Factors, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2015-12-07","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Likelihood_of_Exploit, Modes_of_Introduction, References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-01-03","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-06-20","ModificationComment":"updated Related_Attack_Patterns, Type"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-08-20","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-07-20","ModificationComment":"updated Observed_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-10-28","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-06-28","ModificationComment":"updated Observed_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Applicable_Platforms, Demonstrative_Examples, Description, Observed_Examples, Potential_Mitigations, References, Relationship_Notes, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Related_Attack_Patterns, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes, Relationships"},{"Type":"Contribution","ContributionName":"\"Mapping CWE to 62443\" Sub-Working Group","ContributionOrganization":"CWE-CAPEC ICS/OT SIG","ContributionDate":"2023-04-25","ContributionComment":"Suggested mappings to ISA/IEC 62443.","ContributionType":"Content"},{"Type":"Rename","PreviousEntryName":"No Authentication for Critical Function","Date":"2010-02-16"}]}