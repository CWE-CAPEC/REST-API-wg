{"ID":"790","Name":"Improper Filtering of Special Elements","Abstraction":"Class","Structure":"Simple","Status":"Incomplete","Description":"The product receives data from an upstream component, but does not filter or incorrectly filters special elements before sending it to a downstream component.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"138","ViewID":"1000","Ordinal":"Primary"}],"ModesOfIntroduction":[{"Phase":"Implementation","Note":"REALIZATION: This weakness is caused during implementation of an architectural security tactic."}],"CommonConsequences":[{"Scope":["Integrity"],"Impact":["Unexpected State"]}],"DemonstrativeExamples":[{"ID":"DX-2","Entries":[{"IntroText":"The following code takes untrusted input and uses a regular expression to filter \"../\" from the input. It then appends this result to the /home/user/ directory and attempts to read the file in the final resulting path."},{"Nature":"Bad","Language":"Perl","ExampleCode":"```\n\tmy $Username = GetUntrustedInput();\n\t$Username =~ s/\\.\\.\\///;\n\tmy $filename = \"/home/user/\" . $Username;\n\tReadAndSendFile($filename);\n```"},{"BodyText":"Since the regular expression does not have the /g global match modifier, it only removes the first instance of \"../\" it comes across. So an input value such as:"},{"Nature":"Attack","ExampleCode":"```\n\t../../../etc/passwd\n```"},{"BodyText":"will have the first \"../\" stripped, resulting in:"},{"Nature":"Result","ExampleCode":"```\n\t../../etc/passwd\n```"},{"BodyText":"This value is then concatenated with the /home/user/ directory:"},{"Nature":"Result","ExampleCode":"```\n\t/home/user/../../etc/passwd\n```"},{"BodyText":"which causes the /etc/passwd file to be retrieved once the operating system has resolved the ../ sequences in the pathname. This leads to relative path traversal (CWE-23)."}]}],"MappingNotes":{"Usage":"Allowed-with-Review","Rationale":"This CWE entry is a Class and might have Base-level children that would be more appropriate","Comments":"Examine children of this entry to see if there is a better fit","Reasons":["Abstraction"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2009-12-04"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-02-16","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-27","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-01-19","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Modes_of_Introduction, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}