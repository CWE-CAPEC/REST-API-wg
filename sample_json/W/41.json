{"ID":"41","Name":"Improper Resolution of Path Equivalence","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The product is vulnerable to file system contents disclosure through path equivalence. Path equivalence involves the use of special characters in file and directory names. The associated manipulations are intended to generate multiple names for the same object.","ExtendedDescription":"Path equivalence is usually employed in order to circumvent access controls expressed using an incomplete set of file name or file path representations. This is different from path traversal, wherein the manipulations are performed to generate a name for a different object.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"706","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"CommonConsequences":[{"Scope":["Confidentiality","Integrity","Access Control"],"Impact":["Read Files or Directories","Modify Files or Directories","Bypass Protection Mechanism"],"Note":"An attacker may be able to traverse the file system to unintended locations and read or overwrite the contents of unexpected files. If the files are used for a security mechanism than an attacker may be able to bypass the mechanism."}],"DetectionMethods":[{"Method":"Automated Static Analysis - Binary or Bytecode","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tCost effective for partial coverage:\n```\n\n\t\tBytecode Weakness Analysis - including disassembler + source code weakness analysis","Effectiveness":"SOAR Partial"},{"Method":"Manual Static Analysis - Binary or Bytecode","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tCost effective for partial coverage:\n```\n\n\t\tBinary / Bytecode disassembler - then use manual analysis for vulnerabilities \u0026 anomalies","Effectiveness":"SOAR Partial"},{"Method":"Dynamic Analysis with Automated Results Interpretation","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tCost effective for partial coverage:\n```\n\n\t\tWeb Application Scanner\n\t\tWeb Services Scanner\n\t\tDatabase Scanners","Effectiveness":"SOAR Partial"},{"Method":"Dynamic Analysis with Manual Results Interpretation","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tCost effective for partial coverage:\n```\n\n\t\tFuzz Tester\n\t\tFramework-based Fuzzer","Effectiveness":"SOAR Partial"},{"Method":"Manual Static Analysis - Source Code","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tHighly cost effective:\n```\n\n\t\tFocused Manual Spotcheck - Focused manual analysis of source\n\t\tManual Source Code Review (not inspections)","Effectiveness":"High"},{"Method":"Automated Static Analysis - Source Code","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tCost effective for partial coverage:\n```\n\n\t\tSource code Weakness Analyzer\n\t\tContext-configured Source Code Weakness Analyzer","Effectiveness":"SOAR Partial"},{"Method":"Architecture or Design Review","Description":"\n\nAccording to SOAR, the following detection techniques may be useful:\n\n```\n\t\tHighly cost effective:\n```\n\n\t\tFormal Methods / Correct-By-Construction\n\t```\n\t\tCost effective for partial coverage:\n```\n\n\t\tInspection (IEEE 1028 standard) (can apply to requirements, design, source code, etc.)","Effectiveness":"High"}],"PotentialMitigations":[{"MitigationID":"MIT-5","Phase":["Implementation"],"Strategy":"Input Validation","Description":"\n\nAssume all input is malicious. Use an \"accept known good\" input validation strategy, i.e., use a list of acceptable inputs that strictly conform to specifications. Reject any input that does not strictly conform to specifications, or transform it into something that does.\n\n\nWhen performing input validation, consider all potentially relevant properties, including length, type of input, the full range of acceptable values, missing or extra inputs, syntax, consistency across related fields, and conformance to business rules. As an example of business rule logic, \"boat\" may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as \"red\" or \"blue.\"\n\n\nDo not rely exclusively on looking for malicious or malformed inputs. This is likely to miss at least one undesirable input, especially if the code's environment changes. This can give attackers enough room to bypass the intended validation. However, denylists can be useful for detecting potential attacks or determining which inputs are so malformed that they should be rejected outright.\n"},{"MitigationID":"MIT-30","Phase":["Implementation"],"Strategy":"Output Encoding","Description":"Use and specify an output encoding that can be handled by the downstream component that is reading the output. Common encodings include ISO-8859-1, UTF-7, and UTF-8. When an encoding is not specified, a downstream component may choose a different encoding, either by assuming a default encoding or automatically inferring which encoding is being used, which can be erroneous. When the encodings are inconsistent, the downstream component might treat some character or byte sequences as special, even if they are not special in the original encoding. Attackers might then be able to exploit this discrepancy and conduct injection attacks; they even might be able to bypass protection mechanisms that assume the original encoding is also being used by the downstream component."},{"MitigationID":"MIT-20","Phase":["Implementation"],"Strategy":"Input Validation","Description":"Inputs should be decoded and canonicalized to the application's current internal representation before being validated (CWE-180). Make sure that the application does not decode the same input twice (CWE-174). Such errors could be used to bypass allowlist validation schemes by introducing dangerous inputs after they have been checked."}],"ObservedExamples":[{"Reference":"CVE-2000-1114","Description":"Source code disclosure using trailing dot","Link":"https://www.cve.org/CVERecord?id=CVE-2000-1114"},{"Reference":"CVE-2002-1986","Description":"Source code disclosure using trailing dot","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1986"},{"Reference":"CVE-2004-2213","Description":"Source code disclosure using trailing dot or trailing encoding space \"%20\"","Link":"https://www.cve.org/CVERecord?id=CVE-2004-2213"},{"Reference":"CVE-2005-3293","Description":"Source code disclosure using trailing dot","Link":"https://www.cve.org/CVERecord?id=CVE-2005-3293"},{"Reference":"CVE-2004-0061","Description":"Bypass directory access restrictions using trailing dot in URL","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0061"},{"Reference":"CVE-2000-1133","Description":"Bypass directory access restrictions using trailing dot in URL","Link":"https://www.cve.org/CVERecord?id=CVE-2000-1133"},{"Reference":"CVE-2001-1386","Description":"Bypass check for \".lnk\" extension using \".lnk.\"","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1386"},{"Reference":"CVE-2001-0693","Description":"Source disclosure via trailing encoded space \"%20\"","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0693"},{"Reference":"CVE-2001-0778","Description":"Source disclosure via trailing encoded space \"%20\"","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0778"},{"Reference":"CVE-2001-1248","Description":"Source disclosure via trailing encoded space \"%20\"","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1248"},{"Reference":"CVE-2004-0280","Description":"Source disclosure via trailing encoded space \"%20\"","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0280"},{"Reference":"CVE-2005-0622","Description":"Source disclosure via trailing encoded space \"%20\"","Link":"https://www.cve.org/CVERecord?id=CVE-2005-0622"},{"Reference":"CVE-2005-1656","Description":"Source disclosure via trailing encoded space \"%20\"","Link":"https://www.cve.org/CVERecord?id=CVE-2005-1656"},{"Reference":"CVE-2002-1603","Description":"Source disclosure via trailing encoded space \"%20\"","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1603"},{"Reference":"CVE-2001-0054","Description":"Multi-Factor Vulnerability (MVF). directory traversal and other issues in FTP server using Web encodings such as \"%20\"; certain manipulations have unusual side effects.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0054"},{"Reference":"CVE-2002-1451","Description":"Trailing space (\"+\" in query string) leads to source code disclosure.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1451"},{"Reference":"CVE-2000-0293","Description":"Filenames with spaces allow arbitrary file deletion when the product does not properly quote them; some overlap with path traversal.","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0293"},{"Reference":"CVE-2001-1567","Description":"\"+\" characters in query string converted to spaces before sensitive file/extension (internal space), leading to bypass of access restrictions to the file.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1567"},{"Reference":"CVE-2002-0253","Description":"Overlaps infoleak","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0253"},{"Reference":"CVE-2001-0446","Description":"Application server allows remote attackers to read source code for .jsp files by appending a / to the requested URL.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0446"},{"Reference":"CVE-2004-0334","Description":"Bypass Basic Authentication for files using trailing \"/\"","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0334"},{"Reference":"CVE-2001-0893","Description":"Read sensitive files with trailing \"/\"","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0893"},{"Reference":"CVE-2001-0892","Description":"Web server allows remote attackers to view sensitive files under the document root (such as .htpasswd) via a GET request with a trailing /.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0892"},{"Reference":"CVE-2004-1814","Description":"Directory traversal vulnerability in server allows remote attackers to read protected files via .. (dot dot) sequences in an HTTP request.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-1814"},{"Reference":"BID:3518","Description":"Source code disclosure","Link":"http://www.securityfocus.com/bid/3518"},{"Reference":"CVE-2002-1483","Description":"Read files with full pathname using multiple internal slash.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1483"},{"Reference":"CVE-1999-1456","Description":"Server allows remote attackers to read arbitrary files via a GET request with more than one leading / (slash) character in the filename.","Link":"https://www.cve.org/CVERecord?id=CVE-1999-1456"},{"Reference":"CVE-2004-0578","Description":"Server allows remote attackers to read arbitrary files via leading slash (//) characters in a URL request.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0578"},{"Reference":"CVE-2002-0275","Description":"Server allows remote attackers to bypass authentication and read restricted files via an extra / (slash) in the requested URL.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0275"},{"Reference":"CVE-2004-1032","Description":"Product allows local users to delete arbitrary files or create arbitrary empty files via a target filename with a large number of leading slash (/) characters.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-1032"},{"Reference":"CVE-2002-1238","Description":"Server allows remote attackers to bypass access restrictions for files via an HTTP request with a sequence of multiple / (slash) characters such as http://www.example.com///file/.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1238"},{"Reference":"CVE-2004-1878","Description":"Product allows remote attackers to bypass authentication, obtain sensitive information, or gain access via a direct request to admin/user.pl preceded by // (double leading slash).","Link":"https://www.cve.org/CVERecord?id=CVE-2004-1878"},{"Reference":"CVE-2005-1365","Description":"Server allows remote attackers to execute arbitrary commands via a URL with multiple leading \"/\" (slash) characters and \"..\" sequences.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-1365"},{"Reference":"CVE-2000-1050","Description":"Access directory using multiple leading slash.","Link":"https://www.cve.org/CVERecord?id=CVE-2000-1050"},{"Reference":"CVE-2001-1072","Description":"Bypass access restrictions via multiple leading slash, which causes a regular expression to fail.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1072"},{"Reference":"CVE-2004-0235","Description":"Archive extracts to arbitrary files using multiple leading slash in filenames in the archive.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0235"},{"Reference":"CVE-2002-1078","Description":"Directory listings in web server using multiple trailing slash","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1078"},{"Reference":"CVE-2004-0847","Description":"ASP.NET allows remote attackers to bypass authentication for .aspx files in restricted directories via a request containing a (1) \"\\\" (backslash) or (2) \"%5C\" (encoded backslash), aka \"Path Validation Vulnerability.\"","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0847"},{"Reference":"CVE-2000-0004","Description":"Server allows remote attackers to read source code for executable files by inserting a . (dot) into the URL.","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0004"},{"Reference":"CVE-2002-0304","Description":"Server allows remote attackers to read password-protected files via a /./ in the HTTP request.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0304"},{"Reference":"BID:6042","Description":"Input Validation error","Link":"http://www.securityfocus.com/bid/6042"},{"Reference":"CVE-1999-1083","Description":"Possibly (could be a cleansing error)","Link":"https://www.cve.org/CVERecord?id=CVE-1999-1083"},{"Reference":"CVE-2004-0815","Description":"\"/./////etc\" cleansed to \".///etc\" then \"/etc\"","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0815"},{"Reference":"CVE-2002-0112","Description":"Server allows remote attackers to view password protected files via /./ in the URL.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0112"},{"Reference":"CVE-2004-0696","Description":"List directories using desired path and \"*\"","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0696"},{"Reference":"CVE-2002-0433","Description":"List files in web server using \"*.ext\"","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0433"},{"Reference":"CVE-2001-1152","Description":"Proxy allows remote attackers to bypass denylist restrictions and connect to unauthorized web servers by modifying the requested URL, including (1) a // (double slash), (2) a /SUBDIR/.. where the desired file is in the parentdir, (3) a /./, or (4) URL-encoded characters.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-1152"},{"Reference":"CVE-2000-0191","Description":"application check access for restricted URL before canonicalization","Link":"https://www.cve.org/CVERecord?id=CVE-2000-0191"},{"Reference":"CVE-2005-1366","Description":"CGI source disclosure using \"dirname/../cgi-bin\"","Link":"https://www.cve.org/CVERecord?id=CVE-2005-1366"},{"Reference":"CVE-1999-0012","Description":"Multiple web servers allow restriction bypass using 8.3 names instead of long names","Link":"https://www.cve.org/CVERecord?id=CVE-1999-0012"},{"Reference":"CVE-2001-0795","Description":"Source code disclosure using 8.3 file name.","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0795"},{"Reference":"CVE-2005-0471","Description":"Multi-Factor Vulnerability. Product generates temporary filenames using long filenames, which become predictable in 8.3 format.","Link":"https://www.cve.org/CVERecord?id=CVE-2005-0471"}],"AffectedResources":["File or Directory"],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Path Equivalence"},{"TaxonomyName":"CERT C Secure Coding","EntryID":"FIO02-C","EntryName":"Canonicalize path names originating from untrusted sources"}],"RelatedAttackPatterns":["3"],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"Notes":[{"Type":"Relationship","Note":"Some of these manipulations could be effective in path traversal issues, too."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Potential_Mitigations, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Relationships, Other_Notes, Taxonomy_Mappings, Type"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-11-24","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-03-10","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-05-27","ModificationComment":"updated Name"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-07-27","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-03-29","ModificationComment":"updated Other_Notes, Potential_Mitigations, Relationship_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-09-13","ModificationComment":"updated Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Common_Consequences, Observed_Examples, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Detection_Factors, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Affected_Resources, Applicable_Platforms, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-06-20","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Potential_Mitigations, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-06-25","ModificationComment":"updated Observed_Examples, Potential_Mitigations, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Rename","PreviousEntryName":"Path Equivalence","Date":"2008-04-11"},{"Type":"Rename","PreviousEntryName":"Failure to Resolve Path Equivalence","Date":"2009-05-27"}]}