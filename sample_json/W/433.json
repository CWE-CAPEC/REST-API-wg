{"ID":"433","Name":"Unparsed Raw Web Content Delivery","Abstraction":"Variant","Structure":"Simple","Status":"Incomplete","Description":"The product stores raw content or supporting code under the web document root with an extension that is not specifically handled by the server.","ExtendedDescription":"If code is stored in a file with an extension such as \".inc\" or \".pl\", and the web server does not have a handler for that extension, then the server will likely send the contents of the file directly to the requester without the pre-processing that was expected. When that file contains sensitive information such as database credentials, this may allow the attacker to compromise the application or associated components.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"219","ViewID":"1000","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"},{"Phase":"Operation"}],"CommonConsequences":[{"Scope":["Confidentiality"],"Impact":["Read Application Data"]}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Perform a type check before interpreting files."},{"Phase":["Architecture and Design"],"Description":"Do not store sensitive information in files which may be misinterpreted."}],"DemonstrativeExamples":[{"ID":"DX-104","Entries":[{"IntroText":"The following code uses an include file to store database credentials:"},{"BodyText":"database.inc"},{"Nature":"Bad","Language":"PHP","ExampleCode":"```\n\t\u003c?php\n\t$dbName = 'usersDB';\n\t$dbPassword = 'skjdh#67nkjd3$3$';\n\t?\u003e\n```"},{"BodyText":"login.php"},{"Nature":"Bad","Language":"PHP","ExampleCode":"```\n\t\u003c?php\n\tinclude('database.inc');\n\t$db = connectToDB($dbName, $dbPassword);\n\t$db.authenticateUser($username, $password);\n\t?\u003e\n```"},{"BodyText":"If the server does not have an explicit handler set for .inc files it may send the contents of database.inc to an attacker without pre-processing, if the attacker requests the file directly. This will expose the database name and password."}]}],"ObservedExamples":[{"Reference":"CVE-2002-1886","Description":"\".inc\" file stored under web document root and returned unparsed by the server","Link":"https://www.cve.org/CVERecord?id=CVE-2002-1886"},{"Reference":"CVE-2002-2065","Description":"\".inc\" file stored under web document root and returned unparsed by the server","Link":"https://www.cve.org/CVERecord?id=CVE-2002-2065"},{"Reference":"CVE-2005-2029","Description":"\".inc\" file stored under web document root and returned unparsed by the server","Link":"https://www.cve.org/CVERecord?id=CVE-2005-2029"},{"Reference":"CVE-2001-0330","Description":"direct request to .pl file leaves it unparsed","Link":"https://www.cve.org/CVERecord?id=CVE-2001-0330"},{"Reference":"CVE-2002-0614","Description":".inc file","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0614"},{"Reference":"CVE-2004-2353","Description":"unparsed config.conf file","Link":"https://www.cve.org/CVERecord?id=CVE-2004-2353"},{"Reference":"CVE-2007-3365","Description":"Chain: uppercase file extensions causes web server to return script source code instead of executing the script.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-3365"}],"TaxonomyMappings":[{"TaxonomyName":"PLOVER","EntryName":"Unparsed Raw Web Content Delivery"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"References":[{"ExternalReferenceID":"REF-62","Section":"Chapter 3, \"File Handlers\", Page 74","Authors":["Mark Dowd","John McDonald","Justin Schuh"],"Title":"The Art of Software Security Assessment","Edition":"1st Edition","PublicationYear":"2006","Publisher":"Addison Wesley"}],"Notes":[{"Type":"Relationship","Note":"This overlaps direct requests (CWE-425), alternate path (CWE-424), permissions (CWE-275), and sensitive file under web root (CWE-219)."}],"ContentHistory":[{"Type":"Submission","SubmissionName":"PLOVER","SubmissionDate":"2006-07-19"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Potential_Mitigations, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Relationships, Other_Notes, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-10-14","ModificationComment":"updated Description, Other_Notes, Relationship_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-09-27","ModificationComment":"updated Description, Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Demonstrative_Examples, Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Observed_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}