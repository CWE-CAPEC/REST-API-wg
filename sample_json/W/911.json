{"ID":"911","Name":"Improper Update of Reference Count","Abstraction":"Base","Structure":"Simple","Status":"Incomplete","Description":"The product uses a reference count to manage a resource, but it does not update or incorrectly updates the reference count.","ExtendedDescription":"Reference counts can be used when tracking how many objects contain a reference to a particular resource, such as in memory management or garbage collection. When the reference count reaches zero, the resource can be de-allocated or reused because there are no more objects that use it. If the reference count accidentally reaches zero, then the resource might be released too soon, even though it is still in use. If all objects no longer use the resource, but the reference count is not zero, then the resource might not ever be released.","LikelihoodOfExploit":"Medium","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"664","ViewID":"1000","Ordinal":"Primary"},{"Nature":"CanPrecede","CweID":"672","ViewID":"1000"},{"Nature":"CanPrecede","CweID":"772","ViewID":"1000"}],"WeaknessOrdinalities":[{"Ordinality":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Name":"C","Prevalence":"Sometimes"},{"Type":"Language","Name":"C++","Prevalence":"Sometimes"},{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Implementation"}],"ObservedExamples":[{"Reference":"CVE-2002-0574","Description":"chain: reference count is not decremented, leading to memory leak in OS by sending ICMP packets.","Link":"https://www.cve.org/CVERecord?id=CVE-2002-0574"},{"Reference":"CVE-2004-0114","Description":"Reference count for shared memory not decremented when a function fails, potentially allowing unprivileged users to read kernel memory.","Link":"https://www.cve.org/CVERecord?id=CVE-2004-0114"},{"Reference":"CVE-2006-3741","Description":"chain: improper reference count tracking leads to file descriptor consumption","Link":"https://www.cve.org/CVERecord?id=CVE-2006-3741"},{"Reference":"CVE-2007-1383","Description":"chain: integer overflow in reference counter causes the same variable to be destroyed twice.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-1383"},{"Reference":"CVE-2007-1700","Description":"Incorrect reference count calculation leads to improper object destruction and code execution.","Link":"https://www.cve.org/CVERecord?id=CVE-2007-1700"},{"Reference":"CVE-2008-2136","Description":"chain: incorrect update of reference count leads to memory leak.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-2136"},{"Reference":"CVE-2008-2785","Description":"chain/composite: use of incorrect data type for a reference counter allows an overflow of the counter, leading to a free of memory that is still in use.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-2785"},{"Reference":"CVE-2008-5410","Description":"Improper reference counting leads to failure of cryptographic operations.","Link":"https://www.cve.org/CVERecord?id=CVE-2008-5410"},{"Reference":"CVE-2009-1709","Description":"chain: improper reference counting in a garbage collection routine leads to use-after-free","Link":"https://www.cve.org/CVERecord?id=CVE-2009-1709"},{"Reference":"CVE-2009-3553","Description":"chain: reference count not correctly maintained when client disconnects during a large operation, leading to a use-after-free.","Link":"https://www.cve.org/CVERecord?id=CVE-2009-3553"},{"Reference":"CVE-2009-3624","Description":"Reference count not always incremented, leading to crash or code execution.","Link":"https://www.cve.org/CVERecord?id=CVE-2009-3624"},{"Reference":"CVE-2010-0176","Description":"improper reference counting leads to expired pointer dereference.","Link":"https://www.cve.org/CVERecord?id=CVE-2010-0176"},{"Reference":"CVE-2010-0623","Description":"OS kernel increments reference count twice but only decrements once, leading to resource consumption and crash.","Link":"https://www.cve.org/CVERecord?id=CVE-2010-0623"},{"Reference":"CVE-2010-2549","Description":"OS kernel driver allows code execution","Link":"https://www.cve.org/CVERecord?id=CVE-2010-2549"},{"Reference":"CVE-2010-4593","Description":"improper reference counting leads to exhaustion of IP addresses","Link":"https://www.cve.org/CVERecord?id=CVE-2010-4593"},{"Reference":"CVE-2011-0695","Description":"Race condition causes reference counter to be decremented prematurely, leading to the destruction of still-active object and an invalid pointer dereference.","Link":"https://www.cve.org/CVERecord?id=CVE-2011-0695"},{"Reference":"CVE-2012-4787","Description":"improper reference counting leads to use-after-free","Link":"https://www.cve.org/CVERecord?id=CVE-2012-4787"}],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"References":[{"ExternalReferenceID":"REF-884","Authors":["Mateusz \"j00ru\" Jurczyk"],"Title":"Windows Kernel Reference Count Vulnerabilities - Case Study","PublicationYear":"2012","PublicationMonth":"11","URL":"https://j00ru.vexillium.org/slides/2012/zeronights.pdf","URLDate":"2023-04-07"}],"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Content Team","SubmissionOrganization":"MITRE","SubmissionDate":"2012-12-21"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2019-06-20","ModificationComment":"updated Type"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Relationships, Type"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}