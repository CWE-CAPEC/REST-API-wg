{"ID":"309","Name":"Use of Password System for Primary Authentication","Abstraction":"Base","Structure":"Simple","Status":"Draft","Description":"The use of password systems as the primary means of authentication may be subject to several flaws or shortcomings, each reducing the effectiveness of the mechanism.","LikelihoodOfExploit":"High","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"1390","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"654","ViewID":"1000"},{"Nature":"PeerOf","CweID":"308","ViewID":"1000"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"}],"BackgroundDetails":["Password systems are the simplest and most ubiquitous authentication mechanisms. However, they are subject to such well known attacks,and such frequent compromise that their use in the most simple implementation is not practical."],"ModesOfIntroduction":[{"Phase":"Architecture and Design"}],"CommonConsequences":[{"Scope":["Access Control"],"Impact":["Bypass Protection Mechanism","Gain Privileges or Assume Identity"],"Note":"A password authentication mechanism error will almost always result in attackers being authorized as valid users."}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"\n\nIn order to protect password systems from compromise, the following should be noted:\n\n\n  - Passwords should be stored safely to prevent insider attack and to ensure that -- if a system is compromised -- the passwords are not retrievable. Due to password reuse, this information may be useful in the compromise of other systems these users work with. In order to protect these passwords, they should be stored encrypted, in a non-reversible state, such that the original text password cannot be extracted from the stored value.\n\n  - Password aging should be strictly enforced to ensure that passwords do not remain unchanged for long periods of time. The longer a password remains in use, the higher the probability that it has been compromised. For this reason, passwords should require refreshing periodically, and users should be informed of the risk of passwords which remain in use for too long.\n\n  - Password strength should be enforced intelligently. Rather than restrict passwords to specific content, or specific length, users should be encouraged to use upper and lower case letters, numbers, and symbols in their passwords. The system should also ensure that no passwords are derived from dictionary words.\n\n"},{"Phase":["Architecture and Design"],"Description":"Use a zero-knowledge password protocol, such as SRP."},{"Phase":["Architecture and Design"],"Description":"Ensure that passwords are stored safely and are not reversible."},{"Phase":["Architecture and Design"],"Description":"Implement password aging functionality that requires passwords be changed after a certain point."},{"Phase":["Architecture and Design"],"Description":"Use a mechanism for determining the strength of a password and notify the user of weak password use."},{"Phase":["Architecture and Design"],"Description":"Inform the user of why password protections are in place, how they work to protect data integrity, and why it is important to heed their warnings."}],"DemonstrativeExamples":[{"ID":"DX-101","Entries":[{"IntroText":"In both of these examples, a user is logged in if their given password matches a stored password:"},{"Nature":"Bad","Language":"C","ExampleCode":"```\n\tunsigned char *check_passwd(char *plaintext) {\n\t\tctext = simple_digest(\"sha1\",plaintext,strlen(plaintext), ... );\n```\n//Login if hash matches stored hash* \n\t\tif (equal(ctext, secret_password())) {\n\t\t```\n\t\t\tlogin_user();\n\t\t}\n\t}\n```"},{"Nature":"Bad","Language":"Java","ExampleCode":"```\n\tString plainText = new String(plainTextIn);\n\tMessageDigest encer = MessageDigest.getInstance(\"SHA\");\n\tencer.update(plainTextIn);\n\tbyte[] digest = password.digest();\n```\n//Login if hash matches stored hash* \n\tif (equal(digest,secret_password())) {\n\t```\n\t\tlogin_user();\n\t}\n```"},{"BodyText":"This code relies exclusively on a password mechanism (CWE-309) using only one factor of authentication (CWE-308). If an attacker can steal or guess a user's password, they are given full access to their account. Note this code also uses SHA-1, which is a weak hash (CWE-328). It also does not use a salt (CWE-759)."}]}],"TaxonomyMappings":[{"TaxonomyName":"CLASP","EntryName":"Using password systems"},{"TaxonomyName":"OWASP Top Ten 2004","EntryID":"A3","EntryName":"Broken Authentication and Session Management","MappingFit":"CWE More Specific"}],"RelatedAttackPatterns":["16","49","509","55","555","560","561","565","600","652","653","70"],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"References":[{"ExternalReferenceID":"REF-18","Authors":["Secure Software, Inc."],"Title":"The CLASP Application Security Process","PublicationYear":"2005","URL":"https://cwe.mitre.org/documents/sources/TheCLASPApplicationSecurityProcess.pdf"}],"ContentHistory":[{"Type":"Submission","SubmissionName":"CLASP","SubmissionDate":"2006-07-19"},{"Type":"Modification","ModificationOrganization":"Veracode","ModificationDate":"2008-08-15","ModificationComment":"Suggested OWASP Top Ten 2004 mapping"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Background_Details, Common_Consequences, Relationships, Taxonomy_Mappings"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2010-12-13","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-10-30","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Applicable_Platforms, Likelihood_of_Exploit"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated References, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-08-20","ModificationComment":"updated Related_Attack_Patterns"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2021-03-15","ModificationComment":"updated Demonstrative_Examples"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"},{"Type":"Rename","PreviousEntryName":"Using Password Systems","Date":"2008-04-11"}]}