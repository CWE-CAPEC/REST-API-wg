{"ID":"1314","Name":"Missing Write Protection for Parametric Data Values","Abstraction":"Base","Structure":"Simple","Status":"Draft","Description":"The device does not write-protect the parametric data values for sensors that scale the sensor value, allowing untrusted software to manipulate the apparent result and potentially damage hardware or cause operational failure.","ExtendedDescription":"\n\nVarious sensors are used by hardware to detect any devices operating outside of the design limits. The threshold limit values are set by hardware fuses or trusted software such as the BIOS. These limits may be related to thermal, power, voltage, current, and frequency. Hardware mechanisms may be used to protect against alteration of the threshold limit values by untrusted software.\n\n\nThe limit values are generally programmed in standard units for the type of value being read. However, the hardware-sensor blocks may report the settings in different units depending upon sensor design and operation. The raw sensor output value is converted to the desired units using a scale conversion based on the parametric data programmed into the sensor. The final converted value is then compared with the previously programmed limits.\n\n\nWhile the limit values are usually protected, the sensor parametric data values may not be. By changing the parametric data, safe operational limits may be bypassed.\n","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"862","ViewID":"1000","Ordinal":"Primary"},{"Nature":"PeerOf","CweID":"1299","ViewID":"1194","Ordinal":"Primary"}],"ApplicablePlatforms":[{"Type":"Language","Class":"Not Language-Specific","Prevalence":"Undetermined"},{"Type":"Operating_System","Class":"Not OS-Specific","Prevalence":"Undetermined"},{"Type":"Architecture","Class":"Not Architecture-Specific","Prevalence":"Undetermined"},{"Type":"Technology","Name":"Sensor Hardware","Prevalence":"Undetermined"}],"ModesOfIntroduction":[{"Phase":"Architecture and Design","Note":"The lack of a requirement to protect parametric values may contribute to this weakness."},{"Phase":"Implementation","Note":"The lack of parametric value protection may be a cause of this weakness."}],"CommonConsequences":[{"Scope":["Availability"],"Impact":["Quality Degradation","DoS: Resource Consumption (Other)"],"Likelihood":["High"],"Note":"Sensor value manipulation, particularly thermal or power, may allow physical damage to occur or disabling of the device by a false fault shutdown causing a Denial-Of-Service."}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Access controls for sensor blocks should ensure that only trusted software is allowed to change threshold limits and sensor parametric data.","Effectiveness":"High"}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"Malicious software executes instructions to increase power consumption to the highest possible level while causing the clock frequency to increase to its maximum value. Such a program executing for an extended period of time would likely overheat the device, possibly resulting in permanent damage to the device. \n\n\nA ring, oscillator-based temperature sensor will generally report the sensed value as oscillator frequency rather than degrees centigrade. The temperature sensor will have calibration values that are used to convert the detected frequency into the corresponding temperature in degrees centigrade. \n\n\nConsider a SoC design where the critical maximum temperature limit is set in fuse values to 100C and is not modifiable by software. If the scaled thermal sensor output equals or exceeds this limit, the system is commanded to shut itself down. \n\n\nThe thermal sensor calibration values are programmable through registers that are exposed to system software. These registers allow software to affect the converted temperature output such that the output will never exceed the maximum temperature limit."},{"Nature":"Bad","Language":"Other","ExampleCode":"The sensor frequency value is scaled by applying the function:\n\n```\n\tSensed Temp = a + b * Sensor Freq\n```\nwhere a and b are the programmable calibration data coefficients. Software sets a and b to zero ensuring the sensed temperature is always zero."},{"BodyText":"This weakness may be addressed by preventing access to a and b."},{"Nature":"Good","Language":"Other","ExampleCode":"The sensor frequency value is scaled by applying the function:\n\n```\n\tSensed Temp = a + b * Sensor Freq\n```\nwhere a and b are the programmable calibration data coefficients. Untrusted software is prevented from changing the values of either a or b, preventing this method of manipulating the temperature."}]}],"ObservedExamples":[{"Reference":"CVE-2017-8252","Description":"Kernel can inject faults in computations during the execution of TrustZone leading to information disclosure in Snapdragon Auto, Snapdragon Compute, Snapdragon Connectivity, Snapdragon Consumer Electronics Connectivity, Snapdragon Consumer IOT, Snapdragon Industrial IOT, Snapdragon IoT, Snapdragon Mobile, Snapdragon Voice and Music, Snapdragon Wearables, Snapdragon Wired Infrastructure and Networking.","Link":"https://www.cve.org/CVERecord?id=CVE-2017-8252"}],"RelatedAttackPatterns":["1"],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"References":[{"ExternalReferenceID":"REF-1082","Authors":["Adrian Tang","Simha Sethumadhavan","Salvatore Stolfo"],"Title":"CLKSCREW: Exposing the Perils of Security-Oblivious Energy Management","URL":"https://www.usenix.org/system/files/conference/usenixsecurity17/sec17-tang.pdf"}],"ContentHistory":[{"Type":"Submission","SubmissionName":"Hareesh Khattri, Parbati K. Manna, and Arun Kanuparthi","SubmissionOrganization":"The Intel Corporation","SubmissionDate":"2020-07-14"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-04-28","ModificationComment":"updated Applicable_Platforms"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-06-28","ModificationComment":"updated Applicable_Platforms"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}