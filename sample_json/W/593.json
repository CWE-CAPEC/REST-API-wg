{"ID":"593","Name":"Authentication Bypass: OpenSSL CTX Object Modified after SSL Objects are Created","Abstraction":"Variant","Structure":"Simple","Status":"Draft","Description":"The product modifies the SSL context after connection creation has begun.","ExtendedDescription":"If the program modifies the SSL_CTX object after creating SSL objects from it, there is the possibility that older SSL objects created from the original context could all be affected by that change.","RelatedWeaknesses":[{"Nature":"ChildOf","CweID":"666","ViewID":"1000","Ordinal":"Primary"},{"Nature":"ChildOf","CweID":"1390","ViewID":"1000"}],"ModesOfIntroduction":[{"Phase":"Implementation","Note":"REALIZATION: This weakness is caused during implementation of an architectural security tactic."}],"CommonConsequences":[{"Scope":["Access Control"],"Impact":["Bypass Protection Mechanism"],"Note":"No authentication takes place in this process, bypassing an assumed protection of encryption."},{"Scope":["Confidentiality"],"Impact":["Read Application Data"],"Note":"The encrypted communication between a user and a trusted host may be subject to a sniffing attack."}],"PotentialMitigations":[{"Phase":["Architecture and Design"],"Description":"Use a language or a library that provides a cryptography framework at a higher level of abstraction."},{"Phase":["Implementation"],"Description":"Most SSL_CTX functions have SSL counterparts that act on SSL-type objects."},{"Phase":["Implementation"],"Description":"Applications should set up an SSL_CTX completely, before creating SSL objects from it."}],"DemonstrativeExamples":[{"Entries":[{"IntroText":"The following example demonstrates the weakness."},{"Nature":"Bad","Language":"C","ExampleCode":"```\n\t#define CERT \"secret.pem\"\n\t#define CERT2 \"secret2.pem\"\n\tint main(){\n\t\t\tSSL_CTX *ctx;\n\t\t\tSSL *ssl;\n\t\t\tinit_OpenSSL();\n\t\t\tseed_prng();\n\t\t\tctx = SSL_CTX_new(SSLv23_method());\n\t\t\tif (SSL_CTX_use_certificate_chain_file(ctx, CERT) != 1)\n\t\t\t\tint_error(\"Error loading certificate from file\");\n\t\t\tif (SSL_CTX_use_PrivateKey_file(ctx, CERT, SSL_FILETYPE_PEM) != 1)\n\t\t\t\tint_error(\"Error loading private key from file\");\n\t\t\tif (!(ssl = SSL_new(ctx)))\n\t\t\t\tint_error(\"Error creating an SSL context\");\n\t\t\tif ( SSL_CTX_set_default_passwd_cb(ctx, \"new default password\" != 1))\n\t\t\t\tint_error(\"Doing something which is dangerous to do anyways\");\n\t\t\tif (!(ssl2 = SSL_new(ctx)))\n\t\t\t\tint_error(\"Error creating an SSL context\");\n\t}\n```"}]}],"RelatedAttackPatterns":["94"],"MappingNotes":{"Usage":"Allowed","Rationale":"This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.","Comments":"Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.","Reasons":["Acceptable-Use"]},"ContentHistory":[{"Type":"Submission","SubmissionName":"CWE Community","SubmissionDate":"2006-12-15"},{"Type":"Modification","ModificationName":"Eric Dalci","ModificationOrganization":"Cigital","ModificationDate":"2008-07-01","ModificationComment":"updated Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2008-09-08","ModificationComment":"updated Common_Consequences, Relationships, Other_Notes"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2009-07-27","ModificationComment":"updated Description, Other_Notes, Potential_Mitigations"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-01","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2011-06-27","ModificationComment":"updated Common_Consequences"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2012-05-11","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2014-07-30","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-05-03","ModificationComment":"updated Potential_Mitigations, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2017-11-08","ModificationComment":"updated Demonstrative_Examples, Modes_of_Introduction, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2020-02-24","ModificationComment":"updated Common_Consequences, Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2022-10-13","ModificationComment":"updated Relationships"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-01-31","ModificationComment":"updated Description"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-04-27","ModificationComment":"updated Relationships, Time_of_Introduction"},{"Type":"Modification","ModificationName":"CWE Content Team","ModificationOrganization":"MITRE","ModificationDate":"2023-06-29","ModificationComment":"updated Mapping_Notes"}]}